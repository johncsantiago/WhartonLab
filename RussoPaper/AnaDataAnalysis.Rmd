---
title: "Ana Data"
author: "John Santiago"
date: "2025-06-21"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```



```{r echo = F, warning=FALSE, message=FALSE}

library(kableExtra)
library(gtools)
library(gplots)
library(beeswarm)


temp = read.csv("/Users/johncsantiago/Documents/GitHub/WhartonLab/RussoPaper/20250621_AllAnaData.csv")

temp$Genotype[temp$Genotype == "WT-cr/LoxP"] = "WT(cr/LoxP)"
temp$Genotype[temp$Genotype == "G85R"] = "G85R(cr/hr)"
temp$Genotype[temp$Genotype == "G85Rcr/G85Rhr"] = "G85R(cr/hr)"

temp$Genotype[temp$Genotype == "OK371 > gbb [WT]"] = "OK371-gbb; WT(cr/LoxP)"
temp$Genotype[temp$Genotype == "OK371 > gbb [G85R]"] = "OK371-gbb; G85R(cr/LoxP)"
temp$Genotype[temp$Genotype == "OK371>gbb [WT]"] = "OK371-gbb; WT(cr/LoxP)"
temp$Genotype[temp$Genotype == "OK371>gbb [G85R]"] = "OK371-gbb; G85R(cr/LoxP)"
temp$Genotype[temp$Genotype == "OK371>gbb [WTcr/LoxP]"] = "OK371-gbb; WT(cr/LoxP)"
temp$Genotype[temp$Genotype == "OK371>gbb [G85cr/G85Rhr]"] = "OK371-gbb; G85R(cr/LoxP)"

temp$Genotype[temp$Genotype == "OK371 > saxA [WT]"] = "OK371-saxA; WT(cr/LoxP)"
temp$Genotype[temp$Genotype == "OK371 > saxA [G85R]"] = "OK371-saxA; G85R(cr/LoxP)"
temp$Genotype[temp$Genotype == "OK371> saxA [WT-cr/LoxP]"] = "OK371-saxA; WT(cr/LoxP)"
temp$Genotype[temp$Genotype == "OK371>saxA G85R"] = "OK371-saxA; G85R(cr/LoxP)"
temp$Genotype[temp$Genotype == "OK371>saxA [WTcr/LoxP]"] = "OK371-saxA; WT(cr/LoxP)"
temp$Genotype[temp$Genotype == "OK371>saxA [G85Rcr/G85Rhr]"] = "OK371-saxA; G85R(cr/LoxP)"


temp$Genotype = factor(temp$Genotype, levels = unique(temp$Genotype))

std.colors = setNames(c('navy', "orange2", 
                        "darkgreen", "turquoise3",
                        "firebrick","deeppink"),
                      c("WT(cr/LoxP)" , "G85R(cr/hr)",
                        "OK371-gbb; WT(cr/LoxP)", "OK371-gbb; G85R(cr/LoxP)",
                        "OK371-saxA; WT(cr/LoxP)", "OK371-saxA; G85R(cr/LoxP)"))


hex = function(color, alpha){
  rgb2hex = color
  i = 1
  while(i <= length(color)){
    rgbvals = col2rgb(color[i])
    rgb2hex[i] = rgb(rgbvals[1]/255, rgbvals[2]/255, rgbvals[3]/255, alpha)
    i = i+1
  }
  return(rgb2hex)
}

```


```{r echo = F}


plot.bouts = function(boutdata){


boutmeans = c(mean(boutdata[boutdata$Genotype == geno[1], "Boutons"]),
              mean(boutdata[boutdata$Genotype == geno[2], "Boutons"]),
              mean(boutdata[boutdata$Genotype == geno[3], "Boutons"]),
              mean(boutdata[boutdata$Genotype == geno[4], "Boutons"]),
              mean(boutdata[boutdata$Genotype == geno[5], "Boutons"]),
              mean(boutdata[boutdata$Genotype == geno[6], "Boutons"]))

par(mar=c(6.25, 4.1, 4.1, 5.6))

plot(x = c(.75,1.25),
     y = rep(boutmeans[1], 2),
     type = 'l',
     lwd = 3,
     col = std.colors[1],
     ylim = c(0, max(boutdata$Boutons)*1.1),
     xlim = c(.5, length(na.omit(boutmeans))+.5),
     xaxt = "n",
     ylab="Bouton Number",
     yaxt = "n",
     xlab = NA,
     frame = F,
     main = paste("Larval muscle Segment", unique(boutdata$Segment), "NMJ", unique(boutdata$NMJ), "bouton counts"))



lines(x = c(.65,1.35),
     y = rep(boutmeans[1], 2),
     type = 'l',
     lwd = 3,
     col = std.colors[1])

lines(x = c(1.65,2.35),
     y = rep(boutmeans[2], 2),
     type = 'l',
     lwd = 3,
     col = std.colors[2])

if(length(na.omit(boutmeans)>2)){
lines(x = c(2.65,3.35),
     y = rep(boutmeans[3], 2),
     type = 'l',
     lwd = 3,
     col = std.colors[3])

lines(x = c(3.65,4.35),
     y = rep(boutmeans[4], 2),
     type = 'l',
     lwd = 3,
     col = std.colors[4])

lines(x = c(4.65,5.35),
     y = rep(boutmeans[5], 2),
     type = 'l',
     lwd = 3,
     col = std.colors[5])

lines(x = c(5.65,6.35),
     y = rep(boutmeans[6], 2),
     type = 'l',
     lwd = 3,
     col = std.colors[6])
}


beeswarm(boutdata$Boutons~boutdata$Genotype,
       pch = 21,
       method = "center",
       bg = hex(unique(std.colors[as.numeric(boutdata$Genotype)]),.5),
       add = T)


axis(side = 1,
     at = c(1:length(na.omit(boutmeans))),
     labels = c(labels)[1:length(na.omit(boutmeans))],
     las = 2,
     lwd = 0,
     line = -.75)

    lines(x = c(.225 + .3/length(na.omit(boutmeans)), length(na.omit(boutmeans))+.5),
       y = c(0,0),
       lwd = 3,
       xpd = T)

  y.at = ceiling(max(boutdata$Boutons)*.11)
  y.at = c(0,10*1:y.at)
    
  axis(side = 2,
       at = y.at,
       lwd = 2,
       line = 0,
       labels = F,
       xpd = T,
       las = 2)

  
  axis(side = 2,
       at = y.at,
       lwd = 3,
       line = 0,
       labels = T,
       xpd = T,
       las = 2)
}

```


```{r echo = F, fig.width = 7}

Boutons = temp[temp$Data == "Boutons",]
boutdata = Boutons[Boutons$NMJ == "4" &
                        Boutons$Segment == "3",]

geno = unique(boutdata$Genotype)
labels = c("WT", "G85R",
           "OK-gbb WT", "OK-gbb G85R",
           "OK-SaxA WT", "OK-SaxA G85R")

plot.bouts(boutdata)

```


```{r echo = F}

btd = boutdata

t.data = list("WT(cr/LoxP)" = btd$Boutons[btd$Genotype == "WT(cr/LoxP)"],
                    "G85R(cr/hr)" = btd$Boutons[btd$Genotype == "G85R(cr/hr)"],
                    "OK371-gbb; WT(cr/LoxP)" = btd$Boutons[btd$Genotype == "OK371-gbb; WT(cr/LoxP)"],
                    "OK371-gbb; G85R(cr/LoxP)" = btd$Boutons[btd$Genotype == "OK371-gbb; G85R(cr/LoxP)"],
                    "OK371-saxA; WT(cr/LoxP)" = btd$Boutons[btd$Genotype == "OK371-saxA; WT(cr/LoxP)"],
                    "OK371-saxA; G85R(cr/LoxP)" = btd$Boutons[btd$Genotype == "OK371-saxA; G85R(cr/LoxP)"])

t.table = data.frame(Genotype1 = character(),
                     Genotype2 = character(),
                     pval = numeric())

i=1
while(i <= length(t.data)){
  j = i+1
  while(j <= length(t.data)){
    t.temp = data.frame(Genotype1 = geno[i],
                        Genotype2 = geno[j],
                        pval = t.test(x = t.data[[i]],
                                      y = t.data[[j]],
                                      paired = F)[[3]])
    t.table = rbind(t.table, t.temp)
      j = j+1
  }
  i = i+1
}


t.stripe = t.table$pval <= .05
knitr::kable(t.table,
             caption = 'All t-tests for segment 3, NMJ 4 Bouton Counts.')  %>%
kable_styling() %>%
row_spec(c(1:nrow(t.table))[t.table$pval <= .05], bold = T, color = "black", background = "gold")

```


```{r echo = F, fig.width = 7}

Boutons = temp[temp$Data == "Boutons",]
boutdata = Boutons[Boutons$NMJ == "6-7" &
                        Boutons$Segment == "3",]

geno = unique(boutdata$Genotype)
labels = c("WT", "G85R",
           "OK-gbb WT", "OK-gbb G85R",
           "OK-SaxA WT", "OK-SaxA G85R")


plot.bouts(boutdata)

```


```{r echo = F}

btd = boutdata

t.data = list("WT(cr/LoxP)" = btd$Boutons[btd$Genotype == "WT(cr/LoxP)"],
                    "G85R(cr/hr)" = btd$Boutons[btd$Genotype == "G85R(cr/hr)"],
                    "OK371-gbb; WT(cr/LoxP)" = btd$Boutons[btd$Genotype == "OK371-gbb; WT(cr/LoxP)"],
                    "OK371-gbb; G85R(cr/LoxP)" = btd$Boutons[btd$Genotype == "OK371-gbb; G85R(cr/LoxP)"],
                    "OK371-saxA; WT(cr/LoxP)" = btd$Boutons[btd$Genotype == "OK371-saxA; WT(cr/LoxP)"],
                    "OK371-saxA; G85R(cr/LoxP)" = btd$Boutons[btd$Genotype == "OK371-saxA; G85R(cr/LoxP)"])

t.table = data.frame(Genotype1 = character(),
                     Genotype2 = character(),
                     pval = numeric())

i=1
while(i <= length(t.data)){
  j = i+1
  while(j <= length(t.data)){
    t.temp = data.frame(Genotype1 = geno[i],
                        Genotype2 = geno[j],
                        pval = t.test(x = t.data[[i]],
                                      y = t.data[[j]],
                                      paired = F)[[3]])
    t.table = rbind(t.table, t.temp)
      j = j+1
  }
  i = i+1
}


t.stripe = t.table$pval <= .05
knitr::kable(t.table,
             caption = 'All t-tests for segment 3, NMJ 6-7 Bouton Counts.')  %>%
kable_styling() %>%
row_spec(c(1:nrow(t.table))[t.table$pval <= .05], bold = T, color = "black", background = "gold")

```


```{r echo = F, include = F}

Boutons = temp[temp$Data == "Boutons",]
boutdata = Boutons[Boutons$NMJ == "4" &
                        Boutons$Segment == "4",]

geno = unique(boutdata$Genotype)
labels = c("WT", "G85R",
           "OK-gbb WT", "OK-gbb G85R",
           "OK-SaxA WT", "OK-SaxA G85R")


plot.bouts(boutdata)

```


```{r echo = F, include = F}

Boutons = temp[temp$Data == "Boutons",]
boutdata = Boutons[Boutons$NMJ == "6-7" &
                        Boutons$Segment == "4",]

geno = unique(boutdata$Genotype)
labels = c("WT", "G85R",
           "OK-gbb WT", "OK-gbb G85R",
           "OK-SaxA WT", "OK-SaxA G85R")


plot.bouts(boutdata)

```


```{r echo = F, include = F}

Boutons = temp[temp$Data == "Boutons",]
boutdata = Boutons[Boutons$NMJ == "4" &
                        Boutons$Segment == "5",]

geno = unique(boutdata$Genotype)
labels = c("WT", "G85R",
           "OK-gbb WT", "OK-gbb G85R",
           "OK-SaxA WT", "OK-SaxA G85R")


plot.bouts(boutdata)

```


```{r echo = F, include = F}

Boutons = temp[temp$Data == "Boutons",]
boutdata = Boutons[Boutons$NMJ == "6-7" &
                        Boutons$Segment == "5",]

geno = unique(boutdata$Genotype)
labels = c("WT", "G85R",
           "OK-gbb WT", "OK-gbb G85R",
           "OK-SaxA WT", "OK-SaxA G85R")


plot.bouts(boutdata)

```



```{r echo = F, include = F}

Boutons = temp[temp$Data == "Boutons",]
boutdata = Boutons[Boutons$NMJ == "4" &
                        Boutons$Segment == "6",]

geno = unique(boutdata$Genotype)
labels = c("WT", "G85R",
           "OK-gbb WT", "OK-gbb G85R",
           "OK-SaxA WT", "OK-SaxA G85R")


plot.bouts(boutdata)

```


```{r echo = F, include = F}

Boutons = temp[temp$Data == "Boutons",]
boutdata = Boutons[Boutons$NMJ == "6-7" &
                        Boutons$Segment == "6",]

geno = unique(boutdata$Genotype)
labels = c("WT", "G85R",
           "OK-gbb WT", "OK-gbb G85R",
           "OK-SaxA WT", "OK-SaxA G85R")


plot.bouts(boutdata)

```


```{r echo = F, fig.width = 7}

Boutons = temp[temp$Data == "Boutons",]
boutdata = Boutons[Boutons$NMJ == "4" &
                     (Boutons$Genotype == "WT(cr/LoxP)" | Boutons$Genotype == "G85R(cr/hr)"),]
boutdata$Genotype = paste(boutdata$Segment, boutdata$Genotype)

geno = unique(boutdata$Genotype)
geno = geno[c(1,5,2,6,3,7,4,8)]

boutdata$Genotype = factor(boutdata$Genotype, levels = geno)

boutmeans = c(mean(boutdata[boutdata$Genotype == geno[1], "Boutons"]),
              mean(boutdata[boutdata$Genotype == geno[2], "Boutons"]),
              mean(boutdata[boutdata$Genotype == geno[3], "Boutons"]),
              mean(boutdata[boutdata$Genotype == geno[4], "Boutons"]),
              mean(boutdata[boutdata$Genotype == geno[5], "Boutons"]),
              mean(boutdata[boutdata$Genotype == geno[6], "Boutons"]),
              mean(boutdata[boutdata$Genotype == geno[7], "Boutons"]),
              mean(boutdata[boutdata$Genotype == geno[8], "Boutons"]))

par(mar=c(4, 4.1, 4.1, 5.6))

plot(x = c(.75,1.25),
     y = rep(boutmeans[1], 2),
     type = 'l',
     lwd = 3,
     col = std.colors[1],
     ylim = c(0, max(boutdata$Boutons)*1.1),
     xlim = c(.5, length(na.omit(boutmeans))+.5),
     xaxt = "n",
     ylab="Bouton Number",
     yaxt = "n",
     xlab = NA,
     frame = F,
     main = paste("Larval muscle NMJ 4 bouton counts, segments 3-6"))



lines(x = c(.65,1.35),
     y = rep(boutmeans[1], 2),
     type = 'l',
     lwd = 3,
     col = std.colors[1])

lines(x = c(1.65,2.35),
     y = rep(boutmeans[2], 2),
     type = 'l',
     lwd = 3,
     col = std.colors[2])

lines(x = c(2.65,3.35),
     y = rep(boutmeans[3], 2),
     type = 'l',
     lwd = 3,
     col = std.colors[1])

lines(x = c(3.65,4.35),
     y = rep(boutmeans[4], 2),
     type = 'l',
     lwd = 3,
     col = std.colors[2])

lines(x = c(4.65,5.35),
     y = rep(boutmeans[5], 2),
     type = 'l',
     lwd = 3,
     col = std.colors[1])

lines(x = c(5.65,6.35),
     y = rep(boutmeans[6], 2),
     type = 'l',
     lwd = 3,
     col = std.colors[2])

lines(x = c(6.65,7.35),
     y = rep(boutmeans[7], 2),
     type = 'l',
     lwd = 3,
     col = std.colors[1])

lines(x = c(7.65,8.35),
     y = rep(boutmeans[8], 2),
     type = 'l',
     lwd = 3,
     col = std.colors[2])


beeswarm(boutdata$Boutons~boutdata$Genotype,
       pch = 21,
       method = "center",
       bg = hex(std.colors[1:2],.5),
       add = T)

lines(x = c(2.5,2.5),
      y = c(-2.5,50),
      lty = 2,
      xpd = T)

lines(x = c(4.5,4.5),
      y = c(-2.5,50),
      lty = 2,
      xpd = T)

lines(x = c(6.5,6.5),
      y = c(-2.5,50),
      lty = 2,
      xpd = T)


axis(side = 1,
     at = c(1.5, 3.5, 5.5, 7.5),
     labels = c(3,4,5,6),
     las = 1,
     lwd = 0,
     line = -.75)

axis(side = 1,
     at = c(4.5),
     labels = c("Larval Segment"),
     las = 1,
     lwd = 0,
     cex = 2,
     line = 0.5)

    lines(x = c(.2, length(na.omit(boutmeans))+.5),
       y = c(0,0),
       lwd = 3,
       xpd = T)
    
  y.at = c(0, 10*1:5)
    
  axis(side = 2,
       at = y.at,
       lwd = 2,
       line = 0,
       labels = F,
       xpd = T,
       las = 2)

  
  axis(side = 2,
       at = y.at,
       lwd = 3,
       line = 0,
       labels = T,
       xpd = T,
       las = 2)

  legend('topright',
       inset=c(-0.185,0),
       legend = c('WT(cr/LoxP)', 'G85R(cr/hr)'), 
       fill = std.colors[1:2],
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T)

```

```{r echo = F}

btd = boutdata

t.data = list("3 WT(cr/LoxP)" = btd$Boutons[btd$Genotype == "3 WT(cr/LoxP)"],
              "3 G85R(cr/hr)" = btd$Boutons[btd$Genotype == "3 G85R(cr/hr)"],
              "4 WT(cr/LoxP)" = btd$Boutons[btd$Genotype == "4 WT(cr/LoxP)"],
              "4 G85R(cr/hr)" = btd$Boutons[btd$Genotype == "4 G85R(cr/hr)"],
              "5 WT(cr/LoxP)" = btd$Boutons[btd$Genotype == "5 WT(cr/LoxP)"],
              "5 G85R(cr/hr)" = btd$Boutons[btd$Genotype == "5 G85R(cr/hr)"],
              "6 WT(cr/LoxP)" = btd$Boutons[btd$Genotype == "6 WT(cr/LoxP)"],
              "6 G85R(cr/hr)" = btd$Boutons[btd$Genotype == "6 G85R(cr/hr)"])

t.table = data.frame(Genotype1 = character(),
                     Genotype2 = character(),
                     pval = numeric())

i=1
while(i <= length(t.data)){
  j = i+1
  while(j <= length(t.data)){
    t.temp = data.frame(Genotype1 = geno[i],
                        Genotype2 = geno[j],
                        pval = t.test(x = t.data[[i]],
                                      y = t.data[[j]],
                                      paired = F)[[3]])
    t.table = rbind(t.table, t.temp)
      j = j+1
  }
  i = i+1
}


t.stripe = t.table$pval <= .05
knitr::kable(t.table,
             caption = 'All t-tests for NMJ 4, all segments Bouton Counts.')  %>%
kable_styling() %>%
row_spec(c(1:nrow(t.table))[t.table$pval <= .05], bold = T, color = "black", background = "gold")

```


```{r echo = F, fig.width = 7}

Boutons = temp[temp$Data == "Boutons",]
boutdata = Boutons[Boutons$NMJ == "6-7" &
                     (Boutons$Genotype == "WT(cr/LoxP)" | Boutons$Genotype == "G85R(cr/hr)"),]
boutdata$Genotype = paste(boutdata$Segment, boutdata$Genotype)

geno = unique(boutdata$Genotype)
geno = geno[c(1,5,2,6,3,7,4,8)]

boutdata$Genotype = factor(boutdata$Genotype, levels = geno)

boutmeans = c(mean(boutdata[boutdata$Genotype == geno[1], "Boutons"]),
              mean(boutdata[boutdata$Genotype == geno[2], "Boutons"]),
              mean(boutdata[boutdata$Genotype == geno[3], "Boutons"]),
              mean(boutdata[boutdata$Genotype == geno[4], "Boutons"]),
              mean(boutdata[boutdata$Genotype == geno[5], "Boutons"]),
              mean(boutdata[boutdata$Genotype == geno[6], "Boutons"]),
              mean(boutdata[boutdata$Genotype == geno[7], "Boutons"]),
              mean(boutdata[boutdata$Genotype == geno[8], "Boutons"]))

par(mar=c(4, 4.1, 4.1, 5.6))

plot(x = c(.75,1.25),
     y = rep(boutmeans[1], 2),
     type = 'l',
     lwd = 3,
     col = std.colors[1],
     ylim = c(0, max(boutdata$Boutons)*1.1),
     xlim = c(.5, length(na.omit(boutmeans))+.5),
     xaxt = "n",
     ylab="Bouton Number",
     yaxt = "n",
     xlab = NA,
     frame = F,
     main = paste("Larval muscle NMJ 6-7 bouton counts, segments 3-6"))



lines(x = c(.65,1.35),
     y = rep(boutmeans[1], 2),
     type = 'l',
     lwd = 3,
     col = std.colors[1])

lines(x = c(1.65,2.35),
     y = rep(boutmeans[2], 2),
     type = 'l',
     lwd = 3,
     col = std.colors[2])

lines(x = c(2.65,3.35),
     y = rep(boutmeans[3], 2),
     type = 'l',
     lwd = 3,
     col = std.colors[1])

lines(x = c(3.65,4.35),
     y = rep(boutmeans[4], 2),
     type = 'l',
     lwd = 3,
     col = std.colors[2])

lines(x = c(4.65,5.35),
     y = rep(boutmeans[5], 2),
     type = 'l',
     lwd = 3,
     col = std.colors[1])

lines(x = c(5.65,6.35),
     y = rep(boutmeans[6], 2),
     type = 'l',
     lwd = 3,
     col = std.colors[2])

lines(x = c(6.65,7.35),
     y = rep(boutmeans[7], 2),
     type = 'l',
     lwd = 3,
     col = std.colors[1])

lines(x = c(7.65,8.35),
     y = rep(boutmeans[8], 2),
     type = 'l',
     lwd = 3,
     col = std.colors[2])


beeswarm(boutdata$Boutons~boutdata$Genotype,
       pch = 21,
       method = "center",
       bg = hex(std.colors[1:2],.5),
       add = T)

lines(x = c(2.5,2.5),
      y = c(-5,100),
      lty = 2,
      xpd = T)

lines(x = c(4.5,4.5),
      y = c(-5,100),
      lty = 2,
      xpd = T)

lines(x = c(6.5,6.5),
      y = c(-5,100),
      lty = 2,
      xpd = T)


axis(side = 1,
     at = c(1.5, 3.5, 5.5, 7.5),
     labels = c(3,4,5,6),
     las = 1,
     lwd = 0,
     line = -.75)

axis(side = 1,
     at = c(4.5),
     labels = c("Larval Segment"),
     las = 1,
     lwd = 0,
     cex = 2,
     line = 0.5)

    lines(x = c(.2, length(na.omit(boutmeans))+.5),
       y = c(0,0),
       lwd = 3,
       xpd = T)
    
  y.at = c(0, 10*1:10)
    
  axis(side = 2,
       at = y.at,
       lwd = 2,
       line = 0,
       labels = F,
       xpd = T,
       las = 2)

  
  axis(side = 2,
       at = y.at,
       lwd = 3,
       line = 0,
       labels = T,
       xpd = T,
       las = 2)

  legend('topright',
       inset=c(-0.185,0),
       legend = c('WT(cr/LoxP)', 'G85R(cr/hr)'), 
       fill = std.colors[1:2],
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T)

```


```{r echo = F}

btd = boutdata

t.data = list("3 WT(cr/LoxP)" = btd$Boutons[btd$Genotype == "3 WT(cr/LoxP)"],
              "3 G85R(cr/hr)" = btd$Boutons[btd$Genotype == "3 G85R(cr/hr)"],
              "4 WT(cr/LoxP)" = btd$Boutons[btd$Genotype == "4 WT(cr/LoxP)"],
              "4 G85R(cr/hr)" = btd$Boutons[btd$Genotype == "4 G85R(cr/hr)"],
              "5 WT(cr/LoxP)" = btd$Boutons[btd$Genotype == "5 WT(cr/LoxP)"],
              "5 G85R(cr/hr)" = btd$Boutons[btd$Genotype == "5 G85R(cr/hr)"],
              "6 WT(cr/LoxP)" = btd$Boutons[btd$Genotype == "6 WT(cr/LoxP)"],
              "6 G85R(cr/hr)" = btd$Boutons[btd$Genotype == "6 G85R(cr/hr)"])

t.table = data.frame(Genotype1 = character(),
                     Genotype2 = character(),
                     pval = numeric())

i=1
while(i <= length(t.data)){
  j = i+1
  while(j <= length(t.data)){
    t.temp = data.frame(Genotype1 = geno[i],
                        Genotype2 = geno[j],
                        pval = t.test(x = t.data[[i]],
                                      y = t.data[[j]],
                                      paired = F)[[3]])
    t.table = rbind(t.table, t.temp)
      j = j+1
  }
  i = i+1
}


t.stripe = t.table$pval <= .05
knitr::kable(t.table,
             caption = 'All t-tests for NMJ 6-7, all segments Bouton Counts.')  %>%
kable_styling() %>%
row_spec(c(1:nrow(t.table))[t.table$pval <= .05], bold = T, color = "black", background = "gold")

```

```{r echo = F}

VNC = temp[temp$Data == "VNC",]
VNC$CTCF = VNC$CTCF/1000
geno = unique(VNC$Genotype)
VNC$color = as.numeric(VNC$Genotype) + ((VNC$Experiment -1)*6)
VNC$color = c('navy', "orange2",
               "darkgreen", "turquoise4",
               "firebrick","deeppink3",
               "royalblue", 'gold',
               "green", 'cyan',
               "red", "pink") [VNC$color]

labels = c("WT", "G85R",
           "OK-gbb WT", "OK-gbb G85R",
           "OK-SaxA WT", "OK-SaxA G85R")

vncmeans = c(mean(VNC[VNC$Genotype == geno[1], "CTCF"]),
              mean(VNC[VNC$Genotype == geno[2], "CTCF"]),
              mean(VNC[VNC$Genotype == geno[3], "CTCF"]),
              mean(VNC[VNC$Genotype == geno[4], "CTCF"]),
              mean(VNC[VNC$Genotype == geno[5], "CTCF"]),
              mean(VNC[VNC$Genotype == geno[6], "CTCF"]))

par(mar=c(6.25, 4.1, 4.1, 5.6))

plot(x = c(.75,1.25),
     y = rep(vncmeans[1], 2),
     type = 'l',
     lwd = 3,
     col = std.colors[1],
     ylim = c(0, max(VNC$CTCF)*1.1),
     xlim = c(.5, length(na.omit(vncmeans))+.5),
     xaxt = "n",
     ylab="Fluorescence Intensity/1000",
     yaxt = "n",
     xlab = NA,
     frame = F,
     main = paste("Larval VNC fluorescence"))



lines(x = c(.65,1.35),
     y = rep(vncmeans[1], 2),
     type = 'l',
     lwd = 3,
     col = std.colors[1])

lines(x = c(1.65,2.35),
     y = rep(vncmeans[2], 2),
     type = 'l',
     lwd = 3,
     col = std.colors[2])

if(length(na.omit(vncmeans)>2)){
lines(x = c(2.65,3.35),
     y = rep(vncmeans[3], 2),
     type = 'l',
     lwd = 3,
     col = std.colors[3])

lines(x = c(3.65,4.35),
     y = rep(vncmeans[4], 2),
     type = 'l',
     lwd = 3,
     col = std.colors[4])

lines(x = c(4.65,5.35),
     y = rep(vncmeans[5], 2),
     type = 'l',
     lwd = 3,
     col = std.colors[5])

lines(x = c(5.65,6.35),
     y = rep(vncmeans[6], 2),
     type = 'l',
     lwd = 3,
     col = std.colors[6])
}


beeswarm(VNC$CTCF~VNC$Genotype,
       #pch = 21,
       pwpch = 20+VNC$Experiment,
       method = "center",
       #bg = hex(unique(std.colors[as.numeric(VNC$Genotype)]),.5),
       pwbg = hex(VNC$color, .75),
       add = T)


axis(side = 1,
     at = c(1:length(na.omit(vncmeans))),
     labels = c(labels)[1:length(na.omit(vncmeans))],
     las = 2,
     lwd = 0,
     line = -.75)

    lines(x = c(.225 + .3/length(na.omit(vncmeans)), length(na.omit(vncmeans))+.5),
       y = c(0,0),
       lwd = 3,
       xpd = T)


  y.at = c(0,500, 1000, 1500)
    
  axis(side = 2,
       at = y.at,
       lwd = 2,
       line = 0,
       labels = F,
       xpd = T,
       las = 2)

  
  axis(side = 2,
       at = y.at,
       lwd = 3,
       line = 0,
       labels = T,
       xpd = T,
       las = 2)


```


```{r echo = F}
btd = temp[temp$Data == "VNC",]

t.data = list("WT(cr/LoxP)" = btd$CTCF[btd$Genotype == "WT(cr/LoxP)"],
                    "G85R(cr/hr)" = btd$CTCF[btd$Genotype == "G85R(cr/hr)"],
                    "OK371-gbb; WT(cr/LoxP)" = btd$CTCF[btd$Genotype == "OK371-gbb; WT(cr/LoxP)"],
                    "OK371-gbb; G85R(cr/LoxP)" = btd$CTCF[btd$Genotype == "OK371-gbb; G85R(cr/LoxP)"],
                    "OK371-saxA; WT(cr/LoxP)" = btd$CTCF[btd$Genotype == "OK371-saxA; WT(cr/LoxP)"],
                    "OK371-saxA; G85R(cr/LoxP)" = btd$CTCF[btd$Genotype == "OK371-saxA; G85R(cr/LoxP)"])

t.table = data.frame(Genotype1 = character(),
                     Genotype2 = character(),
                     pval = numeric())

i=1
while(i <= length(t.data)){
  j = i+1
  while(j <= length(t.data)){
    t.temp = data.frame(Genotype1 = geno[i],
                        Genotype2 = geno[j],
                        pval = t.test(x = t.data[[i]],
                                      y = t.data[[j]],
                                      paired = F)[[3]])
    t.table = rbind(t.table, t.temp)
      j = j+1
  }
  i = i+1
}


t.stripe = t.table$pval <= .05
knitr::kable(t.table,
             caption = 'All t-tests for VNC data.')  %>%
kable_styling() %>%
row_spec(c(1:nrow(t.table))[t.table$pval <= .05], bold = T, color = "black", background = "gold")

```


```{r echo = F}

NMJ = temp[temp$Data == "NMJ" & temp$NMJ == "4",]
NMJ$CTCF = NMJ$CTCF/1000
geno = unique(NMJ$Genotype)
NMJ$color = as.numeric(NMJ$Genotype) + ((NMJ$Experiment -1)*6)
NMJ$color = c('navy', "orange2",
               "darkgreen", "turquoise4",
               "firebrick","deeppink3",
               "royalblue", 'gold',
               "green", 'cyan',
               "red", "pink") [NMJ$color]

labels = c("WT", "G85R",
           "OK-gbb WT", "OK-gbb G85R",
           "OK-SaxA WT", "OK-SaxA G85R")

nmjmeans = c(mean(NMJ[NMJ$Genotype == geno[1], "CTCF"]),
              mean(NMJ[NMJ$Genotype == geno[2], "CTCF"]),
              mean(NMJ[NMJ$Genotype == geno[3], "CTCF"]),
              mean(NMJ[NMJ$Genotype == geno[4], "CTCF"]),
              mean(NMJ[NMJ$Genotype == geno[5], "CTCF"]),
              mean(NMJ[NMJ$Genotype == geno[6], "CTCF"]))

par(mar=c(6.25, 4.1, 4.1, 5.6))

plot(x = c(.75,1.25),
     y = rep(nmjmeans[1], 2),
     type = 'l',
     lwd = 3,
     col = std.colors[1],
     ylim = c(0, max(NMJ$CTCF)*1.1),
     xlim = c(.5, length(na.omit(nmjmeans))+.5),
     xaxt = "n",
     ylab="Fluorescence Intensity/1000",
     yaxt = "n",
     xlab = NA,
     frame = F,
     main = paste("Larval segment 3, NMJ 4 fluorescence"))



lines(x = c(.65,1.35),
     y = rep(nmjmeans[1], 2),
     type = 'l',
     lwd = 3,
     col = std.colors[1])

lines(x = c(1.65,2.35),
     y = rep(nmjmeans[2], 2),
     type = 'l',
     lwd = 3,
     col = std.colors[2])

if(length(na.omit(nmjmeans)>2)){
lines(x = c(2.65,3.35),
     y = rep(nmjmeans[3], 2),
     type = 'l',
     lwd = 3,
     col = std.colors[3])

lines(x = c(3.65,4.35),
     y = rep(nmjmeans[4], 2),
     type = 'l',
     lwd = 3,
     col = std.colors[4])

lines(x = c(4.65,5.35),
     y = rep(nmjmeans[5], 2),
     type = 'l',
     lwd = 3,
     col = std.colors[5])

lines(x = c(5.65,6.35),
     y = rep(nmjmeans[6], 2),
     type = 'l',
     lwd = 3,
     col = std.colors[6])
}


beeswarm(NMJ$CTCF~NMJ$Genotype,
       #pch = 21,
       pwpch = 20+NMJ$Experiment,
       method = "center",
       #bg = hex(unique(std.colors[as.numeric(NMJ$Genotype)]),.5),
       pwbg = hex(NMJ$color, .75),
       add = T)


axis(side = 1,
     at = c(1:length(na.omit(nmjmeans))),
     labels = c(labels)[1:length(na.omit(nmjmeans))],
     las = 2,
     lwd = 0,
     line = -.75)

    lines(x = c(.225 + .3/length(na.omit(nmjmeans)), length(na.omit(nmjmeans))+.5),
       y = c(0,0),
       lwd = 3,
       xpd = T)


  y.at = c(0, 500, 1000, 1500, 2000)
    
  axis(side = 2,
       at = y.at,
       lwd = 2,
       line = 0,
       labels = F,
       xpd = T,
       las = 2)

  
  axis(side = 2,
       at = y.at,
       lwd = 3,
       line = 0,
       labels = T,
       xpd = T,
       las = 2)


```

```{r echo = F}
btd = temp[temp$Data == "NMJ" & temp$NMJ == "4",]

t.data = list("WT(cr/LoxP)" = btd$CTCF[btd$Genotype == "WT(cr/LoxP)"],
                    "G85R(cr/hr)" = btd$CTCF[btd$Genotype == "G85R(cr/hr)"],
                    "OK371-gbb; WT(cr/LoxP)" = btd$CTCF[btd$Genotype == "OK371-gbb; WT(cr/LoxP)"],
                    "OK371-gbb; G85R(cr/LoxP)" = btd$CTCF[btd$Genotype == "OK371-gbb; G85R(cr/LoxP)"],
                    "OK371-saxA; WT(cr/LoxP)" = btd$CTCF[btd$Genotype == "OK371-saxA; WT(cr/LoxP)"],
                    "OK371-saxA; G85R(cr/LoxP)" = btd$CTCF[btd$Genotype == "OK371-saxA; G85R(cr/LoxP)"])

t.table = data.frame(Genotype1 = character(),
                     Genotype2 = character(),
                     pval = numeric())

i=1
while(i <= length(t.data)){
  j = i+1
  while(j <= length(t.data)){
    t.temp = data.frame(Genotype1 = geno[i],
                        Genotype2 = geno[j],
                        pval = t.test(x = t.data[[i]],
                                      y = t.data[[j]],
                                      paired = F)[[3]])
    t.table = rbind(t.table, t.temp)
      j = j+1
  }
  i = i+1
}


t.stripe = t.table$pval <= .05
knitr::kable(t.table,
             caption = 'All t-tests for VNC data.')  %>%
kable_styling() %>%
row_spec(c(1:nrow(t.table))[t.table$pval <= .05], bold = T, color = "black", background = "gold")

```


```{r echo = F}

NMJ = temp[temp$Data == "NMJ" & temp$NMJ == "6-7",]
NMJ$CTCF = NMJ$CTCF/1000
geno = unique(NMJ$Genotype)
NMJ$color = as.numeric(NMJ$Genotype) + ((NMJ$Experiment -1)*6)
NMJ$color = c('navy', "orange2",
               "darkgreen", "turquoise4",
               "firebrick","deeppink3",
               "royalblue", 'gold',
               "green", 'cyan',
               "red", "pink") [NMJ$color]

labels = c("WT", "G85R",
           "OK-gbb WT", "OK-gbb G85R",
           "OK-SaxA WT", "OK-SaxA G85R")

nmjmeans = c(mean(NMJ[NMJ$Genotype == geno[1], "CTCF"]),
              mean(NMJ[NMJ$Genotype == geno[2], "CTCF"]),
              mean(NMJ[NMJ$Genotype == geno[3], "CTCF"]),
              mean(NMJ[NMJ$Genotype == geno[4], "CTCF"]),
              mean(NMJ[NMJ$Genotype == geno[5], "CTCF"]),
              mean(NMJ[NMJ$Genotype == geno[6], "CTCF"]))

par(mar=c(6.25, 4.1, 4.1, 5.6))

plot(x = c(.75,1.25),
     y = rep(nmjmeans[1], 2),
     type = 'l',
     lwd = 3,
     col = std.colors[1],
     ylim = c(0, max(NMJ$CTCF)*1.1),
     xlim = c(.5, length(na.omit(nmjmeans))+.5),
     xaxt = "n",
     ylab="Fluorescence Intensity/1000",
     yaxt = "n",
     xlab = NA,
     frame = F,
     main = paste("Larval segment 3, NMJ 6-7 fluorescence"))



lines(x = c(.65,1.35),
     y = rep(nmjmeans[1], 2),
     type = 'l',
     lwd = 3,
     col = std.colors[1])

lines(x = c(1.65,2.35),
     y = rep(nmjmeans[2], 2),
     type = 'l',
     lwd = 3,
     col = std.colors[2])

if(length(na.omit(nmjmeans)>2)){
lines(x = c(2.65,3.35),
     y = rep(nmjmeans[3], 2),
     type = 'l',
     lwd = 3,
     col = std.colors[3])

lines(x = c(3.65,4.35),
     y = rep(nmjmeans[4], 2),
     type = 'l',
     lwd = 3,
     col = std.colors[4])

lines(x = c(4.65,5.35),
     y = rep(nmjmeans[5], 2),
     type = 'l',
     lwd = 3,
     col = std.colors[5])

lines(x = c(5.65,6.35),
     y = rep(nmjmeans[6], 2),
     type = 'l',
     lwd = 3,
     col = std.colors[6])
}


beeswarm(NMJ$CTCF~NMJ$Genotype,
       #pch = 21,
       pwpch = 20+NMJ$Experiment,
       method = "center",
       #bg = hex(unique(std.colors[as.numeric(NMJ$Genotype)]),.5),
       pwbg = hex(NMJ$color, .75),
       add = T)


axis(side = 1,
     at = c(1:length(na.omit(nmjmeans))),
     labels = c(labels)[1:length(na.omit(nmjmeans))],
     las = 2,
     lwd = 0,
     line = -.75)

    lines(x = c(.225 + .3/length(na.omit(nmjmeans)), length(na.omit(nmjmeans))+.5),
       y = c(0,0),
       lwd = 3,
       xpd = T)


  y.at = c(0, 1000, 2000, 3000, 4000, 5000)
    
  axis(side = 2,
       at = y.at,
       lwd = 2,
       line = 0,
       labels = F,
       xpd = T,
       las = 2)

  
  axis(side = 2,
       at = y.at,
       lwd = 3,
       line = 0,
       labels = T,
       xpd = T,
       las = 2)


```


```{r echo = F}
btd = temp[temp$Data == "NMJ" & temp$NMJ == "6-7",]

t.data = list("WT(cr/LoxP)" = btd$CTCF[btd$Genotype == "WT(cr/LoxP)"],
                    "G85R(cr/hr)" = btd$CTCF[btd$Genotype == "G85R(cr/hr)"],
                    "OK371-gbb; WT(cr/LoxP)" = btd$CTCF[btd$Genotype == "OK371-gbb; WT(cr/LoxP)"],
                    "OK371-gbb; G85R(cr/LoxP)" = btd$CTCF[btd$Genotype == "OK371-gbb; G85R(cr/LoxP)"],
                    "OK371-saxA; WT(cr/LoxP)" = btd$CTCF[btd$Genotype == "OK371-saxA; WT(cr/LoxP)"],
                    "OK371-saxA; G85R(cr/LoxP)" = btd$CTCF[btd$Genotype == "OK371-saxA; G85R(cr/LoxP)"])

t.table = data.frame(Genotype1 = character(),
                     Genotype2 = character(),
                     pval = numeric())

i=1
while(i <= length(t.data)){
  j = i+1
  while(j <= length(t.data)){
    t.temp = data.frame(Genotype1 = geno[i],
                        Genotype2 = geno[j],
                        pval = t.test(x = t.data[[i]],
                                      y = t.data[[j]],
                                      paired = F)[[3]])
    t.table = rbind(t.table, t.temp)
      j = j+1
  }
  i = i+1
}


t.stripe = t.table$pval <= .05
knitr::kable(t.table,
             caption = 'All t-tests for VNC data.')  %>%
kable_styling() %>%
row_spec(c(1:nrow(t.table))[t.table$pval <= .05], bold = T, color = "black", background = "gold")

```


