---
title: "Larval Locomotion"
author: "John Santiago"
date: "2025-05-05"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```



```{r echo = F}
library(kableExtra)
#library(gtools)
#library(gplots)
library(beeswarm)

temp = read.csv("/Users/johncsantiago/Documents/GitHub/Python/LarvalLocomotion/PreliminaryCode/20250702_WTmale.csv")

duration = 90

distance = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))

i=1
while(i<=length(unique(names(distance)))){
  j = 101
  while(j < max(temp$Frame)){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    distance[i] = distance[i] + sqrt((x2-x1)^2 + (y2-y1)^2)
    j=j+100
  }
  i=i+1
}

```



```{r echo = F, include = F}

library(png)
#temp = read.csv("/Users/johncsantiago/Documents/GitHub/Python/LarvalLocomotion/PreliminaryCode/object_trajectories.csv")

#bgpic = readPNG("/Users/johncsantiago/Documents/GitHub/Python/LarvalLocomotion/PreliminaryCode/trajectory_with_snapshots.png")

#temp$y = 720 - temp$y

#plot(0:1080, type ="n",
     
#     ylim = c(0,720), xlim = c(0,1080)) #ylim = c(300,600), xlim = c(200,600))#

#rasterImage(bgpic, xleft = 0,
#            xright = 1080,
#            ybottom = 0,
#            ytop = 720)

```


```{r echo = F, fig.height=7, fig.width= 7}

library(png)

temp = read.csv("/Users/johncsantiago/Documents/GitHub/Python/LarvalLocomotion/PreliminaryCode/20250702_WTmale.csv")
title = "7/2 WT male"


max.frame = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))
max.frame = c(max(temp$Frame[temp$ObjectID == 1]),
              max(temp$Frame[temp$ObjectID == 2]),
              max(temp$Frame[temp$ObjectID == 3]),
              max(temp$Frame[temp$ObjectID == 4]),
              max(temp$Frame[temp$ObjectID == 5]))


temp = temp[(temp$ObjectID == 1 & temp$Frame <= max.frame[1]) |
              (temp$ObjectID == 2 & temp$Frame <= max.frame[2]) |
              (temp$ObjectID == 3 & temp$Frame <= max.frame[3]) |
              (temp$ObjectID == 4 & temp$Frame <= max.frame[4]) |
              (temp$ObjectID == 5 & temp$Frame <= max.frame[5]),]

distance = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))

temp$Y = 1400 - temp$Y
i=1
while(i<=length(unique(names(distance)))){
  j = 101
  while(j < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    distance[i] = distance[i] + sqrt((x2-x1)^2 + (y2-y1)^2)
    j=j+100
  }
  i=i+1
}



speed = distance/(max.frame/100)

WT2.dist = distance
WT2.speed = speed

#bgpic = readPNG("/Users/johncsantiago/Documents/GitHub/WhartonLab/Python/LarvalLocomotion/PreliminaryCode/trajectory_with_snapshots.png")

#temp$y = 720 - temp$y

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,1400), xlim = c(0,1400),
     xlab = "",
     ylab = "") #ylim = c(300,600), xlim = c(200,600))#

#rasterImage(bgpic, xleft = 0,
#            xright = 1080,
#            ybottom = 0,
#            ytop = 720)

lines(x = temp$X[temp$ObjectID ==1],
     y = temp$Y[temp$ObjectID ==1],
     lwd = 1,
     col = "darkorange")


lines(x = temp$X[temp$ObjectID ==2],
     y = temp$Y[temp$ObjectID ==2],
     lwd = 1,
     col = "firebrick")

lines(x = temp$X[temp$ObjectID ==3],
     y = temp$Y[temp$ObjectID ==3],
     lwd = 1,
     col = "royalblue")

lines(x = temp$X[temp$ObjectID ==4],
     y = temp$Y[temp$ObjectID ==4],
     lwd = 1,
     col = "darkgreen")

lines(x = temp$X[temp$ObjectID ==5],
     y = temp$Y[temp$ObjectID ==5],
     lwd = 1,
     col = "violetred")

legend(x = 1460,
       y = 1400,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4),
                  signif(speed[2],4),
                  signif(speed[3],4),
                  signif(speed[4],4),
                  signif(speed[5],4)), 
       fill = c("darkorange", "firebrick", "royalblue", 'darkgreen', 'violetred'),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")

```

```{r echo = F, fig.height=7, fig.width= 7}


frame.distance = data.frame(Rep = c(rep("1", ((floor(max.frame[1]/100)))),
                                 rep("2", ((floor(max.frame[2]/100)))),
                                 rep("3", ((floor(max.frame[3]/100)))),
                                 rep("4", ((floor(max.frame[4]/100)))),
                                 rep("5", ((floor(max.frame[5]/100))))),
                      frame = c(100*(1:floor(max.frame[1]/100)-1),
                                100*(1:floor(max.frame[2]/100)-1),
                                100*(1:floor(max.frame[3]/100)-1),
                                100*(1:floor(max.frame[4]/100)-1),
                                100*(1:floor(max.frame[5]/100)-1)),
                        distance = c(0))


i=1
while(i<=length(unique(names(distance)))){
  temp.distance = 0
  j = 200
  while(j-100 < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    temp.distance = temp.distance + sqrt((x2-x1)^2 + (y2-y1)^2)
    frame.distance[frame.distance$Rep == names(distance)[i] &
                     frame.distance$frame == j-100, "distance"]= temp.distance
    j=j+100
  }
  i=i+1
}

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,600), xlim = c(0,2700),
     xlab = "Frame",
     ylab = "Distance (px)")

lines(x = frame.distance$frame[frame.distance$Rep ==1],
     y = frame.distance$distance[frame.distance$Rep ==1],
     lwd = 1,
     col = "darkorange")


lines(x = frame.distance$frame[frame.distance$Rep ==2],
     y = frame.distance$distance[frame.distance$Rep ==2],
     lwd = 1,
     col = "firebrick")

lines(x = frame.distance$frame[frame.distance$Rep ==3],
     y = frame.distance$distance[frame.distance$Rep ==3],
     lwd = 1,
     col = "royalblue")

lines(x = frame.distance$frame[frame.distance$Rep ==4],
     y = frame.distance$distance[frame.distance$Rep ==4],
     lwd = 1,
     col = "darkgreen")

lines(x = frame.distance$frame[frame.distance$Rep ==5],
     y = frame.distance$distance[frame.distance$Rep ==5],
     lwd = 1,
     col = "violetred")

legend(x = 2800,
       y = 600,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4),
                  signif(speed[2],4),
                  signif(speed[3],4),
                  signif(speed[4],4),
                  signif(speed[5],4)), 
       fill = c("darkorange", "firebrick", "royalblue", 'darkgreen', 'violetred'),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")
       


```



```{r echo = F, fig.height=7, fig.width= 7}

temp = read.csv("/Users/johncsantiago/Documents/GitHub/Python/LarvalLocomotion/PreliminaryCode/20250702_G85Rmale.csv")
title = "7/2 G85R male"

max.frame = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))
max.frame = c(max(temp$Frame[temp$ObjectID == 1]),
              max(temp$Frame[temp$ObjectID == 2]),
              max(temp$Frame[temp$ObjectID == 3]),
              max(temp$Frame[temp$ObjectID == 4]),
              max(temp$Frame[temp$ObjectID == 5]))


temp = temp[(temp$ObjectID == 1 & temp$Frame <= max.frame[1]) |
              (temp$ObjectID == 2 & temp$Frame <= max.frame[2]) |
              (temp$ObjectID == 3 & temp$Frame <= max.frame[3]) |
              (temp$ObjectID == 4 & temp$Frame <= max.frame[4]) |
              (temp$ObjectID == 5 & temp$Frame <= max.frame[5]),]

distance = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))

temp$Y = 1400 - temp$Y
i=1
while(i<=length(unique(names(distance)))){
  j = 101
  while(j < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    distance[i] = distance[i] + sqrt((x2-x1)^2 + (y2-y1)^2)
    j=j+100
  }
  i=i+1
}



speed = distance/(max.frame/100)

G85R2.dist = distance
G85R2.speed = speed

#bgpic = readPNG("/Users/johncsantiago/Documents/GitHub/WhartonLab/Python/LarvalLocomotion/PreliminaryCode/trajectory_with_snapshots.png")

#temp$y = 720 - temp$y

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,1400), xlim = c(0,1400),
     xlab = "",
     ylab = "") #ylim = c(300,600), xlim = c(200,600))#

#rasterImage(bgpic, xleft = 0,
#            xright = 1080,
#            ybottom = 0,
#            ytop = 720)

lines(x = temp$X[temp$ObjectID ==1],
     y = temp$Y[temp$ObjectID ==1],
     lwd = 1,
     col = "darkorange")


lines(x = temp$X[temp$ObjectID ==2],
     y = temp$Y[temp$ObjectID ==2],
     lwd = 1,
     col = "firebrick")

lines(x = temp$X[temp$ObjectID ==3],
     y = temp$Y[temp$ObjectID ==3],
     lwd = 1,
     col = "royalblue")

lines(x = temp$X[temp$ObjectID ==4],
     y = temp$Y[temp$ObjectID ==4],
     lwd = 1,
     col = "darkgreen")

lines(x = temp$X[temp$ObjectID ==5],
     y = temp$Y[temp$ObjectID ==5],
     lwd = 1,
     col = "violetred")

legend(x = 1460,
       y = 1400,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4),
                  signif(speed[2],4),
                  signif(speed[3],4),
                  signif(speed[4],4),
                  signif(speed[5],4)), 
       fill = c("darkorange", "firebrick", "royalblue", 'darkgreen', 'violetred'),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")

```

```{r echo = F, fig.height=7, fig.width= 7}


frame.distance = data.frame(Rep = c(rep("1", ((floor(max.frame[1]/100)))),
                                 rep("2", ((floor(max.frame[2]/100)))),
                                 rep("3", ((floor(max.frame[3]/100)))),
                                 rep("4", ((floor(max.frame[4]/100)))),
                                 rep("5", ((floor(max.frame[5]/100))))),
                      frame = c(100*(1:floor(max.frame[1]/100)-1),
                                100*(1:floor(max.frame[2]/100)-1),
                                100*(1:floor(max.frame[3]/100)-1),
                                100*(1:floor(max.frame[4]/100)-1),
                                100*(1:floor(max.frame[5]/100)-1)),
                        distance = c(0))


i=1
while(i<=length(unique(names(distance)))){
  temp.distance = 0
  j = 200
  while(j-100 < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    temp.distance = temp.distance + sqrt((x2-x1)^2 + (y2-y1)^2)
    frame.distance[frame.distance$Rep == names(distance)[i] &
                     frame.distance$frame == j-100, "distance"]= temp.distance
    j=j+100
  }
  i=i+1
}

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,600), xlim = c(0,2700),
     xlab = "Frame",
     ylab = "Distance (px)")

lines(x = frame.distance$frame[frame.distance$Rep ==1],
     y = frame.distance$distance[frame.distance$Rep ==1],
     lwd = 1,
     col = "darkorange")


lines(x = frame.distance$frame[frame.distance$Rep ==2],
     y = frame.distance$distance[frame.distance$Rep ==2],
     lwd = 1,
     col = "firebrick")

lines(x = frame.distance$frame[frame.distance$Rep ==3],
     y = frame.distance$distance[frame.distance$Rep ==3],
     lwd = 1,
     col = "royalblue")

lines(x = frame.distance$frame[frame.distance$Rep ==4],
     y = frame.distance$distance[frame.distance$Rep ==4],
     lwd = 1,
     col = "darkgreen")

lines(x = frame.distance$frame[frame.distance$Rep ==5],
     y = frame.distance$distance[frame.distance$Rep ==5],
     lwd = 1,
     col = "violetred")

legend(x = 2800,
       y = 600,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4),
                  signif(speed[2],4),
                  signif(speed[3],4),
                  signif(speed[4],4),
                  signif(speed[5],4)), 
       fill = c("darkorange", "firebrick", "royalblue", 'darkgreen', 'violetred'),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")
       


```

```{r echo = F, fig.height=7, fig.width= 7}

temp = read.csv("/Users/johncsantiago/Documents/GitHub/Python/LarvalLocomotion/PreliminaryCode/20250702_ChATtrioWTmale.csv")
title = "7/2 ChAT->trio WT male"

max.frame = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))
max.frame = c(max(temp$Frame[temp$ObjectID == 1]),
              max(temp$Frame[temp$ObjectID == 2]),
              max(temp$Frame[temp$ObjectID == 3]),
              max(temp$Frame[temp$ObjectID == 4]),
              max(temp$Frame[temp$ObjectID == 5]))

##larvae goes out of frame
max.frame[3] = 1400
##larvae goes out of frame
max.frame[4] = 1930


temp = temp[(temp$ObjectID == 1 & temp$Frame <= max.frame[1]) |
              (temp$ObjectID == 2 & temp$Frame <= max.frame[2]) |
              (temp$ObjectID == 3 & temp$Frame <= max.frame[3]) |
              (temp$ObjectID == 4 & temp$Frame <= max.frame[4]) |
              (temp$ObjectID == 5 & temp$Frame <= max.frame[5]),]

distance = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))

temp$Y = 1400 - temp$Y
i=1
while(i<=length(unique(names(distance)))){
  j = 101
  while(j < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    distance[i] = distance[i] + sqrt((x2-x1)^2 + (y2-y1)^2)
    j=j+100
  }
  i=i+1
}



speed = distance/(max.frame/100)

trioWT2.dist = distance
trioWT2.speed = speed

#bgpic = readPNG("/Users/johncsantiago/Documents/GitHub/WhartonLab/Python/LarvalLocomotion/PreliminaryCode/trajectory_with_snapshots.png")

#temp$y = 720 - temp$y

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,1400), xlim = c(0,1400),
     xlab = "",
     ylab = "") #ylim = c(300,600), xlim = c(200,600))#

#rasterImage(bgpic, xleft = 0,
#            xright = 1080,
#            ybottom = 0,
#            ytop = 720)

lines(x = temp$X[temp$ObjectID ==1],
     y = temp$Y[temp$ObjectID ==1],
     lwd = 1,
     col = "darkorange")


lines(x = temp$X[temp$ObjectID ==2],
     y = temp$Y[temp$ObjectID ==2],
     lwd = 1,
     col = "firebrick")

lines(x = temp$X[temp$ObjectID ==3],
     y = temp$Y[temp$ObjectID ==3],
     lwd = 1,
     col = "royalblue")

lines(x = temp$X[temp$ObjectID ==4],
     y = temp$Y[temp$ObjectID ==4],
     lwd = 1,
     col = "darkgreen")

lines(x = temp$X[temp$ObjectID ==5],
     y = temp$Y[temp$ObjectID ==5],
     lwd = 1,
     col = "violetred")

legend(x = 1460,
       y = 1400,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4),
                  signif(speed[2],4),
                  signif(speed[3],4),
                  signif(speed[4],4),
                  signif(speed[5],4)), 
       fill = c("darkorange", "firebrick", "royalblue", 'darkgreen', 'violetred'),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")

```


```{r echo = F, fig.height=7, fig.width= 7}


frame.distance = data.frame(Rep = c(rep("1", ((floor(max.frame[1]/100)))),
                                 rep("2", ((floor(max.frame[2]/100)))),
                                 rep("3", ((floor(max.frame[3]/100)))),
                                 rep("4", ((floor(max.frame[4]/100)))),
                                 rep("5", ((floor(max.frame[5]/100))))),
                      frame = c(100*(1:floor(max.frame[1]/100)-1),
                                100*(1:floor(max.frame[2]/100)-1),
                                100*(1:floor(max.frame[3]/100)-1),
                                100*(1:floor(max.frame[4]/100)-1),
                                100*(1:floor(max.frame[5]/100)-1)),
                        distance = c(0))


i=1
while(i<=length(unique(names(distance)))){
  temp.distance = 0
  j = 200
  while(j-100 < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    temp.distance = temp.distance + sqrt((x2-x1)^2 + (y2-y1)^2)
    frame.distance[frame.distance$Rep == names(distance)[i] &
                     frame.distance$frame == j-100, "distance"]= temp.distance
    j=j+100
  }
  i=i+1
}

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,600), xlim = c(0,2700),
     xlab = "Frame",
     ylab = "Distance (px)")

lines(x = frame.distance$frame[frame.distance$Rep ==1],
     y = frame.distance$distance[frame.distance$Rep ==1],
     lwd = 1,
     col = "darkorange")


lines(x = frame.distance$frame[frame.distance$Rep ==2],
     y = frame.distance$distance[frame.distance$Rep ==2],
     lwd = 1,
     col = "firebrick")

lines(x = frame.distance$frame[frame.distance$Rep ==3],
     y = frame.distance$distance[frame.distance$Rep ==3],
     lwd = 1,
     col = "royalblue")

lines(x = frame.distance$frame[frame.distance$Rep ==4],
     y = frame.distance$distance[frame.distance$Rep ==4],
     lwd = 1,
     col = "darkgreen")

lines(x = frame.distance$frame[frame.distance$Rep ==5],
     y = frame.distance$distance[frame.distance$Rep ==5],
     lwd = 1,
     col = "violetred")

legend(x = 2800,
       y = 600,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4),
                  signif(speed[2],4),
                  signif(speed[3],4),
                  signif(speed[4],4),
                  signif(speed[5],4)), 
       fill = c("darkorange", "firebrick", "royalblue", 'darkgreen', 'violetred'),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")
       


```


```{r echo = F, fig.height=7, fig.width= 7}

temp = read.csv("/Users/johncsantiago/Documents/GitHub/Python/LarvalLocomotion/PreliminaryCode/20250702_ChATtrioG85Rmale.csv")
title = "7/2 ChAT->trio G85R male"

max.frame = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))
max.frame = c(max(temp$Frame[temp$ObjectID == 1]),
              max(temp$Frame[temp$ObjectID == 2]),
              max(temp$Frame[temp$ObjectID == 3]),
              max(temp$Frame[temp$ObjectID == 4]),
              max(temp$Frame[temp$ObjectID == 5]))

##larvae goes out of frame
max.frame[1] = 1324

temp = temp[(temp$ObjectID == 1 & temp$Frame <= max.frame[1]) |
              (temp$ObjectID == 2 & temp$Frame <= max.frame[2]) |
              (temp$ObjectID == 3 & temp$Frame <= max.frame[3]) |
              (temp$ObjectID == 4 & temp$Frame <= max.frame[4]) |
              (temp$ObjectID == 5 & temp$Frame <= max.frame[5]),]

distance = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))

temp$Y = 1400 - temp$Y
i=1
while(i<=length(unique(names(distance)))){
  j = 101
  while(j < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    distance[i] = distance[i] + sqrt((x2-x1)^2 + (y2-y1)^2)
    j=j+100
  }
  i=i+1
}



speed = distance/(max.frame/100)

trioG85R2.dist = distance
trioG85R2.speed = speed

#bgpic = readPNG("/Users/johncsantiago/Documents/GitHub/WhartonLab/Python/LarvalLocomotion/PreliminaryCode/trajectory_with_snapshots.png")

#temp$y = 720 - temp$y

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,1400), xlim = c(0,1400),
     xlab = "",
     ylab = "") #ylim = c(300,600), xlim = c(200,600))#

#rasterImage(bgpic, xleft = 0,
#            xright = 1080,
#            ybottom = 0,
#            ytop = 720)

lines(x = temp$X[temp$ObjectID ==1],
     y = temp$Y[temp$ObjectID ==1],
     lwd = 1,
     col = "darkorange")


lines(x = temp$X[temp$ObjectID ==2],
     y = temp$Y[temp$ObjectID ==2],
     lwd = 1,
     col = "firebrick")

lines(x = temp$X[temp$ObjectID ==3],
     y = temp$Y[temp$ObjectID ==3],
     lwd = 1,
     col = "royalblue")

lines(x = temp$X[temp$ObjectID ==4],
     y = temp$Y[temp$ObjectID ==4],
     lwd = 1,
     col = "darkgreen")

lines(x = temp$X[temp$ObjectID ==5],
     y = temp$Y[temp$ObjectID ==5],
     lwd = 1,
     col = "violetred")

legend(x = 1460,
       y = 1400,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4),
                  signif(speed[2],4),
                  signif(speed[3],4),
                  signif(speed[4],4),
                  signif(speed[5],4)), 
       fill = c("darkorange", "firebrick", "royalblue", 'darkgreen', 'violetred'),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")



```


```{r echo = F, fig.height=7, fig.width= 7}


frame.distance = data.frame(Rep = c(rep("1", ((floor(max.frame[1]/100)))),
                                 rep("2", ((floor(max.frame[2]/100)))),
                                 rep("3", ((floor(max.frame[3]/100)))),
                                 rep("4", ((floor(max.frame[4]/100)))),
                                 rep("5", ((floor(max.frame[5]/100))))),
                      frame = c(100*(1:floor(max.frame[1]/100)-1),
                                100*(1:floor(max.frame[2]/100)-1),
                                100*(1:floor(max.frame[3]/100)-1),
                                100*(1:floor(max.frame[4]/100)-1),
                                100*(1:floor(max.frame[5]/100)-1)),
                        distance = c(0))


i=1
while(i<=length(unique(names(distance)))){
  temp.distance = 0
  j = 200
  while(j-100 < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    temp.distance = temp.distance + sqrt((x2-x1)^2 + (y2-y1)^2)
    frame.distance[frame.distance$Rep == names(distance)[i] &
                     frame.distance$frame == j-100, "distance"]= temp.distance
    j=j+100
  }
  i=i+1
}

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,600), xlim = c(0,2700),
     xlab = "Frame",
     ylab = "Distance (px)")

lines(x = frame.distance$frame[frame.distance$Rep ==1],
     y = frame.distance$distance[frame.distance$Rep ==1],
     lwd = 1,
     col = "darkorange")


lines(x = frame.distance$frame[frame.distance$Rep ==2],
     y = frame.distance$distance[frame.distance$Rep ==2],
     lwd = 1,
     col = "firebrick")

lines(x = frame.distance$frame[frame.distance$Rep ==3],
     y = frame.distance$distance[frame.distance$Rep ==3],
     lwd = 1,
     col = "royalblue")

lines(x = frame.distance$frame[frame.distance$Rep ==4],
     y = frame.distance$distance[frame.distance$Rep ==4],
     lwd = 1,
     col = "darkgreen")

lines(x = frame.distance$frame[frame.distance$Rep ==5],
     y = frame.distance$distance[frame.distance$Rep ==5],
     lwd = 1,
     col = "violetred")

legend(x = 2800,
       y = 600,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4),
                  signif(speed[2],4),
                  signif(speed[3],4),
                  signif(speed[4],4),
                  signif(speed[5],4)), 
       fill = c("darkorange", "firebrick", "royalblue", 'darkgreen', 'violetred'),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")
       


```


```{r echo = F}
std.colors = setNames(c('navy', "orange2", 
                        "darkgreen", "firebrick",
                        "turquoise3", "deeppink"),
                      c("WT(cr/LoxP)" , "G85R(cr/hr)",
                        "OK371-gbb; WT(cr/LoxP)", "OK371-gbb; G85R(cr/LoxP)",
                        "OK371-saxA; WT(cr/LoxP)", "OK371-saxA; G85R(cr/LoxP)"))


hex = function(color, alpha){
  rgb2hex = color
  i = 1
  while(i <= length(color)){
    rgbvals = col2rgb(color[i])
    rgb2hex[i] = rgb(rgbvals[1]/255, rgbvals[2]/255, rgbvals[3]/255, alpha)
    i = i+1
  }
  return(rgb2hex)
}

speed.means = data.frame(WT = mean(WT2.speed),
                         G85R = mean(G85R2.speed),
                         trioWT = mean(trioWT2.speed),
                         trioG85R = mean(trioG85R2.speed))

speed.data = data.frame(Geno = c(rep("WT", length(WT2.speed)),
                                 rep("G85R", length(G85R2.speed)),
                                 rep("trioWT", length(trioWT2.speed)),
                                 rep("trioG85R", length(trioG85R2.speed))),
                        Speed = c(WT2.speed,
                                  G85R2.speed,
                                  trioWT2.speed,
                                  trioG85R2.speed))

speed.data$Geno = factor(speed.data$Geno, levels = c("WT", "G85R", "trioWT", "trioG85R"))

par(mar=c(6.25, 4.1, 4.1, 5.6))

plot(x = c(.75,1.25),
     y = rep(speed.means[1], 2),
     type = 'l',
     lwd = 3,
     col = std.colors[1],
     ylim = c(0, max(speed.data$Speed)*1.1),
     xlim = c(.5, length(na.omit(speed.means))+.5),
     xaxt = "n",
     ylab="Larvae Speed (px/100 frames)",
     yaxt = "n",
     xlab = NA,
     frame = F,
     main = "Larval Locomotion")

lines(x = c(1.65,2.35),
     y = rep(speed.means[2], 2),
     type = 'l',
     lwd = 3,
     col = std.colors[2])

lines(x = c(2.65,3.35),
     y = rep(speed.means[3], 2),
     type = 'l',
     lwd = 3,
     col = std.colors[3])

lines(x = c(3.65,4.35),
     y = rep(speed.means[4], 2),
     type = 'l',
     lwd = 3,
     col = std.colors[4])

beeswarm(speed.data$Speed~speed.data$Geno,
       pch = 21,
       method = "center",
       bg = hex(unique(std.colors[as.numeric(speed.data$Geno)]),.5),
       add = T)

axis(side = 1,
     at = c(1:4),
     labels = levels(speed.data$Geno),
     las = 1,
     lwd = 0,
     line = -.75)

lines(x = c(0.25, 4.5),
      y = c(0,0),
      lwd = 3,
      xpd = T)

  axis(side = 2,
       at = c(0,5,10,15,20,25,30),
       lwd = 2,
       line = 0,
       labels = F,
       xpd = T,
       las = 2)

  
  axis(side = 2,
       at = c(0,5,10,15,20,25,30),
       lwd = 3,
       line = 0,
       labels = T,
       xpd = T,
       las = 2)
  
```


```{r echo = F}


t.data = list("WT" = WT2.speed,
              "G85R" = G85R2.speed,
              "trioWT" = trioWT2.speed,
              "trioG85R" = trioG85R2.speed)

t.table = data.frame(Genotype1 = character(),
                     Genotype2 = character(),
                     pval = numeric())

i=1
while(i <= length(t.data)){
  j = i+1
  while(j <= length(t.data)){
    t.temp = data.frame(Genotype1 = names(t.data)[i],
                        Genotype2 = names(t.data)[j],
                        pval = t.test(x = t.data[[i]],
                                      y = t.data[[j]],
                                      paired = F)[[3]])
    t.table = rbind(t.table, t.temp)
      j = j+1
  }
  i = i+1
}


t.stripe = t.table$pval <= .05
knitr::kable(t.table,
             caption = 'All t-tests larval locomotion')  %>%
kable_styling() %>%
row_spec(c(1:nrow(t.table))[t.table$pval <= .05], bold = T, color = "black", background = "gold")

```



```{r echo = F, fig.height=7, fig.width= 7}

library(png)

temp = read.csv("/Users/johncsantiago/Documents/GitHub/Python/LarvalLocomotion/PreliminaryCode/20250703_WT.csv")
title = "7/3 WT male"


max.frame = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))
max.frame = c(1500,
              1500,
              max(temp$Frame[temp$ObjectID == 3]),
              1900,
              max(temp$Frame[temp$ObjectID == 5]))


temp = temp[(temp$ObjectID == 1 & temp$Frame <= max.frame[1]) |
              (temp$ObjectID == 2 & temp$Frame <= max.frame[2]) |
              (temp$ObjectID == 3 & temp$Frame <= max.frame[3]) |
              (temp$ObjectID == 4 & temp$Frame <= max.frame[4]) |
              (temp$ObjectID == 5 & temp$Frame <= max.frame[5]),]

distance = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))

temp$Y = 1400 - temp$Y
temp$X = 1400 - temp$X

x = temp$Y
y = temp$X

temp$X = x
temp$Y = y

i=1
while(i<=length(unique(names(distance)))){
  j = 101
  while(j < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    distance[i] = distance[i] + sqrt((x2-x1)^2 + (y2-y1)^2)
    j=j+100
  }
  i=i+1
}



speed = distance/(max.frame/100)

WT3.dist = distance
WT3.speed = speed

#bgpic = readPNG("/Users/johncsantiago/Documents/GitHub/WhartonLab/Python/LarvalLocomotion/PreliminaryCode/trajectory_with_snapshots.png")

#temp$y = 720 - temp$y

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,1400), xlim = c(0,1400),
     xlab = "",
     ylab = "") #ylim = c(300,600), xlim = c(200,600))#

#rasterImage(bgpic, xleft = 0,
#            xright = 1080,
#            ybottom = 0,
#            ytop = 720)

lines(x = temp$X[temp$ObjectID ==1],
     y = temp$Y[temp$ObjectID ==1],
     lwd = 1,
     col = "darkorange")


lines(x = temp$X[temp$ObjectID ==2],
     y = temp$Y[temp$ObjectID ==2],
     lwd = 1,
     col = "firebrick")

lines(x = temp$X[temp$ObjectID ==3],
     y = temp$Y[temp$ObjectID ==3],
     lwd = 1,
     col = "royalblue")

lines(x = temp$X[temp$ObjectID ==4],
     y = temp$Y[temp$ObjectID ==4],
     lwd = 1,
     col = "darkgreen")

lines(x = temp$X[temp$ObjectID ==5],
     y = temp$Y[temp$ObjectID ==5],
     lwd = 1,
     col = "violetred")

legend(x = 1460,
       y = 1400,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4),
                  signif(speed[2],4),
                  signif(speed[3],4),
                  signif(speed[4],4),
                  signif(speed[5],4)), 
       fill = c("darkorange", "firebrick", "royalblue", 'darkgreen', 'violetred'),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")

```

```{r echo = F, fig.height=7, fig.width= 7}


frame.distance = data.frame(Rep = c(rep("1", ((floor(max.frame[1]/100)))),
                                 rep("2", ((floor(max.frame[2]/100)))),
                                 rep("3", ((floor(max.frame[3]/100)))),
                                 rep("4", ((floor(max.frame[4]/100)))),
                                 rep("5", ((floor(max.frame[5]/100))))),
                      frame = c(100*(1:floor(max.frame[1]/100)-1),
                                100*(1:floor(max.frame[2]/100)-1),
                                100*(1:floor(max.frame[3]/100)-1),
                                100*(1:floor(max.frame[4]/100)-1),
                                100*(1:floor(max.frame[5]/100)-1)),
                        distance = c(0))


i=1
while(i<=length(unique(names(distance)))){
  temp.distance = 0
  j = 200
  while(j-100 < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    temp.distance = temp.distance + sqrt((x2-x1)^2 + (y2-y1)^2)
    frame.distance[frame.distance$Rep == names(distance)[i] &
                     frame.distance$frame == j-100, "distance"]= temp.distance
    j=j+100
  }
  i=i+1
}

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,600), xlim = c(0,2700),
     xlab = "Frame",
     ylab = "Distance (px)")

lines(x = frame.distance$frame[frame.distance$Rep ==1],
     y = frame.distance$distance[frame.distance$Rep ==1],
     lwd = 1,
     col = "darkorange")


lines(x = frame.distance$frame[frame.distance$Rep ==2],
     y = frame.distance$distance[frame.distance$Rep ==2],
     lwd = 1,
     col = "firebrick")

lines(x = frame.distance$frame[frame.distance$Rep ==3],
     y = frame.distance$distance[frame.distance$Rep ==3],
     lwd = 1,
     col = "royalblue")

lines(x = frame.distance$frame[frame.distance$Rep ==4],
     y = frame.distance$distance[frame.distance$Rep ==4],
     lwd = 1,
     col = "darkgreen")

lines(x = frame.distance$frame[frame.distance$Rep ==5],
     y = frame.distance$distance[frame.distance$Rep ==5],
     lwd = 1,
     col = "violetred")

legend(x = 2800,
       y = 600,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4),
                  signif(speed[2],4),
                  signif(speed[3],4),
                  signif(speed[4],4),
                  signif(speed[5],4)), 
       fill = c("darkorange", "firebrick", "royalblue", 'darkgreen', 'violetred'),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")
       


```

    

  

```{r echo = F, fig.height=7, fig.width= 7}

library(png)

temp = read.csv("/Users/johncsantiago/Documents/GitHub/Python/LarvalLocomotion/PreliminaryCode/20250703_G85R.csv")
title = "7/3 G85R male"


max.frame = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))
max.frame = c(max(temp$Frame[temp$ObjectID == 1]),
              max(temp$Frame[temp$ObjectID == 2]),
              max(temp$Frame[temp$ObjectID == 3]),
              max(temp$Frame[temp$ObjectID == 4]),
              2400)


temp = temp[(temp$ObjectID == 1 & temp$Frame <= max.frame[1]) |
              (temp$ObjectID == 2 & temp$Frame <= max.frame[2]) |
              (temp$ObjectID == 3 & temp$Frame <= max.frame[3]) |
              (temp$ObjectID == 4 & temp$Frame <= max.frame[4]) |
              (temp$ObjectID == 5 & temp$Frame <= max.frame[5]),]

distance = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))

temp$Y = 1400 - temp$Y
temp$X = 1400 - temp$X

x = temp$Y
y = temp$X

temp$X = x
temp$Y = y

i=1
while(i<=length(unique(names(distance)))){
  j = 101
  while(j < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    distance[i] = distance[i] + sqrt((x2-x1)^2 + (y2-y1)^2)
    j=j+100
  }
  i=i+1
}



speed = distance/(max.frame/100)

G85R3.dist = distance
G85R3.speed = speed

#bgpic = readPNG("/Users/johncsantiago/Documents/GitHub/WhartonLab/Python/LarvalLocomotion/PreliminaryCode/trajectory_with_snapshots.png")

#temp$y = 720 - temp$y

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,1400), xlim = c(0,1400),
     xlab = "",
     ylab = "") #ylim = c(300,600), xlim = c(200,600))#

#rasterImage(bgpic, xleft = 0,
#            xright = 1080,
#            ybottom = 0,
#            ytop = 720)

lines(x = temp$X[temp$ObjectID ==1],
     y = temp$Y[temp$ObjectID ==1],
     lwd = 1,
     col = "darkorange")


lines(x = temp$X[temp$ObjectID ==2],
     y = temp$Y[temp$ObjectID ==2],
     lwd = 1,
     col = "firebrick")

lines(x = temp$X[temp$ObjectID ==3],
     y = temp$Y[temp$ObjectID ==3],
     lwd = 1,
     col = "royalblue")

lines(x = temp$X[temp$ObjectID ==4],
     y = temp$Y[temp$ObjectID ==4],
     lwd = 1,
     col = "darkgreen")

lines(x = temp$X[temp$ObjectID ==5],
     y = temp$Y[temp$ObjectID ==5],
     lwd = 1,
     col = "violetred")

legend(x = 1460,
       y = 1400,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4),
                  signif(speed[2],4),
                  signif(speed[3],4),
                  signif(speed[4],4),
                  signif(speed[5],4)), 
       fill = c("darkorange", "firebrick", "royalblue", 'darkgreen', 'violetred'),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")

```

```{r echo = F, fig.height=7, fig.width= 7}


frame.distance = data.frame(Rep = c(rep("1", ((floor(max.frame[1]/100)))),
                                 rep("2", ((floor(max.frame[2]/100)))),
                                 rep("3", ((floor(max.frame[3]/100)))),
                                 rep("4", ((floor(max.frame[4]/100)))),
                                 rep("5", ((floor(max.frame[5]/100))))),
                      frame = c(100*(1:floor(max.frame[1]/100)-1),
                                100*(1:floor(max.frame[2]/100)-1),
                                100*(1:floor(max.frame[3]/100)-1),
                                100*(1:floor(max.frame[4]/100)-1),
                                100*(1:floor(max.frame[5]/100)-1)),
                        distance = c(0))


i=1
while(i<=length(unique(names(distance)))){
  temp.distance = 0
  j = 200
  while(j-100 < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    temp.distance = temp.distance + sqrt((x2-x1)^2 + (y2-y1)^2)
    frame.distance[frame.distance$Rep == names(distance)[i] &
                     frame.distance$frame == j-100, "distance"]= temp.distance
    j=j+100
  }
  i=i+1
}

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,600), xlim = c(0,2700),
     xlab = "Frame",
     ylab = "Distance (px)")

lines(x = frame.distance$frame[frame.distance$Rep ==1],
     y = frame.distance$distance[frame.distance$Rep ==1],
     lwd = 1,
     col = "darkorange")


lines(x = frame.distance$frame[frame.distance$Rep ==2],
     y = frame.distance$distance[frame.distance$Rep ==2],
     lwd = 1,
     col = "firebrick")

lines(x = frame.distance$frame[frame.distance$Rep ==3],
     y = frame.distance$distance[frame.distance$Rep ==3],
     lwd = 1,
     col = "royalblue")

lines(x = frame.distance$frame[frame.distance$Rep ==4],
     y = frame.distance$distance[frame.distance$Rep ==4],
     lwd = 1,
     col = "darkgreen")

lines(x = frame.distance$frame[frame.distance$Rep ==5],
     y = frame.distance$distance[frame.distance$Rep ==5],
     lwd = 1,
     col = "violetred")

legend(x = 2800,
       y = 600,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4),
                  signif(speed[2],4),
                  signif(speed[3],4),
                  signif(speed[4],4),
                  signif(speed[5],4)), 
       fill = c("darkorange", "firebrick", "royalblue", 'darkgreen', 'violetred'),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")
       


```

    

```{r echo = F, fig.height=7, fig.width= 7}

library(png)

temp = read.csv("/Users/johncsantiago/Documents/GitHub/Python/LarvalLocomotion/PreliminaryCode/20250703_ChATtrioWT.csv")
title = "7/3 ChAT->trio WT male"


max.frame = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))
max.frame = c(900,
              1500,
              max(temp$Frame[temp$ObjectID == 3]),
              max(temp$Frame[temp$ObjectID == 4]),
              max(temp$Frame[temp$ObjectID == 5]))


temp = temp[(temp$ObjectID == 1 & temp$Frame <= max.frame[1]) |
              (temp$ObjectID == 2 & temp$Frame <= max.frame[2]) |
              (temp$ObjectID == 3 & temp$Frame <= max.frame[3]) |
              (temp$ObjectID == 4 & temp$Frame <= max.frame[4]) |
              (temp$ObjectID == 5 & temp$Frame <= max.frame[5]),]

distance = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))

temp$Y = 1400 - temp$Y
temp$X = 1400 - temp$X

x = temp$Y
y = temp$X

temp$X = x
temp$Y = y

i=1
while(i<=length(unique(names(distance)))){
  j = 101
  while(j < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    distance[i] = distance[i] + sqrt((x2-x1)^2 + (y2-y1)^2)
    j=j+100
  }
  i=i+1
}



speed = distance/(max.frame/100)

trioWT3.dist = distance
trioWT3.speed = speed

#bgpic = readPNG("/Users/johncsantiago/Documents/GitHub/WhartonLab/Python/LarvalLocomotion/PreliminaryCode/trajectory_with_snapshots.png")

#temp$y = 720 - temp$y

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,1400), xlim = c(0,1400),
     xlab = "",
     ylab = "") #ylim = c(300,600), xlim = c(200,600))#

#rasterImage(bgpic, xleft = 0,
#            xright = 1080,
#            ybottom = 0,
#            ytop = 720)

lines(x = temp$X[temp$ObjectID ==1],
     y = temp$Y[temp$ObjectID ==1],
     lwd = 1,
     col = "darkorange")


lines(x = temp$X[temp$ObjectID ==2],
     y = temp$Y[temp$ObjectID ==2],
     lwd = 1,
     col = "firebrick")

lines(x = temp$X[temp$ObjectID ==3],
     y = temp$Y[temp$ObjectID ==3],
     lwd = 1,
     col = "royalblue")

lines(x = temp$X[temp$ObjectID ==4],
     y = temp$Y[temp$ObjectID ==4],
     lwd = 1,
     col = "darkgreen")

lines(x = temp$X[temp$ObjectID ==5],
     y = temp$Y[temp$ObjectID ==5],
     lwd = 1,
     col = "violetred")

legend(x = 1460,
       y = 1400,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4),
                  signif(speed[2],4),
                  signif(speed[3],4),
                  signif(speed[4],4),
                  signif(speed[5],4)), 
       fill = c("darkorange", "firebrick", "royalblue", 'darkgreen', 'violetred'),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")

```

```{r echo = F, fig.height=7, fig.width= 7}


frame.distance = data.frame(Rep = c(rep("1", ((floor(max.frame[1]/100)))),
                                 rep("2", ((floor(max.frame[2]/100)))),
                                 rep("3", ((floor(max.frame[3]/100)))),
                                 rep("4", ((floor(max.frame[4]/100)))),
                                 rep("5", ((floor(max.frame[5]/100))))),
                      frame = c(100*(1:floor(max.frame[1]/100)-1),
                                100*(1:floor(max.frame[2]/100)-1),
                                100*(1:floor(max.frame[3]/100)-1),
                                100*(1:floor(max.frame[4]/100)-1),
                                100*(1:floor(max.frame[5]/100)-1)),
                        distance = c(0))


i=1
while(i<=length(unique(names(distance)))){
  temp.distance = 0
  j = 200
  while(j-100 < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    temp.distance = temp.distance + sqrt((x2-x1)^2 + (y2-y1)^2)
    frame.distance[frame.distance$Rep == names(distance)[i] &
                     frame.distance$frame == j-100, "distance"]= temp.distance
    j=j+100
  }
  i=i+1
}

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,600), xlim = c(0,2700),
     xlab = "Frame",
     ylab = "Distance (px)")

lines(x = frame.distance$frame[frame.distance$Rep ==1],
     y = frame.distance$distance[frame.distance$Rep ==1],
     lwd = 1,
     col = "darkorange")


lines(x = frame.distance$frame[frame.distance$Rep ==2],
     y = frame.distance$distance[frame.distance$Rep ==2],
     lwd = 1,
     col = "firebrick")

lines(x = frame.distance$frame[frame.distance$Rep ==3],
     y = frame.distance$distance[frame.distance$Rep ==3],
     lwd = 1,
     col = "royalblue")

lines(x = frame.distance$frame[frame.distance$Rep ==4],
     y = frame.distance$distance[frame.distance$Rep ==4],
     lwd = 1,
     col = "darkgreen")

lines(x = frame.distance$frame[frame.distance$Rep ==5],
     y = frame.distance$distance[frame.distance$Rep ==5],
     lwd = 1,
     col = "violetred")

legend(x = 2800,
       y = 600,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4),
                  signif(speed[2],4),
                  signif(speed[3],4),
                  signif(speed[4],4),
                  signif(speed[5],4)), 
       fill = c("darkorange", "firebrick", "royalblue", 'darkgreen', 'violetred'),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")
       


```


```{r echo = F, fig.height=7, fig.width= 7}

library(png)

temp = read.csv("/Users/johncsantiago/Documents/GitHub/Python/LarvalLocomotion/PreliminaryCode/20250703_ChATtrioG85R.csv")
title = "7/3 ChAT->trio G85R male"


max.frame = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))
max.frame = c(max(temp$Frame[temp$ObjectID == 1]),
              max(temp$Frame[temp$ObjectID == 2]),
              max(temp$Frame[temp$ObjectID == 3]),
              max(temp$Frame[temp$ObjectID == 4]),
              max(temp$Frame[temp$ObjectID == 5]))


temp = temp[(temp$ObjectID == 1 & temp$Frame <= max.frame[1]) |
              (temp$ObjectID == 2 & temp$Frame <= max.frame[2]) |
              (temp$ObjectID == 3 & temp$Frame <= max.frame[3]) |
              (temp$ObjectID == 4 & temp$Frame <= max.frame[4]) |
              (temp$ObjectID == 5 & temp$Frame <= max.frame[5]),]

distance = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))

temp$Y = 1400 - temp$Y
temp$X = 1400 - temp$X

x = temp$Y
y = temp$X

temp$X = x
temp$Y = y

i=1
while(i<=length(unique(names(distance)))){
  j = 101
  while(j < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    distance[i] = distance[i] + sqrt((x2-x1)^2 + (y2-y1)^2)
    j=j+100
  }
  i=i+1
}



speed = distance/(max.frame/100)

trioG85R3.dist = distance
trioG85R3.speed = speed

#bgpic = readPNG("/Users/johncsantiago/Documents/GitHub/WhartonLab/Python/LarvalLocomotion/PreliminaryCode/trajectory_with_snapshots.png")

#temp$y = 720 - temp$y

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,1400), xlim = c(0,1400),
     xlab = "",
     ylab = "") #ylim = c(300,600), xlim = c(200,600))#

#rasterImage(bgpic, xleft = 0,
#            xright = 1080,
#            ybottom = 0,
#            ytop = 720)

lines(x = temp$X[temp$ObjectID ==1],
     y = temp$Y[temp$ObjectID ==1],
     lwd = 1,
     col = "darkorange")


lines(x = temp$X[temp$ObjectID ==2],
     y = temp$Y[temp$ObjectID ==2],
     lwd = 1,
     col = "firebrick")

lines(x = temp$X[temp$ObjectID ==3],
     y = temp$Y[temp$ObjectID ==3],
     lwd = 1,
     col = "royalblue")

lines(x = temp$X[temp$ObjectID ==4],
     y = temp$Y[temp$ObjectID ==4],
     lwd = 1,
     col = "darkgreen")

lines(x = temp$X[temp$ObjectID ==5],
     y = temp$Y[temp$ObjectID ==5],
     lwd = 1,
     col = "violetred")

legend(x = 1460,
       y = 1400,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4),
                  signif(speed[2],4),
                  signif(speed[3],4),
                  signif(speed[4],4),
                  signif(speed[5],4)), 
       fill = c("darkorange", "firebrick", "royalblue", 'darkgreen', 'violetred'),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")

```

```{r echo = F, fig.height=7, fig.width= 7}


frame.distance = data.frame(Rep = c(rep("1", ((floor(max.frame[1]/100)))),
                                 rep("2", ((floor(max.frame[2]/100)))),
                                 rep("3", ((floor(max.frame[3]/100)))),
                                 rep("4", ((floor(max.frame[4]/100)))),
                                 rep("5", ((floor(max.frame[5]/100))))),
                      frame = c(100*(1:floor(max.frame[1]/100)-1),
                                100*(1:floor(max.frame[2]/100)-1),
                                100*(1:floor(max.frame[3]/100)-1),
                                100*(1:floor(max.frame[4]/100)-1),
                                100*(1:floor(max.frame[5]/100)-1)),
                        distance = c(0))


i=1
while(i<=length(unique(names(distance)))){
  temp.distance = 0
  j = 200
  while(j-100 < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    temp.distance = temp.distance + sqrt((x2-x1)^2 + (y2-y1)^2)
    frame.distance[frame.distance$Rep == names(distance)[i] &
                     frame.distance$frame == j-100, "distance"]= temp.distance
    j=j+100
  }
  i=i+1
}

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,600), xlim = c(0,2700),
     xlab = "Frame",
     ylab = "Distance (px)")

lines(x = frame.distance$frame[frame.distance$Rep ==1],
     y = frame.distance$distance[frame.distance$Rep ==1],
     lwd = 1,
     col = "darkorange")


lines(x = frame.distance$frame[frame.distance$Rep ==2],
     y = frame.distance$distance[frame.distance$Rep ==2],
     lwd = 1,
     col = "firebrick")

lines(x = frame.distance$frame[frame.distance$Rep ==3],
     y = frame.distance$distance[frame.distance$Rep ==3],
     lwd = 1,
     col = "royalblue")

lines(x = frame.distance$frame[frame.distance$Rep ==4],
     y = frame.distance$distance[frame.distance$Rep ==4],
     lwd = 1,
     col = "darkgreen")

lines(x = frame.distance$frame[frame.distance$Rep ==5],
     y = frame.distance$distance[frame.distance$Rep ==5],
     lwd = 1,
     col = "violetred")

legend(x = 2800,
       y = 600,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4),
                  signif(speed[2],4),
                  signif(speed[3],4),
                  signif(speed[4],4),
                  signif(speed[5],4)), 
       fill = c("darkorange", "firebrick", "royalblue", 'darkgreen', 'violetred'),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")
       


```
    


```{r echo = F, fig.height=7, fig.width= 7}

library(png)

temp = read.csv("/Users/johncsantiago/Documents/GitHub/Python/LarvalLocomotion/PreliminaryCode/20250707_WT.csv")
title = "7/7 WT male"


max.frame = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))
max.frame = c(max(temp$Frame[temp$ObjectID == 1]),
              max(temp$Frame[temp$ObjectID == 2]),
              max(temp$Frame[temp$ObjectID == 3]))


temp = temp[(temp$ObjectID == 1 & temp$Frame <= max.frame[1]) |
              (temp$ObjectID == 2 & temp$Frame <= max.frame[2]) |
              (temp$ObjectID == 3 & temp$Frame <= max.frame[3]),]

distance = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))

temp$Y = 1400 - temp$Y
temp$X = 1400 - temp$X

x = temp$Y
y = temp$X

temp$X = x
temp$Y = y

i=1
while(i<=length(unique(names(distance)))){
  j = 101
  while(j < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    distance[i] = distance[i] + sqrt((x2-x1)^2 + (y2-y1)^2)
    j=j+100
  }
  i=i+1
}



speed = distance/(max.frame/100)

WT7.dist = distance
WT7.speed = speed

#bgpic = readPNG("/Users/johncsantiago/Documents/GitHub/WhartonLab/Python/LarvalLocomotion/PreliminaryCode/trajectory_with_snapshots.png")

#temp$y = 720 - temp$y

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,1400), xlim = c(0,1400),
     xlab = "",
     ylab = "") #ylim = c(300,600), xlim = c(200,600))#

#rasterImage(bgpic, xleft = 0,
#            xright = 1080,
#            ybottom = 0,
#            ytop = 720)

lines(x = temp$X[temp$ObjectID ==1],
     y = temp$Y[temp$ObjectID ==1],
     lwd = 1,
     col = "darkorange")


lines(x = temp$X[temp$ObjectID ==2],
     y = temp$Y[temp$ObjectID ==2],
     lwd = 1,
     col = "firebrick")

lines(x = temp$X[temp$ObjectID ==3],
     y = temp$Y[temp$ObjectID ==3],
     lwd = 1,
     col = "royalblue")


legend(x = 1460,
       y = 1400,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4),
                  signif(speed[2],4),
                  signif(speed[3],4)), 
       fill = c("darkorange", "firebrick", "royalblue"),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")

```

```{r echo = F, fig.height=7, fig.width= 7}


frame.distance = data.frame(Rep = c(rep("1", ((floor(max.frame[1]/100)))),
                                 rep("2", ((floor(max.frame[2]/100)))),
                                 rep("3", ((floor(max.frame[3]/100))))),
                      frame = c(100*(1:floor(max.frame[1]/100)-1),
                                100*(1:floor(max.frame[2]/100)-1),
                                100*(1:floor(max.frame[3]/100)-1)),
                        distance = c(0))


i=1
while(i<=length(unique(names(distance)))){
  temp.distance = 0
  j = 200
  while(j-100 < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    temp.distance = temp.distance + sqrt((x2-x1)^2 + (y2-y1)^2)
    frame.distance[frame.distance$Rep == names(distance)[i] &
                     frame.distance$frame == j-100, "distance"]= temp.distance
    j=j+100
  }
  i=i+1
}

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,600), xlim = c(0,2700),
     xlab = "Frame",
     ylab = "Distance (px)")

lines(x = frame.distance$frame[frame.distance$Rep ==1],
     y = frame.distance$distance[frame.distance$Rep ==1],
     lwd = 1,
     col = "darkorange")


lines(x = frame.distance$frame[frame.distance$Rep ==2],
     y = frame.distance$distance[frame.distance$Rep ==2],
     lwd = 1,
     col = "firebrick")

lines(x = frame.distance$frame[frame.distance$Rep ==3],
     y = frame.distance$distance[frame.distance$Rep ==3],
     lwd = 1,
     col = "royalblue")


legend(x = 2800,
       y = 600,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4),
                  signif(speed[2],4),
                  signif(speed[3],4)), 
       fill = c("darkorange", "firebrick", "royalblue"),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")
       


```



```{r echo = F, fig.height=7, fig.width= 7}

library(png)

temp = read.csv("/Users/johncsantiago/Documents/GitHub/Python/LarvalLocomotion/PreliminaryCode/20250707_G85R.csv")
title = "7/7 G85R male"


max.frame = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))
max.frame = c(max(temp$Frame[temp$ObjectID == 1]),
              2000)


temp = temp[(temp$ObjectID == 1 & temp$Frame <= max.frame[1]) |
              (temp$ObjectID == 2 & temp$Frame <= max.frame[2]),]

distance = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))

temp$Y = 1400 - temp$Y
temp$X = 1400 - temp$X

x = temp$Y
y = temp$X

temp$X = x
temp$Y = y

i=1
while(i<=length(unique(names(distance)))){
  j = 101
  while(j < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    distance[i] = distance[i] + sqrt((x2-x1)^2 + (y2-y1)^2)
    j=j+100
  }
  i=i+1
}



speed = distance/(max.frame/100)

G85R7.dist = distance
G85R7.speed = speed

#bgpic = readPNG("/Users/johncsantiago/Documents/GitHub/WhartonLab/Python/LarvalLocomotion/PreliminaryCode/trajectory_with_snapshots.png")

#temp$y = 720 - temp$y

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,1400), xlim = c(0,1400),
     xlab = "",
     ylab = "") #ylim = c(300,600), xlim = c(200,600))#

#rasterImage(bgpic, xleft = 0,
#            xright = 1080,
#            ybottom = 0,
#            ytop = 720)

lines(x = temp$X[temp$ObjectID ==1],
     y = temp$Y[temp$ObjectID ==1],
     lwd = 1,
     col = "darkorange")


lines(x = temp$X[temp$ObjectID ==2],
     y = temp$Y[temp$ObjectID ==2],
     lwd = 1,
     col = "firebrick")

legend(x = 1460,
       y = 1400,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4),
                  signif(speed[2],4)), 
       fill = c("darkorange", "firebrick"),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")

```

```{r echo = F, fig.height=7, fig.width= 7}


frame.distance = data.frame(Rep = c(rep("1", ((floor(max.frame[1]/100)))),
                                 rep("2", ((floor(max.frame[2]/100))))),
                      frame = c(100*(1:floor(max.frame[1]/100)-1),
                                100*(1:floor(max.frame[2]/100)-1)),
                        distance = c(0))


i=1
while(i<=length(unique(names(distance)))){
  temp.distance = 0
  j = 200
  while(j-100 < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    temp.distance = temp.distance + sqrt((x2-x1)^2 + (y2-y1)^2)
    frame.distance[frame.distance$Rep == names(distance)[i] &
                     frame.distance$frame == j-100, "distance"]= temp.distance
    j=j+100
  }
  i=i+1
}

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,600), xlim = c(0,2700),
     xlab = "Frame",
     ylab = "Distance (px)")

lines(x = frame.distance$frame[frame.distance$Rep ==1],
     y = frame.distance$distance[frame.distance$Rep ==1],
     lwd = 1,
     col = "darkorange")


lines(x = frame.distance$frame[frame.distance$Rep ==2],
     y = frame.distance$distance[frame.distance$Rep ==2],
     lwd = 1,
     col = "firebrick")

legend(x = 2800,
       y = 600,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4),
                  signif(speed[2],4)), 
       fill = c("darkorange", "firebrick"),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")
       


```


   
```{r echo = F, fig.height=7, fig.width= 7}

library(png)

temp = read.csv("/Users/johncsantiago/Documents/GitHub/Python/LarvalLocomotion/PreliminaryCode/20250707_ChATtrioWT.csv")
title = "7/7 ChAT->trio WT male"


max.frame = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))
max.frame = c(max(temp$Frame[temp$ObjectID == 1]),
              max(temp$Frame[temp$ObjectID == 2]),
              max(temp$Frame[temp$ObjectID == 3]))


temp = temp[(temp$ObjectID == 1 & temp$Frame <= max.frame[1]) |
              (temp$ObjectID == 2 & temp$Frame <= max.frame[2]) |
              (temp$ObjectID == 3 & temp$Frame <= max.frame[3]),]

distance = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))

temp$Y = 1400 - temp$Y
temp$X = 1400 - temp$X

x = temp$Y
y = temp$X

temp$X = x
temp$Y = y

i=1
while(i<=length(unique(names(distance)))){
  j = 101
  while(j < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    distance[i] = distance[i] + sqrt((x2-x1)^2 + (y2-y1)^2)
    j=j+100
  }
  i=i+1
}



speed = distance/(max.frame/100)

trioWT7.dist = distance
trioWT7.speed = speed

#bgpic = readPNG("/Users/johncsantiago/Documents/GitHub/WhartonLab/Python/LarvalLocomotion/PreliminaryCode/trajectory_with_snapshots.png")

#temp$y = 720 - temp$y

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,1400), xlim = c(0,1400),
     xlab = "",
     ylab = "") #ylim = c(300,600), xlim = c(200,600))#

#rasterImage(bgpic, xleft = 0,
#            xright = 1080,
#            ybottom = 0,
#            ytop = 720)

lines(x = temp$X[temp$ObjectID ==1],
     y = temp$Y[temp$ObjectID ==1],
     lwd = 1,
     col = "darkorange")


lines(x = temp$X[temp$ObjectID ==2],
     y = temp$Y[temp$ObjectID ==2],
     lwd = 1,
     col = "firebrick")

lines(x = temp$X[temp$ObjectID ==3],
     y = temp$Y[temp$ObjectID ==3],
     lwd = 1,
     col = "royalblue")

legend(x = 1460,
       y = 1400,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4),
                  signif(speed[2],4),
                  signif(speed[3],4)), 
       fill = c("darkorange", "firebrick", "royalblue"),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")

```

```{r echo = F, fig.height=7, fig.width= 7}


frame.distance = data.frame(Rep = c(rep("1", ((floor(max.frame[1]/100)))),
                                 rep("2", ((floor(max.frame[2]/100)))),
                                 rep("3", ((floor(max.frame[3]/100))))),
                      frame = c(100*(1:floor(max.frame[1]/100)-1),
                                100*(1:floor(max.frame[2]/100)-1),
                                100*(1:floor(max.frame[3]/100)-1)),
                        distance = c(0))


i=1
while(i<=length(unique(names(distance)))){
  temp.distance = 0
  j = 200
  while(j-100 < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    temp.distance = temp.distance + sqrt((x2-x1)^2 + (y2-y1)^2)
    frame.distance[frame.distance$Rep == names(distance)[i] &
                     frame.distance$frame == j-100, "distance"]= temp.distance
    j=j+100
  }
  i=i+1
}

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,600), xlim = c(0,2700),
     xlab = "Frame",
     ylab = "Distance (px)")

lines(x = frame.distance$frame[frame.distance$Rep ==1],
     y = frame.distance$distance[frame.distance$Rep ==1],
     lwd = 1,
     col = "darkorange")


lines(x = frame.distance$frame[frame.distance$Rep ==2],
     y = frame.distance$distance[frame.distance$Rep ==2],
     lwd = 1,
     col = "firebrick")

lines(x = frame.distance$frame[frame.distance$Rep ==3],
     y = frame.distance$distance[frame.distance$Rep ==3],
     lwd = 1,
     col = "royalblue")

legend(x = 2800,
       y = 600,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4),
                  signif(speed[2],4),
                  signif(speed[3],4)), 
       fill = c("darkorange", "firebrick", "royalblue"),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")
       


```


```{r echo = F, fig.height=7, fig.width= 7}

library(png)

temp = read.csv("/Users/johncsantiago/Documents/GitHub/Python/LarvalLocomotion/PreliminaryCode/20250707_ChATtrioG85R.csv")
title = "7/7 ChAT->trio G85R male"


max.frame = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))
max.frame = c(max(temp$Frame[temp$ObjectID == 1]),
              max(temp$Frame[temp$ObjectID == 2]),
              max(temp$Frame[temp$ObjectID == 3]))


temp = temp[(temp$ObjectID == 1 & temp$Frame <= max.frame[1]) |
              (temp$ObjectID == 2 & temp$Frame <= max.frame[2]) |
              (temp$ObjectID == 3 & temp$Frame <= max.frame[3]),]

distance = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))

temp$Y = 1400 - temp$Y
temp$X = 1400 - temp$X

x = temp$Y
y = temp$X

temp$X = x
temp$Y = y

i=1
while(i<=length(unique(names(distance)))){
  j = 101
  while(j < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    distance[i] = distance[i] + sqrt((x2-x1)^2 + (y2-y1)^2)
    j=j+100
  }
  i=i+1
}



speed = distance/(max.frame/100)

trioG85R7.dist = distance
trioG85R7.speed = speed

#bgpic = readPNG("/Users/johncsantiago/Documents/GitHub/WhartonLab/Python/LarvalLocomotion/PreliminaryCode/trajectory_with_snapshots.png")

#temp$y = 720 - temp$y

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,1400), xlim = c(0,1400),
     xlab = "",
     ylab = "") #ylim = c(300,600), xlim = c(200,600))#

#rasterImage(bgpic, xleft = 0,
#            xright = 1080,
#            ybottom = 0,
#            ytop = 720)

lines(x = temp$X[temp$ObjectID ==1],
     y = temp$Y[temp$ObjectID ==1],
     lwd = 1,
     col = "darkorange")


lines(x = temp$X[temp$ObjectID ==2],
     y = temp$Y[temp$ObjectID ==2],
     lwd = 1,
     col = "firebrick")

lines(x = temp$X[temp$ObjectID ==3],
     y = temp$Y[temp$ObjectID ==3],
     lwd = 1,
     col = "royalblue")

legend(x = 1460,
       y = 1400,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4),
                  signif(speed[2],4),
                  signif(speed[3],4)), 
       fill = c("darkorange", "firebrick", "royalblue"),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")

```

```{r echo = F, fig.height=7, fig.width= 7}


frame.distance = data.frame(Rep = c(rep("1", ((floor(max.frame[1]/100)))),
                                 rep("2", ((floor(max.frame[2]/100)))),
                                 rep("3", ((floor(max.frame[3]/100))))),
                      frame = c(100*(1:floor(max.frame[1]/100)-1),
                                100*(1:floor(max.frame[2]/100)-1),
                                100*(1:floor(max.frame[3]/100)-1)),
                        distance = c(0))


i=1
while(i<=length(unique(names(distance)))){
  temp.distance = 0
  j = 200
  while(j-100 < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    temp.distance = temp.distance + sqrt((x2-x1)^2 + (y2-y1)^2)
    frame.distance[frame.distance$Rep == names(distance)[i] &
                     frame.distance$frame == j-100, "distance"]= temp.distance
    j=j+100
  }
  i=i+1
}

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,600), xlim = c(0,2700),
     xlab = "Frame",
     ylab = "Distance (px)")

lines(x = frame.distance$frame[frame.distance$Rep ==1],
     y = frame.distance$distance[frame.distance$Rep ==1],
     lwd = 1,
     col = "darkorange")


lines(x = frame.distance$frame[frame.distance$Rep ==2],
     y = frame.distance$distance[frame.distance$Rep ==2],
     lwd = 1,
     col = "firebrick")

lines(x = frame.distance$frame[frame.distance$Rep ==3],
     y = frame.distance$distance[frame.distance$Rep ==3],
     lwd = 1,
     col = "royalblue")

legend(x = 2800,
       y = 600,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4),
                  signif(speed[2],4),
                  signif(speed[3],4)), 
       fill = c("darkorange", "firebrick", "royalblue"),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")
       


```

    
```{r echo = F, fig.height=7, fig.width= 7}

library(png)

temp = read.csv("/Users/johncsantiago/Documents/GitHub/Python/LarvalLocomotion/PreliminaryCode/20250708_WT.csv")
title = "7/8 WT male"


max.frame = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))
max.frame = c(max(temp$Frame[temp$ObjectID == 1]),
              1700,
              max(temp$Frame[temp$ObjectID == 3]),
              2300,
              max(temp$Frame[temp$ObjectID == 5]))


temp = temp[(temp$ObjectID == 1 & temp$Frame <= max.frame[1]) |
              (temp$ObjectID == 2 & temp$Frame <= max.frame[2]) |
              (temp$ObjectID == 3 & temp$Frame <= max.frame[3]) |
              (temp$ObjectID == 4 & temp$Frame <= max.frame[4]) |
              (temp$ObjectID == 5 & temp$Frame <= max.frame[5]),]

distance = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))

temp$Y = 1400 - temp$Y
temp$X = 1400 - temp$X

x = temp$Y
y = temp$X

temp$X = x
temp$Y = y

i=1
while(i<=length(unique(names(distance)))){
  j = 101
  while(j < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    distance[i] = distance[i] + sqrt((x2-x1)^2 + (y2-y1)^2)
    j=j+100
  }
  i=i+1
}



speed = distance/(max.frame/100)

WT8.dist = distance
WT8.speed = speed

#bgpic = readPNG("/Users/johncsantiago/Documents/GitHub/WhartonLab/Python/LarvalLocomotion/PreliminaryCode/trajectory_with_snapshots.png")

#temp$y = 720 - temp$y

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,1400), xlim = c(0,1400),
     xlab = "",
     ylab = "") #ylim = c(300,600), xlim = c(200,600))#

#rasterImage(bgpic, xleft = 0,
#            xright = 1080,
#            ybottom = 0,
#            ytop = 720)

lines(x = temp$X[temp$ObjectID ==1],
     y = temp$Y[temp$ObjectID ==1],
     lwd = 1,
     col = "darkorange")


lines(x = temp$X[temp$ObjectID ==2],
     y = temp$Y[temp$ObjectID ==2],
     lwd = 1,
     col = "firebrick")

lines(x = temp$X[temp$ObjectID ==3],
     y = temp$Y[temp$ObjectID ==3],
     lwd = 1,
     col = "royalblue")

lines(x = temp$X[temp$ObjectID ==4],
     y = temp$Y[temp$ObjectID ==4],
     lwd = 1,
     col = "darkgreen")

lines(x = temp$X[temp$ObjectID ==5],
     y = temp$Y[temp$ObjectID ==5],
     lwd = 1,
     col = "violetred")

legend(x = 1460,
       y = 1400,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4),
                  signif(speed[2],4),
                  signif(speed[3],4),
                  signif(speed[4],4),
                  signif(speed[5],4)), 
       fill = c("darkorange", "firebrick", "royalblue", 'darkgreen', 'violetred'),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")

```

```{r echo = F, fig.height=7, fig.width= 7}


frame.distance = data.frame(Rep = c(rep("1", ((floor(max.frame[1]/100)))),
                                 rep("2", ((floor(max.frame[2]/100)))),
                                 rep("3", ((floor(max.frame[3]/100)))),
                                 rep("4", ((floor(max.frame[4]/100)))),
                                 rep("5", ((floor(max.frame[5]/100))))),
                      frame = c(100*(1:floor(max.frame[1]/100)-1),
                                100*(1:floor(max.frame[2]/100)-1),
                                100*(1:floor(max.frame[3]/100)-1),
                                100*(1:floor(max.frame[4]/100)-1),
                                100*(1:floor(max.frame[5]/100)-1)),
                        distance = c(0))


i=1
while(i<=length(unique(names(distance)))){
  temp.distance = 0
  j = 200
  while(j-100 < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    temp.distance = temp.distance + sqrt((x2-x1)^2 + (y2-y1)^2)
    frame.distance[frame.distance$Rep == names(distance)[i] &
                     frame.distance$frame == j-100, "distance"]= temp.distance
    j=j+100
  }
  i=i+1
}

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,600), xlim = c(0,2700),
     xlab = "Frame",
     ylab = "Distance (px)")

lines(x = frame.distance$frame[frame.distance$Rep ==1],
     y = frame.distance$distance[frame.distance$Rep ==1],
     lwd = 1,
     col = "darkorange")


lines(x = frame.distance$frame[frame.distance$Rep ==2],
     y = frame.distance$distance[frame.distance$Rep ==2],
     lwd = 1,
     col = "firebrick")

lines(x = frame.distance$frame[frame.distance$Rep ==3],
     y = frame.distance$distance[frame.distance$Rep ==3],
     lwd = 1,
     col = "royalblue")

lines(x = frame.distance$frame[frame.distance$Rep ==4],
     y = frame.distance$distance[frame.distance$Rep ==4],
     lwd = 1,
     col = "darkgreen")

lines(x = frame.distance$frame[frame.distance$Rep ==5],
     y = frame.distance$distance[frame.distance$Rep ==5],
     lwd = 1,
     col = "violetred")

legend(x = 2800,
       y = 600,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4),
                  signif(speed[2],4),
                  signif(speed[3],4),
                  signif(speed[4],4),
                  signif(speed[5],4)), 
       fill = c("darkorange", "firebrick", "royalblue", 'darkgreen', 'violetred'),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")
       


```


    
```{r echo = F, fig.height=7, fig.width= 7}

library(png)

temp = read.csv("/Users/johncsantiago/Documents/GitHub/Python/LarvalLocomotion/PreliminaryCode/20250708_G85R.csv")
title = "7/8 G85R male"


max.frame = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))
max.frame = c(max(temp$Frame[temp$ObjectID == 1]),
              max(temp$Frame[temp$ObjectID == 2]))


temp = temp[(temp$ObjectID == 1 & temp$Frame <= max.frame[1]) |
              (temp$ObjectID == 2 & temp$Frame <= max.frame[2]),]

distance = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))

temp$Y = 1400 - temp$Y
temp$X = 1400 - temp$X

x = temp$Y
y = temp$X

temp$X = x
temp$Y = y

i=1
while(i<=length(unique(names(distance)))){
  j = 101
  while(j < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    distance[i] = distance[i] + sqrt((x2-x1)^2 + (y2-y1)^2)
    j=j+100
  }
  i=i+1
}



speed = distance/(max.frame/100)

G85R8.dist = distance
G85R8.speed = speed

#bgpic = readPNG("/Users/johncsantiago/Documents/GitHub/WhartonLab/Python/LarvalLocomotion/PreliminaryCode/trajectory_with_snapshots.png")

#temp$y = 720 - temp$y

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,1400), xlim = c(0,1400),
     xlab = "",
     ylab = "") #ylim = c(300,600), xlim = c(200,600))#

#rasterImage(bgpic, xleft = 0,
#            xright = 1080,
#            ybottom = 0,
#            ytop = 720)

lines(x = temp$X[temp$ObjectID ==1],
     y = temp$Y[temp$ObjectID ==1],
     lwd = 1,
     col = "darkorange")


lines(x = temp$X[temp$ObjectID ==2],
     y = temp$Y[temp$ObjectID ==2],
     lwd = 1,
     col = "firebrick")

legend(x = 1460,
       y = 1400,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4),
                  signif(speed[2],4)), 
       fill = c("darkorange", "firebrick"),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")

```

```{r echo = F, fig.height=7, fig.width= 7}


frame.distance = data.frame(Rep = c(rep("1", ((floor(max.frame[1]/100)))),
                                 rep("2", ((floor(max.frame[2]/100))))),
                      frame = c(100*(1:floor(max.frame[1]/100)-1),
                                100*(1:floor(max.frame[2]/100)-1)),
                        distance = c(0))


i=1
while(i<=length(unique(names(distance)))){
  temp.distance = 0
  j = 200
  while(j-100 < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    temp.distance = temp.distance + sqrt((x2-x1)^2 + (y2-y1)^2)
    frame.distance[frame.distance$Rep == names(distance)[i] &
                     frame.distance$frame == j-100, "distance"]= temp.distance
    j=j+100
  }
  i=i+1
}

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,600), xlim = c(0,2700),
     xlab = "Frame",
     ylab = "Distance (px)")

lines(x = frame.distance$frame[frame.distance$Rep ==1],
     y = frame.distance$distance[frame.distance$Rep ==1],
     lwd = 1,
     col = "darkorange")


lines(x = frame.distance$frame[frame.distance$Rep ==2],
     y = frame.distance$distance[frame.distance$Rep ==2],
     lwd = 1,
     col = "firebrick")

legend(x = 2800,
       y = 600,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4),
                  signif(speed[2],4)), 
       fill = c("darkorange", "firebrick"),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")
       


```

      
```{r echo = F, fig.height=7, fig.width= 7}

library(png)

temp = read.csv("/Users/johncsantiago/Documents/GitHub/Python/LarvalLocomotion/PreliminaryCode/20250708_ChATtrioWT.csv")
title = "7/8 ChAT->trio WT male"


max.frame = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))
max.frame = c(max(temp$Frame[temp$ObjectID == 1]),
              2200,
              max(temp$Frame[temp$ObjectID == 3]),
              max(temp$Frame[temp$ObjectID == 4]),
              max(temp$Frame[temp$ObjectID == 5]))


temp = temp[(temp$ObjectID == 1 & temp$Frame <= max.frame[1]) |
              (temp$ObjectID == 2 & temp$Frame <= max.frame[2]) |
              (temp$ObjectID == 3 & temp$Frame <= max.frame[3]) |
              (temp$ObjectID == 4 & temp$Frame <= max.frame[4]) |
              (temp$ObjectID == 5 & temp$Frame <= max.frame[5]),]

distance = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))

temp$Y = 1400 - temp$Y
temp$X = 1400 - temp$X

x = temp$Y
y = temp$X

temp$X = x
temp$Y = y

i=1
while(i<=length(unique(names(distance)))){
  j = 101
  while(j < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    distance[i] = distance[i] + sqrt((x2-x1)^2 + (y2-y1)^2)
    j=j+100
  }
  i=i+1
}



speed = distance/(max.frame/100)

trioWT8.dist = distance
trioWT8.speed = speed

#bgpic = readPNG("/Users/johncsantiago/Documents/GitHub/WhartonLab/Python/LarvalLocomotion/PreliminaryCode/trajectory_with_snapshots.png")

#temp$y = 720 - temp$y

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,1400), xlim = c(0,1400),
     xlab = "",
     ylab = "") #ylim = c(300,600), xlim = c(200,600))#

#rasterImage(bgpic, xleft = 0,
#            xright = 1080,
#            ybottom = 0,
#            ytop = 720)

lines(x = temp$X[temp$ObjectID ==1],
     y = temp$Y[temp$ObjectID ==1],
     lwd = 1,
     col = "darkorange")


lines(x = temp$X[temp$ObjectID ==2],
     y = temp$Y[temp$ObjectID ==2],
     lwd = 1,
     col = "firebrick")

lines(x = temp$X[temp$ObjectID ==3],
     y = temp$Y[temp$ObjectID ==3],
     lwd = 1,
     col = "royalblue")

lines(x = temp$X[temp$ObjectID ==4],
     y = temp$Y[temp$ObjectID ==4],
     lwd = 1,
     col = "darkgreen")

lines(x = temp$X[temp$ObjectID ==5],
     y = temp$Y[temp$ObjectID ==5],
     lwd = 1,
     col = "violetred")

legend(x = 1460,
       y = 1400,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4),
                  signif(speed[2],4),
                  signif(speed[3],4),
                  signif(speed[4],4),
                  signif(speed[5],4)), 
       fill = c("darkorange", "firebrick", "royalblue", 'darkgreen', 'violetred'),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")

```

```{r echo = F, fig.height=7, fig.width= 7}


frame.distance = data.frame(Rep = c(rep("1", ((floor(max.frame[1]/100)))),
                                 rep("2", ((floor(max.frame[2]/100)))),
                                 rep("3", ((floor(max.frame[3]/100)))),
                                 rep("4", ((floor(max.frame[4]/100)))),
                                 rep("5", ((floor(max.frame[5]/100))))),
                      frame = c(100*(1:floor(max.frame[1]/100)-1),
                                100*(1:floor(max.frame[2]/100)-1),
                                100*(1:floor(max.frame[3]/100)-1),
                                100*(1:floor(max.frame[4]/100)-1),
                                100*(1:floor(max.frame[5]/100)-1)),
                        distance = c(0))


i=1
while(i<=length(unique(names(distance)))){
  temp.distance = 0
  j = 200
  while(j-100 < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    temp.distance = temp.distance + sqrt((x2-x1)^2 + (y2-y1)^2)
    frame.distance[frame.distance$Rep == names(distance)[i] &
                     frame.distance$frame == j-100, "distance"]= temp.distance
    j=j+100
  }
  i=i+1
}

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,600), xlim = c(0,2700),
     xlab = "Frame",
     ylab = "Distance (px)")

lines(x = frame.distance$frame[frame.distance$Rep ==1],
     y = frame.distance$distance[frame.distance$Rep ==1],
     lwd = 1,
     col = "darkorange")


lines(x = frame.distance$frame[frame.distance$Rep ==2],
     y = frame.distance$distance[frame.distance$Rep ==2],
     lwd = 1,
     col = "firebrick")

lines(x = frame.distance$frame[frame.distance$Rep ==3],
     y = frame.distance$distance[frame.distance$Rep ==3],
     lwd = 1,
     col = "royalblue")

lines(x = frame.distance$frame[frame.distance$Rep ==4],
     y = frame.distance$distance[frame.distance$Rep ==4],
     lwd = 1,
     col = "darkgreen")

lines(x = frame.distance$frame[frame.distance$Rep ==5],
     y = frame.distance$distance[frame.distance$Rep ==5],
     lwd = 1,
     col = "violetred")

legend(x = 2800,
       y = 600,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4),
                  signif(speed[2],4),
                  signif(speed[3],4),
                  signif(speed[4],4),
                  signif(speed[5],4)), 
       fill = c("darkorange", "firebrick", "royalblue", 'darkgreen', 'violetred'),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")
       


```

    
```{r echo = F, fig.height=7, fig.width= 7}

library(png)

temp = read.csv("/Users/johncsantiago/Documents/GitHub/Python/LarvalLocomotion/PreliminaryCode/20250708_ChATtrioG85R.csv")
title = "7/8 ChAT->trio G85R male"


max.frame = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))
max.frame = c(max(temp$Frame[temp$ObjectID == 1]),
              max(temp$Frame[temp$ObjectID == 2]),
              max(temp$Frame[temp$ObjectID == 3]))


temp = temp[(temp$ObjectID == 1 & temp$Frame <= max.frame[1]) |
              (temp$ObjectID == 2 & temp$Frame <= max.frame[2]) |
              (temp$ObjectID == 3 & temp$Frame <= max.frame[3]),]

distance = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))

temp$Y = 1400 - temp$Y
temp$X = 1400 - temp$X

x = temp$Y
y = temp$X

temp$X = x
temp$Y = y

i=1
while(i<=length(unique(names(distance)))){
  j = 101
  while(j < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    distance[i] = distance[i] + sqrt((x2-x1)^2 + (y2-y1)^2)
    j=j+100
  }
  i=i+1
}



speed = distance/(max.frame/100)

trioG85R8.dist = distance
trioG85R8.speed = speed

#bgpic = readPNG("/Users/johncsantiago/Documents/GitHub/WhartonLab/Python/LarvalLocomotion/PreliminaryCode/trajectory_with_snapshots.png")

#temp$y = 720 - temp$y

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,1400), xlim = c(0,1400),
     xlab = "",
     ylab = "") #ylim = c(300,600), xlim = c(200,600))#

#rasterImage(bgpic, xleft = 0,
#            xright = 1080,
#            ybottom = 0,
#            ytop = 720)

lines(x = temp$X[temp$ObjectID ==1],
     y = temp$Y[temp$ObjectID ==1],
     lwd = 1,
     col = "darkorange")


lines(x = temp$X[temp$ObjectID ==2],
     y = temp$Y[temp$ObjectID ==2],
     lwd = 1,
     col = "firebrick")

lines(x = temp$X[temp$ObjectID ==3],
     y = temp$Y[temp$ObjectID ==3],
     lwd = 1,
     col = "royalblue")

legend(x = 1460,
       y = 1400,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4),
                  signif(speed[2],4),
                  signif(speed[3],4)), 
       fill = c("darkorange", "firebrick", "royalblue"),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")

```

```{r echo = F, fig.height=7, fig.width= 7}


frame.distance = data.frame(Rep = c(rep("1", ((floor(max.frame[1]/100)))),
                                 rep("2", ((floor(max.frame[2]/100)))),
                                 rep("3", ((floor(max.frame[3]/100))))),
                      frame = c(100*(1:floor(max.frame[1]/100)-1),
                                100*(1:floor(max.frame[2]/100)-1),
                                100*(1:floor(max.frame[3]/100)-1)),
                        distance = c(0))


i=1
while(i<=length(unique(names(distance)))){
  temp.distance = 0
  j = 200
  while(j-100 < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    temp.distance = temp.distance + sqrt((x2-x1)^2 + (y2-y1)^2)
    frame.distance[frame.distance$Rep == names(distance)[i] &
                     frame.distance$frame == j-100, "distance"]= temp.distance
    j=j+100
  }
  i=i+1
}

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,600), xlim = c(0,2700),
     xlab = "Frame",
     ylab = "Distance (px)")

lines(x = frame.distance$frame[frame.distance$Rep ==1],
     y = frame.distance$distance[frame.distance$Rep ==1],
     lwd = 1,
     col = "darkorange")


lines(x = frame.distance$frame[frame.distance$Rep ==2],
     y = frame.distance$distance[frame.distance$Rep ==2],
     lwd = 1,
     col = "firebrick")

lines(x = frame.distance$frame[frame.distance$Rep ==3],
     y = frame.distance$distance[frame.distance$Rep ==3],
     lwd = 1,
     col = "royalblue")

legend(x = 2800,
       y = 600,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4),
                  signif(speed[2],4),
                  signif(speed[3],4)), 
       fill = c("darkorange", "firebrick", "royalblue"),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")
       


```

    
```{r echo = F, fig.height=7, fig.width= 7}

library(png)

temp = read.csv("/Users/johncsantiago/Documents/GitHub/Python/LarvalLocomotion/PreliminaryCode/20250709_WT.csv")
title = "7/9 WT male"


max.frame = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))
max.frame = c(max(temp$Frame[temp$ObjectID == 1]),
              max(temp$Frame[temp$ObjectID == 2]),
              max(temp$Frame[temp$ObjectID == 3]),
              1900,
              max(temp$Frame[temp$ObjectID == 5]))


temp = temp[(temp$ObjectID == 1 & temp$Frame <= max.frame[1]) |
              (temp$ObjectID == 2 & temp$Frame <= max.frame[2]) |
              (temp$ObjectID == 3 & temp$Frame <= max.frame[3]) |
              (temp$ObjectID == 4 & temp$Frame <= max.frame[4]) |
              (temp$ObjectID == 5 & temp$Frame <= max.frame[5]),]

distance = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))

temp$Y = 1400 - temp$Y
temp$X = 1400 - temp$X

x = temp$Y
y = temp$X

temp$X = x
temp$Y = y

i=1
while(i<=length(unique(names(distance)))){
  j = 101
  while(j < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    distance[i] = distance[i] + sqrt((x2-x1)^2 + (y2-y1)^2)
    j=j+100
  }
  i=i+1
}



speed = distance/(max.frame/100)

WT9.dist = distance
WT9.speed = speed

#bgpic = readPNG("/Users/johncsantiago/Documents/GitHub/WhartonLab/Python/LarvalLocomotion/PreliminaryCode/trajectory_with_snapshots.png")

#temp$y = 720 - temp$y

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,1400), xlim = c(0,1400),
     xlab = "",
     ylab = "") #ylim = c(300,600), xlim = c(200,600))#

#rasterImage(bgpic, xleft = 0,
#            xright = 1080,
#            ybottom = 0,
#            ytop = 720)

lines(x = temp$X[temp$ObjectID ==1],
     y = temp$Y[temp$ObjectID ==1],
     lwd = 1,
     col = "darkorange")


lines(x = temp$X[temp$ObjectID ==2],
     y = temp$Y[temp$ObjectID ==2],
     lwd = 1,
     col = "firebrick")

lines(x = temp$X[temp$ObjectID ==3],
     y = temp$Y[temp$ObjectID ==3],
     lwd = 1,
     col = "royalblue")

lines(x = temp$X[temp$ObjectID ==4],
     y = temp$Y[temp$ObjectID ==4],
     lwd = 1,
     col = "darkgreen")

lines(x = temp$X[temp$ObjectID ==5],
     y = temp$Y[temp$ObjectID ==5],
     lwd = 1,
     col = "violetred")

legend(x = 1460,
       y = 1400,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4),
                  signif(speed[2],4),
                  signif(speed[3],4),
                  signif(speed[4],4),
                  signif(speed[5],4)), 
       fill = c("darkorange", "firebrick", "royalblue", 'darkgreen', 'violetred'),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")

```

```{r echo = F, fig.height=7, fig.width= 7}


frame.distance = data.frame(Rep = c(rep("1", ((floor(max.frame[1]/100)))),
                                 rep("2", ((floor(max.frame[2]/100)))),
                                 rep("3", ((floor(max.frame[3]/100)))),
                                 rep("4", ((floor(max.frame[4]/100)))),
                                 rep("5", ((floor(max.frame[5]/100))))),
                      frame = c(100*(1:floor(max.frame[1]/100)-1),
                                100*(1:floor(max.frame[2]/100)-1),
                                100*(1:floor(max.frame[3]/100)-1),
                                100*(1:floor(max.frame[4]/100)-1),
                                100*(1:floor(max.frame[5]/100)-1)),
                        distance = c(0))


i=1
while(i<=length(unique(names(distance)))){
  temp.distance = 0
  j = 200
  while(j-100 < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    temp.distance = temp.distance + sqrt((x2-x1)^2 + (y2-y1)^2)
    frame.distance[frame.distance$Rep == names(distance)[i] &
                     frame.distance$frame == j-100, "distance"]= temp.distance
    j=j+100
  }
  i=i+1
}

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,600), xlim = c(0,2700),
     xlab = "Frame",
     ylab = "Distance (px)")

lines(x = frame.distance$frame[frame.distance$Rep ==1],
     y = frame.distance$distance[frame.distance$Rep ==1],
     lwd = 1,
     col = "darkorange")


lines(x = frame.distance$frame[frame.distance$Rep ==2],
     y = frame.distance$distance[frame.distance$Rep ==2],
     lwd = 1,
     col = "firebrick")

lines(x = frame.distance$frame[frame.distance$Rep ==3],
     y = frame.distance$distance[frame.distance$Rep ==3],
     lwd = 1,
     col = "royalblue")

lines(x = frame.distance$frame[frame.distance$Rep ==4],
     y = frame.distance$distance[frame.distance$Rep ==4],
     lwd = 1,
     col = "darkgreen")

lines(x = frame.distance$frame[frame.distance$Rep ==5],
     y = frame.distance$distance[frame.distance$Rep ==5],
     lwd = 1,
     col = "violetred")

legend(x = 2800,
       y = 600,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4),
                  signif(speed[2],4),
                  signif(speed[3],4),
                  signif(speed[4],4),
                  signif(speed[5],4)), 
       fill = c("darkorange", "firebrick", "royalblue", 'darkgreen', 'violetred'),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")
       


```

    
```{r echo = F, fig.height=7, fig.width= 7}

library(png)

temp = read.csv("/Users/johncsantiago/Documents/GitHub/Python/LarvalLocomotion/PreliminaryCode/20250709_G85R.csv")
title = "7/9 G85R male"


max.frame = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))
max.frame = c(max(temp$Frame[temp$ObjectID == 1]))


temp = temp[(temp$ObjectID == 1 & temp$Frame <= max.frame[1]),]

distance = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))

temp$Y = 1400 - temp$Y
temp$X = 1400 - temp$X

x = temp$Y
y = temp$X

temp$X = x
temp$Y = y

i=1
while(i<=length(unique(names(distance)))){
  j = 101
  while(j < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    distance[i] = distance[i] + sqrt((x2-x1)^2 + (y2-y1)^2)
    j=j+100
  }
  i=i+1
}



speed = distance/(max.frame/100)

G85R9.dist = distance
G85R9.speed = speed

#bgpic = readPNG("/Users/johncsantiago/Documents/GitHub/WhartonLab/Python/LarvalLocomotion/PreliminaryCode/trajectory_with_snapshots.png")

#temp$y = 720 - temp$y

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,1400), xlim = c(0,1400),
     xlab = "",
     ylab = "") #ylim = c(300,600), xlim = c(200,600))#

#rasterImage(bgpic, xleft = 0,
#            xright = 1080,
#            ybottom = 0,
#            ytop = 720)

lines(x = temp$X[temp$ObjectID ==1],
     y = temp$Y[temp$ObjectID ==1],
     lwd = 1,
     col = "darkorange")

legend(x = 1460,
       y = 1400,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4)), 
       fill = c("darkorange"),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")

```

```{r echo = F, fig.height=7, fig.width= 7}


frame.distance = data.frame(Rep = c(rep("1", ((floor(max.frame[1]/100))))),
                      frame = c(100*(1:floor(max.frame[1]/100)-1)),
                        distance = c(0))


i=1
while(i<=length(unique(names(distance)))){
  temp.distance = 0
  j = 200
  while(j-100 < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    temp.distance = temp.distance + sqrt((x2-x1)^2 + (y2-y1)^2)
    frame.distance[frame.distance$Rep == names(distance)[i] &
                     frame.distance$frame == j-100, "distance"]= temp.distance
    j=j+100
  }
  i=i+1
}

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,600), xlim = c(0,2700),
     xlab = "Frame",
     ylab = "Distance (px)")

lines(x = frame.distance$frame[frame.distance$Rep ==1],
     y = frame.distance$distance[frame.distance$Rep ==1],
     lwd = 1,
     col = "darkorange")

legend(x = 2800,
       y = 600,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4)), 
       fill = c("darkorange"),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")
       


```

    
```{r echo = F, fig.height=7, fig.width= 7}

library(png)

temp = read.csv("/Users/johncsantiago/Documents/GitHub/Python/LarvalLocomotion/PreliminaryCode/20250709_ChATtrioWT.csv")
title = "7/9 ChAT->trio WT male"


max.frame = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))
max.frame = c(max(temp$Frame[temp$ObjectID == 1]),
              max(temp$Frame[temp$ObjectID == 2]),
              max(temp$Frame[temp$ObjectID == 3]),
              max(temp$Frame[temp$ObjectID == 4]),
              2300)


temp = temp[(temp$ObjectID == 1 & temp$Frame <= max.frame[1]) |
              (temp$ObjectID == 2 & temp$Frame <= max.frame[2]) |
              (temp$ObjectID == 3 & temp$Frame <= max.frame[3]) |
              (temp$ObjectID == 4 & temp$Frame <= max.frame[4]) |
              (temp$ObjectID == 5 & temp$Frame <= max.frame[5]),]

distance = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))

temp$Y = 1400 - temp$Y
temp$X = 1400 - temp$X

x = temp$Y
y = temp$X

temp$X = x
temp$Y = y

i=1
while(i<=length(unique(names(distance)))){
  j = 101
  while(j < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    distance[i] = distance[i] + sqrt((x2-x1)^2 + (y2-y1)^2)
    j=j+100
  }
  i=i+1
}



speed = distance/(max.frame/100)

trioWT9.dist = distance
trioWT9.speed = speed

#bgpic = readPNG("/Users/johncsantiago/Documents/GitHub/WhartonLab/Python/LarvalLocomotion/PreliminaryCode/trajectory_with_snapshots.png")

#temp$y = 720 - temp$y

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,1400), xlim = c(0,1400),
     xlab = "",
     ylab = "") #ylim = c(300,600), xlim = c(200,600))#

#rasterImage(bgpic, xleft = 0,
#            xright = 1080,
#            ybottom = 0,
#            ytop = 720)

lines(x = temp$X[temp$ObjectID ==1],
     y = temp$Y[temp$ObjectID ==1],
     lwd = 1,
     col = "darkorange")


lines(x = temp$X[temp$ObjectID ==2],
     y = temp$Y[temp$ObjectID ==2],
     lwd = 1,
     col = "firebrick")

lines(x = temp$X[temp$ObjectID ==3],
     y = temp$Y[temp$ObjectID ==3],
     lwd = 1,
     col = "royalblue")

lines(x = temp$X[temp$ObjectID ==4],
     y = temp$Y[temp$ObjectID ==4],
     lwd = 1,
     col = "darkgreen")

lines(x = temp$X[temp$ObjectID ==5],
     y = temp$Y[temp$ObjectID ==5],
     lwd = 1,
     col = "violetred")

legend(x = 1460,
       y = 1400,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4),
                  signif(speed[2],4),
                  signif(speed[3],4),
                  signif(speed[4],4),
                  signif(speed[5],4)), 
       fill = c("darkorange", "firebrick", "royalblue", 'darkgreen', 'violetred'),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")

```

```{r echo = F, fig.height=7, fig.width= 7}


frame.distance = data.frame(Rep = c(rep("1", ((floor(max.frame[1]/100)))),
                                 rep("2", ((floor(max.frame[2]/100)))),
                                 rep("3", ((floor(max.frame[3]/100)))),
                                 rep("4", ((floor(max.frame[4]/100)))),
                                 rep("5", ((floor(max.frame[5]/100))))),
                      frame = c(100*(1:floor(max.frame[1]/100)-1),
                                100*(1:floor(max.frame[2]/100)-1),
                                100*(1:floor(max.frame[3]/100)-1),
                                100*(1:floor(max.frame[4]/100)-1),
                                100*(1:floor(max.frame[5]/100)-1)),
                        distance = c(0))


i=1
while(i<=length(unique(names(distance)))){
  temp.distance = 0
  j = 200
  while(j-100 < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    temp.distance = temp.distance + sqrt((x2-x1)^2 + (y2-y1)^2)
    frame.distance[frame.distance$Rep == names(distance)[i] &
                     frame.distance$frame == j-100, "distance"]= temp.distance
    j=j+100
  }
  i=i+1
}

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,600), xlim = c(0,2700),
     xlab = "Frame",
     ylab = "Distance (px)")

lines(x = frame.distance$frame[frame.distance$Rep ==1],
     y = frame.distance$distance[frame.distance$Rep ==1],
     lwd = 1,
     col = "darkorange")


lines(x = frame.distance$frame[frame.distance$Rep ==2],
     y = frame.distance$distance[frame.distance$Rep ==2],
     lwd = 1,
     col = "firebrick")

lines(x = frame.distance$frame[frame.distance$Rep ==3],
     y = frame.distance$distance[frame.distance$Rep ==3],
     lwd = 1,
     col = "royalblue")

lines(x = frame.distance$frame[frame.distance$Rep ==4],
     y = frame.distance$distance[frame.distance$Rep ==4],
     lwd = 1,
     col = "darkgreen")

lines(x = frame.distance$frame[frame.distance$Rep ==5],
     y = frame.distance$distance[frame.distance$Rep ==5],
     lwd = 1,
     col = "violetred")

legend(x = 2800,
       y = 600,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4),
                  signif(speed[2],4),
                  signif(speed[3],4),
                  signif(speed[4],4),
                  signif(speed[5],4)), 
       fill = c("darkorange", "firebrick", "royalblue", 'darkgreen', 'violetred'),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")
       


```

   
    
    

    

    
```{r echo = F, fig.height=7, fig.width= 7}

library(png)

temp = read.csv("/Users/johncsantiago/Documents/GitHub/Python/LarvalLocomotion/PreliminaryCode/20250709_ChATtrioG85R.csv")
title = "7/9 ChAT->trio G85R male"


max.frame = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))
max.frame = c(max(temp$Frame[temp$ObjectID == 1]),
              max(temp$Frame[temp$ObjectID == 2]),
              max(temp$Frame[temp$ObjectID == 3]),
              max(temp$Frame[temp$ObjectID == 4]))


temp = temp[(temp$ObjectID == 1 & temp$Frame <= max.frame[1]) |
              (temp$ObjectID == 2 & temp$Frame <= max.frame[2]) |
              (temp$ObjectID == 3 & temp$Frame <= max.frame[3]) |
              (temp$ObjectID == 4 & temp$Frame <= max.frame[4]),]

distance = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))

temp$Y = 1400 - temp$Y
temp$X = 1400 - temp$X

x = temp$Y
y = temp$X

temp$X = x
temp$Y = y

i=1
while(i<=length(unique(names(distance)))){
  j = 101
  while(j < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    distance[i] = distance[i] + sqrt((x2-x1)^2 + (y2-y1)^2)
    j=j+100
  }
  i=i+1
}



speed = distance/(max.frame/100)

trioG85R9.dist = distance
trioG85R9.speed = speed

#bgpic = readPNG("/Users/johncsantiago/Documents/GitHub/WhartonLab/Python/LarvalLocomotion/PreliminaryCode/trajectory_with_snapshots.png")

#temp$y = 720 - temp$y

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,1400), xlim = c(0,1400),
     xlab = "",
     ylab = "") #ylim = c(300,600), xlim = c(200,600))#

#rasterImage(bgpic, xleft = 0,
#            xright = 1080,
#            ybottom = 0,
#            ytop = 720)

lines(x = temp$X[temp$ObjectID ==1],
     y = temp$Y[temp$ObjectID ==1],
     lwd = 1,
     col = "darkorange")


lines(x = temp$X[temp$ObjectID ==2],
     y = temp$Y[temp$ObjectID ==2],
     lwd = 1,
     col = "firebrick")

lines(x = temp$X[temp$ObjectID ==3],
     y = temp$Y[temp$ObjectID ==3],
     lwd = 1,
     col = "royalblue")

lines(x = temp$X[temp$ObjectID ==4],
     y = temp$Y[temp$ObjectID ==4],
     lwd = 1,
     col = "darkgreen")

legend(x = 1460,
       y = 1400,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4),
                  signif(speed[2],4),
                  signif(speed[3],4),
                  signif(speed[4],4)), 
       fill = c("darkorange", "firebrick", "royalblue", 'darkgreen'),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")

```

```{r echo = F, fig.height=7, fig.width= 7}


frame.distance = data.frame(Rep = c(rep("1", ((floor(max.frame[1]/100)))),
                                 rep("2", ((floor(max.frame[2]/100)))),
                                 rep("3", ((floor(max.frame[3]/100)))),
                                 rep("4", ((floor(max.frame[4]/100))))),
                      frame = c(100*(1:floor(max.frame[1]/100)-1),
                                100*(1:floor(max.frame[2]/100)-1),
                                100*(1:floor(max.frame[3]/100)-1),
                                100*(1:floor(max.frame[4]/100)-1)),
                        distance = c(0))


i=1
while(i<=length(unique(names(distance)))){
  temp.distance = 0
  j = 200
  while(j-100 < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    temp.distance = temp.distance + sqrt((x2-x1)^2 + (y2-y1)^2)
    frame.distance[frame.distance$Rep == names(distance)[i] &
                     frame.distance$frame == j-100, "distance"]= temp.distance
    j=j+100
  }
  i=i+1
}

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,600), xlim = c(0,2700),
     xlab = "Frame",
     ylab = "Distance (px)")

lines(x = frame.distance$frame[frame.distance$Rep ==1],
     y = frame.distance$distance[frame.distance$Rep ==1],
     lwd = 1,
     col = "darkorange")


lines(x = frame.distance$frame[frame.distance$Rep ==2],
     y = frame.distance$distance[frame.distance$Rep ==2],
     lwd = 1,
     col = "firebrick")

lines(x = frame.distance$frame[frame.distance$Rep ==3],
     y = frame.distance$distance[frame.distance$Rep ==3],
     lwd = 1,
     col = "royalblue")

lines(x = frame.distance$frame[frame.distance$Rep ==4],
     y = frame.distance$distance[frame.distance$Rep ==4],
     lwd = 1,
     col = "darkgreen")

legend(x = 2800,
       y = 600,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4),
                  signif(speed[2],4),
                  signif(speed[3],4),
                  signif(speed[4],4)), 
       fill = c("darkorange", "firebrick", "royalblue", 'darkgreen'),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")
       


```

    
```{r echo = F}
  
all.larvae = data.frame(Genotype = character(),
                        Day = numeric(),
                        Speed = numeric(),
                        Distance = numeric())

WT = data.frame(Genotype = rep("WT", length(WT2.dist) + length(WT3.dist) + length(WT7.dist) + length(WT8.dist) + length(WT9.dist)),
                Day = c(rep(2, length(WT2.dist)), rep(3, length(WT3.dist)), rep(7, length(WT7.dist)), rep(8, length(WT8.dist)), rep(9, length(WT9.dist))),
                Speed = c(WT2.speed, WT3.speed, WT7.speed, WT8.speed, WT9.speed),
                Distance = c(WT2.dist, WT3.dist, WT7.dist, WT8.dist, WT9.dist))

GR = data.frame(Genotype = rep("G85R", length(G85R2.dist) + length(G85R3.dist) + length(G85R7.dist) + length(G85R8.dist) + length(G85R9.dist)),
                Day = c(rep(2, length(G85R2.dist)), rep(3, length(G85R3.dist)), rep(7, length(G85R7.dist)), rep(8, length(G85R8.dist)), rep(9, length(G85R9.dist))),
                Speed = c(G85R2.speed, G85R3.speed, G85R7.speed, G85R8.speed, G85R9.speed),
                Distance = c(G85R2.dist, G85R3.dist, G85R7.dist, G85R8.dist, G85R9.dist))
 
trioWT = data.frame(Genotype = rep("trioWT", length(trioWT2.dist) + length(trioWT3.dist) + length(trioWT7.dist) + length(trioWT8.dist) + length(trioWT9.dist)),
                Day = c(rep(2, length(trioWT2.dist)), rep(3, length(trioWT3.dist)), rep(7, length(trioWT7.dist)), rep(8, length(trioWT8.dist)), rep(9, length(trioWT9.dist))),
                Speed = c(trioWT2.speed, trioWT3.speed, trioWT7.speed, trioWT8.speed, trioWT9.speed),
                Distance = c(trioWT2.dist, trioWT3.dist, trioWT7.dist, trioWT8.dist, trioWT9.dist))

trioGR = data.frame(Genotype = rep("trioG85R", length(trioG85R2.dist) + length(trioG85R3.dist) + length(trioG85R7.dist) + length(trioG85R8.dist) + length(trioG85R9.dist)),
                Day = c(rep(2, length(trioG85R2.dist)), rep(3, length(trioG85R3.dist)), rep(7, length(trioG85R7.dist)), rep(8, length(trioG85R8.dist)), rep(9, length(trioG85R9.dist))),
                Speed = c(trioG85R2.speed, trioG85R3.speed, trioG85R7.speed, trioG85R8.speed, trioG85R9.speed),
                Distance = c(trioG85R2.dist, trioG85R3.dist, trioG85R7.dist, trioG85R8.dist, trioG85R9.dist))
   
all.larvae = rbind(WT, rbind(GR, rbind(trioWT, trioGR)))

  
```
  

```{r echo = F}

std.colors = setNames(c('navy', "orange2", 
                        "darkgreen", "firebrick",
                        "turquoise3", "deeppink"),
                      c("WT(cr/LoxP)" , "G85R(cr/hr)",
                        "OK371-gbb; WT(cr/LoxP)", "OK371-gbb; G85R(cr/LoxP)",
                        "OK371-saxA; WT(cr/LoxP)", "OK371-saxA; G85R(cr/LoxP)"))


hex = function(color, alpha){
  rgb2hex = color
  i = 1
  while(i <= length(color)){
    rgbvals = col2rgb(color[i])
    rgb2hex[i] = rgb(rgbvals[1]/255, rgbvals[2]/255, rgbvals[3]/255, alpha)
    i = i+1
  }
  return(rgb2hex)
}

speed.means = data.frame(WT = mean(all.larvae$Speed[all.larvae$Genotype == "WT"]),
                         G85R = mean(all.larvae$Speed[all.larvae$Genotype == "G85R"]),
                         trioWT = mean(all.larvae$Speed[all.larvae$Genotype == "trioWT"]),
                         trioG85R = mean(all.larvae$Speed[all.larvae$Genotype == "trioG85R"]))


all.larvae$Genotype = factor(all.larvae$Genotype, levels = c("WT", "G85R", "trioWT", "trioG85R"))

par(mar=c(6.25, 4.1, 4.1, 5.6))

plot(x = c(.75,1.25),
     y = rep(speed.means[1], 2),
     type = 'l',
     lwd = 3,
     col = std.colors[1],
     ylim = c(0, max(speed.data$Speed)*1.1),
     xlim = c(.5, length(na.omit(speed.means))+.5),
     xaxt = "n",
     ylab="Larvae Speed (px/100 frames)",
     yaxt = "n",
     xlab = NA,
     frame = F,
     main = "Larval Locomotion")

lines(x = c(1.65,2.35),
     y = rep(speed.means[2], 2),
     type = 'l',
     lwd = 3,
     col = std.colors[2])

lines(x = c(2.65,3.35),
     y = rep(speed.means[3], 2),
     type = 'l',
     lwd = 3,
     col = std.colors[3])

lines(x = c(3.65,4.35),
     y = rep(speed.means[4], 2),
     type = 'l',
     lwd = 3,
     col = std.colors[4])

beeswarm(all.larvae$Speed~all.larvae$Genotype,
       pch = 21,
       method = "center",
       bg = hex(unique(std.colors[as.numeric(all.larvae$Genotype)]),.5),
       add = T)

axis(side = 1,
     at = c(1:4),
     labels = levels(all.larvae$Genotype),
     las = 1,
     lwd = 0,
     line = -.75)

lines(x = c(0.25, 4.5),
      y = c(0,0),
      lwd = 3,
      xpd = T)

  axis(side = 2,
       at = c(0,5,10,15,20,25,30),
       lwd = 2,
       line = 0,
       labels = F,
       xpd = T,
       las = 2)

  
  axis(side = 2,
       at = c(0,5,10,15,20,25,30),
       lwd = 3,
       line = 0,
       labels = T,
       xpd = T,
       las = 2)

```


```{r echo = F}


t.data = list("WT" = all.larvae$Speed[all.larvae$Genotype == "WT"],
              "G85R" = all.larvae$Speed[all.larvae$Genotype == "G85R"],
              "trioWT" = all.larvae$Speed[all.larvae$Genotype == "trioWT"],
              "trioG85R" = all.larvae$Speed[all.larvae$Genotype == "trioG85R"])

t.table = data.frame(Genotype1 = character(),
                     Genotype2 = character(),
                     pval = numeric())

i=1
while(i <= length(t.data)){
  j = i+1
  while(j <= length(t.data)){
    t.temp = data.frame(Genotype1 = names(t.data)[i],
                        Genotype2 = names(t.data)[j],
                        pval = t.test(x = t.data[[i]],
                                      y = t.data[[j]],
                                      paired = F)[[3]])
    t.table = rbind(t.table, t.temp)
      j = j+1
  }
  i = i+1
}


t.stripe = t.table$pval <= .05
knitr::kable(t.table,
             caption = 'All t-tests larval locomotion')  %>%
kable_styling() %>%
row_spec(c(1:nrow(t.table))[t.table$pval <= .05], bold = T, color = "black", background = "gold")

```



```{r echo = F, fig.height=7, fig.width= 7}


temp = read.csv("/Users/johncsantiago/Documents/GitHub/Python/LarvalLocomotion/PreliminaryCode/20250714_WT.csv")
title = "7/14 WT male"


max.frame = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))
max.frame = c(max(temp$Frame[temp$ObjectID == 1]),
              max(temp$Frame[temp$ObjectID == 2]),
              1900,
              max(temp$Frame[temp$ObjectID == 4]),
              max(temp$Frame[temp$ObjectID == 5]))


temp = temp[(temp$ObjectID == 1 & temp$Frame <= max.frame[1]) |
              (temp$ObjectID == 2 & temp$Frame <= max.frame[2]) |
              (temp$ObjectID == 3 & temp$Frame <= max.frame[3]) |
              (temp$ObjectID == 4 & temp$Frame <= max.frame[4]) |
              (temp$ObjectID == 5 & temp$Frame <= max.frame[5]),]

distance = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))

temp$Y = 1400 - temp$Y
temp$X = 1400 - temp$X

x = temp$Y
y = temp$X

temp$X = x
temp$Y = y

i=1
while(i<=length(unique(names(distance)))){
  j = 101
  while(j < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    distance[i] = distance[i] + sqrt((x2-x1)^2 + (y2-y1)^2)
    j=j+100
  }
  i=i+1
}



speed = distance/(max.frame/100)

WT14.dist = distance
WT14.speed = speed

#bgpic = readPNG("/Users/johncsantiago/Documents/GitHub/WhartonLab/Python/LarvalLocomotion/PreliminaryCode/trajectory_with_snapshots.png")

#temp$y = 720 - temp$y

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,1400), xlim = c(0,1400),
     xlab = "",
     ylab = "") #ylim = c(300,600), xlim = c(200,600))#

#rasterImage(bgpic, xleft = 0,
#            xright = 1080,
#            ybottom = 0,
#            ytop = 720)

lines(x = temp$X[temp$ObjectID ==1],
     y = temp$Y[temp$ObjectID ==1],
     lwd = 1,
     col = "darkorange")


lines(x = temp$X[temp$ObjectID ==2],
     y = temp$Y[temp$ObjectID ==2],
     lwd = 1,
     col = "firebrick")

lines(x = temp$X[temp$ObjectID ==3],
     y = temp$Y[temp$ObjectID ==3],
     lwd = 1,
     col = "royalblue")

lines(x = temp$X[temp$ObjectID ==4],
     y = temp$Y[temp$ObjectID ==4],
     lwd = 1,
     col = "darkgreen")

lines(x = temp$X[temp$ObjectID ==5],
     y = temp$Y[temp$ObjectID ==5],
     lwd = 1,
     col = "violetred")

legend(x = 1460,
       y = 1400,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4),
                  signif(speed[2],4),
                  signif(speed[3],4),
                  signif(speed[4],4),
                  signif(speed[5],4)), 
       fill = c("darkorange", "firebrick", "royalblue", 'darkgreen', 'violetred'),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")

```

```{r echo = F, fig.height=7, fig.width= 7}


frame.distance = data.frame(Rep = c(rep("1", ((floor(max.frame[1]/100)))),
                                 rep("2", ((floor(max.frame[2]/100)))),
                                 rep("3", ((floor(max.frame[3]/100)))),
                                 rep("4", ((floor(max.frame[4]/100)))),
                                 rep("5", ((floor(max.frame[5]/100))))),
                      frame = c(100*(1:floor(max.frame[1]/100)-1),
                                100*(1:floor(max.frame[2]/100)-1),
                                100*(1:floor(max.frame[3]/100)-1),
                                100*(1:floor(max.frame[4]/100)-1),
                                100*(1:floor(max.frame[5]/100)-1)),
                        distance = c(0))


i=1
while(i<=length(unique(names(distance)))){
  temp.distance = 0
  j = 200
  while(j-100 < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    temp.distance = temp.distance + sqrt((x2-x1)^2 + (y2-y1)^2)
    frame.distance[frame.distance$Rep == names(distance)[i] &
                     frame.distance$frame == j-100, "distance"]= temp.distance
    j=j+100
  }
  i=i+1
}

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,600), xlim = c(0,2700),
     xlab = "Frame",
     ylab = "Distance (px)")

lines(x = frame.distance$frame[frame.distance$Rep ==1],
     y = frame.distance$distance[frame.distance$Rep ==1],
     lwd = 1,
     col = "darkorange")


lines(x = frame.distance$frame[frame.distance$Rep ==2],
     y = frame.distance$distance[frame.distance$Rep ==2],
     lwd = 1,
     col = "firebrick")

lines(x = frame.distance$frame[frame.distance$Rep ==3],
     y = frame.distance$distance[frame.distance$Rep ==3],
     lwd = 1,
     col = "royalblue")

lines(x = frame.distance$frame[frame.distance$Rep ==4],
     y = frame.distance$distance[frame.distance$Rep ==4],
     lwd = 1,
     col = "darkgreen")

lines(x = frame.distance$frame[frame.distance$Rep ==5],
     y = frame.distance$distance[frame.distance$Rep ==5],
     lwd = 1,
     col = "violetred")

legend(x = 2800,
       y = 600,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4),
                  signif(speed[2],4),
                  signif(speed[3],4),
                  signif(speed[4],4),
                  signif(speed[5],4)), 
       fill = c("darkorange", "firebrick", "royalblue", 'darkgreen', 'violetred'),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")
       


```


```{r echo = F, fig.height=7, fig.width= 7}


temp = read.csv("/Users/johncsantiago/Documents/GitHub/Python/LarvalLocomotion/PreliminaryCode/20250714_G85R.csv")
title = "7/14 G85R male"


max.frame = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))
max.frame = c(2200,
              max(temp$Frame[temp$ObjectID == 2]),
              max(temp$Frame[temp$ObjectID == 3]),
              max(temp$Frame[temp$ObjectID == 4]),
              max(temp$Frame[temp$ObjectID == 5]))


temp = temp[(temp$ObjectID == 1 & temp$Frame <= max.frame[1]) |
              (temp$ObjectID == 2 & temp$Frame <= max.frame[2]) |
              (temp$ObjectID == 3 & temp$Frame <= max.frame[3]) |
              (temp$ObjectID == 4 & temp$Frame <= max.frame[4]) |
              (temp$ObjectID == 5 & temp$Frame <= max.frame[5]),]

distance = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))

temp$Y = 1400 - temp$Y
temp$X = 1400 - temp$X

x = temp$Y
y = temp$X

temp$X = x
temp$Y = y

i=1
while(i<=length(unique(names(distance)))){
  j = 101
  while(j < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    distance[i] = distance[i] + sqrt((x2-x1)^2 + (y2-y1)^2)
    j=j+100
  }
  i=i+1
}



speed = distance/(max.frame/100)

G85R14.dist = distance
G85R14.speed = speed

#bgpic = readPNG("/Users/johncsantiago/Documents/GitHub/WhartonLab/Python/LarvalLocomotion/PreliminaryCode/trajectory_with_snapshots.png")

#temp$y = 720 - temp$y

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,1400), xlim = c(0,1400),
     xlab = "",
     ylab = "") #ylim = c(300,600), xlim = c(200,600))#

#rasterImage(bgpic, xleft = 0,
#            xright = 1080,
#            ybottom = 0,
#            ytop = 720)

lines(x = temp$X[temp$ObjectID ==1],
     y = temp$Y[temp$ObjectID ==1],
     lwd = 1,
     col = "darkorange")


lines(x = temp$X[temp$ObjectID ==2],
     y = temp$Y[temp$ObjectID ==2],
     lwd = 1,
     col = "firebrick")

lines(x = temp$X[temp$ObjectID ==3],
     y = temp$Y[temp$ObjectID ==3],
     lwd = 1,
     col = "royalblue")

lines(x = temp$X[temp$ObjectID ==4],
     y = temp$Y[temp$ObjectID ==4],
     lwd = 1,
     col = "darkgreen")

lines(x = temp$X[temp$ObjectID ==5],
     y = temp$Y[temp$ObjectID ==5],
     lwd = 1,
     col = "violetred")

legend(x = 1460,
       y = 1400,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4),
                  signif(speed[2],4),
                  signif(speed[3],4),
                  signif(speed[4],4),
                  signif(speed[5],4)), 
       fill = c("darkorange", "firebrick", "royalblue", 'darkgreen', 'violetred'),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")

```

```{r echo = F, fig.height=7, fig.width= 7}


frame.distance = data.frame(Rep = c(rep("1", ((floor(max.frame[1]/100)))),
                                 rep("2", ((floor(max.frame[2]/100)))),
                                 rep("3", ((floor(max.frame[3]/100)))),
                                 rep("4", ((floor(max.frame[4]/100)))),
                                 rep("5", ((floor(max.frame[5]/100))))),
                      frame = c(100*(1:floor(max.frame[1]/100)-1),
                                100*(1:floor(max.frame[2]/100)-1),
                                100*(1:floor(max.frame[3]/100)-1),
                                100*(1:floor(max.frame[4]/100)-1),
                                100*(1:floor(max.frame[5]/100)-1)),
                        distance = c(0))


i=1
while(i<=length(unique(names(distance)))){
  temp.distance = 0
  j = 200
  while(j-100 < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    temp.distance = temp.distance + sqrt((x2-x1)^2 + (y2-y1)^2)
    frame.distance[frame.distance$Rep == names(distance)[i] &
                     frame.distance$frame == j-100, "distance"]= temp.distance
    j=j+100
  }
  i=i+1
}

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,600), xlim = c(0,2700),
     xlab = "Frame",
     ylab = "Distance (px)")

lines(x = frame.distance$frame[frame.distance$Rep ==1],
     y = frame.distance$distance[frame.distance$Rep ==1],
     lwd = 1,
     col = "darkorange")


lines(x = frame.distance$frame[frame.distance$Rep ==2],
     y = frame.distance$distance[frame.distance$Rep ==2],
     lwd = 1,
     col = "firebrick")

lines(x = frame.distance$frame[frame.distance$Rep ==3],
     y = frame.distance$distance[frame.distance$Rep ==3],
     lwd = 1,
     col = "royalblue")

lines(x = frame.distance$frame[frame.distance$Rep ==4],
     y = frame.distance$distance[frame.distance$Rep ==4],
     lwd = 1,
     col = "darkgreen")

lines(x = frame.distance$frame[frame.distance$Rep ==5],
     y = frame.distance$distance[frame.distance$Rep ==5],
     lwd = 1,
     col = "violetred")

legend(x = 2800,
       y = 600,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4),
                  signif(speed[2],4),
                  signif(speed[3],4),
                  signif(speed[4],4),
                  signif(speed[5],4)), 
       fill = c("darkorange", "firebrick", "royalblue", 'darkgreen', 'violetred'),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")
       


```



```{r echo = F, fig.height=7, fig.width= 7}


temp = read.csv("/Users/johncsantiago/Documents/GitHub/Python/LarvalLocomotion/PreliminaryCode/20250714_ChATtrioWT.csv")
title = "7/14 WT-trio male"


max.frame = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))
max.frame = c(max(temp$Frame[temp$ObjectID == 1]),
              max(temp$Frame[temp$ObjectID == 2]),
              max(temp$Frame[temp$ObjectID == 3]),
              max(temp$Frame[temp$ObjectID == 4]),
              max(temp$Frame[temp$ObjectID == 5]))


temp = temp[(temp$ObjectID == 1 & temp$Frame <= max.frame[1]) |
              (temp$ObjectID == 2 & temp$Frame <= max.frame[2]) |
              (temp$ObjectID == 3 & temp$Frame <= max.frame[3]) |
              (temp$ObjectID == 4 & temp$Frame <= max.frame[4]) |
              (temp$ObjectID == 5 & temp$Frame <= max.frame[5]),]

distance = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))

temp$Y = 1400 - temp$Y
temp$X = 1400 - temp$X

x = temp$Y
y = temp$X

temp$X = x
temp$Y = y

i=1
while(i<=length(unique(names(distance)))){
  j = 101
  while(j < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    distance[i] = distance[i] + sqrt((x2-x1)^2 + (y2-y1)^2)
    j=j+100
  }
  i=i+1
}



speed = distance/(max.frame/100)

trioWT14.dist = distance
trioWT14.speed = speed

#bgpic = readPNG("/Users/johncsantiago/Documents/GitHub/WhartonLab/Python/LarvalLocomotion/PreliminaryCode/trajectory_with_snapshots.png")

#temp$y = 720 - temp$y

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,1400), xlim = c(0,1400),
     xlab = "",
     ylab = "") #ylim = c(300,600), xlim = c(200,600))#

#rasterImage(bgpic, xleft = 0,
#            xright = 1080,
#            ybottom = 0,
#            ytop = 720)

lines(x = temp$X[temp$ObjectID ==1],
     y = temp$Y[temp$ObjectID ==1],
     lwd = 1,
     col = "darkorange")


lines(x = temp$X[temp$ObjectID ==2],
     y = temp$Y[temp$ObjectID ==2],
     lwd = 1,
     col = "firebrick")

lines(x = temp$X[temp$ObjectID ==3],
     y = temp$Y[temp$ObjectID ==3],
     lwd = 1,
     col = "royalblue")

lines(x = temp$X[temp$ObjectID ==4],
     y = temp$Y[temp$ObjectID ==4],
     lwd = 1,
     col = "darkgreen")

lines(x = temp$X[temp$ObjectID ==5],
     y = temp$Y[temp$ObjectID ==5],
     lwd = 1,
     col = "violetred")

legend(x = 1460,
       y = 1400,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4),
                  signif(speed[2],4),
                  signif(speed[3],4),
                  signif(speed[4],4),
                  signif(speed[5],4)), 
       fill = c("darkorange", "firebrick", "royalblue", 'darkgreen', 'violetred'),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")

```

```{r echo = F, fig.height=7, fig.width= 7}


frame.distance = data.frame(Rep = c(rep("1", ((floor(max.frame[1]/100)))),
                                 rep("2", ((floor(max.frame[2]/100)))),
                                 rep("3", ((floor(max.frame[3]/100)))),
                                 rep("4", ((floor(max.frame[4]/100)))),
                                 rep("5", ((floor(max.frame[5]/100))))),
                      frame = c(100*(1:floor(max.frame[1]/100)-1),
                                100*(1:floor(max.frame[2]/100)-1),
                                100*(1:floor(max.frame[3]/100)-1),
                                100*(1:floor(max.frame[4]/100)-1),
                                100*(1:floor(max.frame[5]/100)-1)),
                        distance = c(0))


i=1
while(i<=length(unique(names(distance)))){
  temp.distance = 0
  j = 200
  while(j-100 < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    temp.distance = temp.distance + sqrt((x2-x1)^2 + (y2-y1)^2)
    frame.distance[frame.distance$Rep == names(distance)[i] &
                     frame.distance$frame == j-100, "distance"]= temp.distance
    j=j+100
  }
  i=i+1
}

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,600), xlim = c(0,2700),
     xlab = "Frame",
     ylab = "Distance (px)")

lines(x = frame.distance$frame[frame.distance$Rep ==1],
     y = frame.distance$distance[frame.distance$Rep ==1],
     lwd = 1,
     col = "darkorange")


lines(x = frame.distance$frame[frame.distance$Rep ==2],
     y = frame.distance$distance[frame.distance$Rep ==2],
     lwd = 1,
     col = "firebrick")

lines(x = frame.distance$frame[frame.distance$Rep ==3],
     y = frame.distance$distance[frame.distance$Rep ==3],
     lwd = 1,
     col = "royalblue")

lines(x = frame.distance$frame[frame.distance$Rep ==4],
     y = frame.distance$distance[frame.distance$Rep ==4],
     lwd = 1,
     col = "darkgreen")

lines(x = frame.distance$frame[frame.distance$Rep ==5],
     y = frame.distance$distance[frame.distance$Rep ==5],
     lwd = 1,
     col = "violetred")

legend(x = 2800,
       y = 600,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4),
                  signif(speed[2],4),
                  signif(speed[3],4),
                  signif(speed[4],4),
                  signif(speed[5],4)), 
       fill = c("darkorange", "firebrick", "royalblue", 'darkgreen', 'violetred'),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")
       


```


```{r echo = F, fig.height=7, fig.width= 7}


temp = read.csv("/Users/johncsantiago/Documents/GitHub/Python/LarvalLocomotion/PreliminaryCode/20250714_ChATtrioG85R.csv")
title = "7/14 G85R-trio male"

temp = temp[temp$ObjectID != 2,]

max.frame = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))
max.frame = c(max(temp$Frame[temp$ObjectID == 1]),
              max(temp$Frame[temp$ObjectID == 3]),
              max(temp$Frame[temp$ObjectID == 4]),
              max(temp$Frame[temp$ObjectID == 5]))


temp = temp[(temp$ObjectID == 1 & temp$Frame <= max.frame[1]) |
              (temp$ObjectID == 3 & temp$Frame <= max.frame[2]) |
              (temp$ObjectID == 4 & temp$Frame <= max.frame[3]) |
              (temp$ObjectID == 5 & temp$Frame <= max.frame[4]),]

distance = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))

temp$Y = 1400 - temp$Y
temp$X = 1400 - temp$X

x = temp$Y
y = temp$X

temp$X = x
temp$Y = y

i=1
while(i<=length(unique(names(distance)))){
  j = 101
  while(j < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    distance[i] = distance[i] + sqrt((x2-x1)^2 + (y2-y1)^2)
    j=j+100
  }
  i=i+1
}



speed = distance/(max.frame/100)

trioG85R14.dist = distance
trioG85R14.speed = speed

#bgpic = readPNG("/Users/johncsantiago/Documents/GitHub/WhartonLab/Python/LarvalLocomotion/PreliminaryCode/trajectory_with_snapshots.png")

#temp$y = 720 - temp$y

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,1400), xlim = c(0,1400),
     xlab = "",
     ylab = "") #ylim = c(300,600), xlim = c(200,600))#

#rasterImage(bgpic, xleft = 0,
#            xright = 1080,
#            ybottom = 0,
#            ytop = 720)

lines(x = temp$X[temp$ObjectID ==1],
     y = temp$Y[temp$ObjectID ==1],
     lwd = 1,
     col = "darkorange")


lines(x = temp$X[temp$ObjectID ==3],
     y = temp$Y[temp$ObjectID ==3],
     lwd = 1,
     col = "royalblue")

lines(x = temp$X[temp$ObjectID ==4],
     y = temp$Y[temp$ObjectID ==4],
     lwd = 1,
     col = "darkgreen")

lines(x = temp$X[temp$ObjectID ==5],
     y = temp$Y[temp$ObjectID ==5],
     lwd = 1,
     col = "violetred")

legend(x = 1460,
       y = 1400,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4),
                  signif(speed[2],4),
                  signif(speed[3],4),
                  signif(speed[4],4),
                  signif(speed[5],4)), 
       fill = c("darkorange", "royalblue", 'darkgreen', 'violetred'),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")

```

```{r echo = F, fig.height=7, fig.width= 7}


frame.distance = data.frame(Rep = c(rep("1", ((floor(max.frame[1]/100)))),
                                 rep("3", ((floor(max.frame[2]/100)))),
                                 rep("4", ((floor(max.frame[3]/100)))),
                                 rep("5", ((floor(max.frame[4]/100))))),
                      frame = c(100*(1:floor(max.frame[1]/100)-1),
                                100*(1:floor(max.frame[2]/100)-1),
                                100*(1:floor(max.frame[3]/100)-1),
                                100*(1:floor(max.frame[4]/100)-1)),
                        distance = c(0))


i=1
while(i<=length(unique(names(distance)))){
  temp.distance = 0
  j = 200
  while(j-100 < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    temp.distance = temp.distance + sqrt((x2-x1)^2 + (y2-y1)^2)
    frame.distance[frame.distance$Rep == names(distance)[i] &
                     frame.distance$frame == j-100, "distance"]= temp.distance
    j=j+100
  }
  i=i+1
}

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,600), xlim = c(0,2700),
     xlab = "Frame",
     ylab = "Distance (px)")

lines(x = frame.distance$frame[frame.distance$Rep ==1],
     y = frame.distance$distance[frame.distance$Rep ==1],
     lwd = 1,
     col = "darkorange")

lines(x = frame.distance$frame[frame.distance$Rep ==3],
     y = frame.distance$distance[frame.distance$Rep ==3],
     lwd = 1,
     col = "royalblue")

lines(x = frame.distance$frame[frame.distance$Rep ==4],
     y = frame.distance$distance[frame.distance$Rep ==4],
     lwd = 1,
     col = "darkgreen")

lines(x = frame.distance$frame[frame.distance$Rep ==5],
     y = frame.distance$distance[frame.distance$Rep ==5],
     lwd = 1,
     col = "violetred")

legend(x = 2800,
       y = 600,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4),
                  signif(speed[2],4),
                  signif(speed[3],4),
                  signif(speed[4],4)), 
       fill = c("darkorange", "royalblue", 'darkgreen', 'violetred'),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")
       


```



```{r echo = F, fig.height=7, fig.width= 7}


temp = read.csv("/Users/johncsantiago/Documents/GitHub/Python/LarvalLocomotion/PreliminaryCode/20250710_WT.csv")
title = "7/10 WT male"


max.frame = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))
max.frame = c(1500,
              max(temp$Frame[temp$ObjectID == 2]),
              2500,
              max(temp$Frame[temp$ObjectID == 4]),
              1800)


temp = temp[(temp$ObjectID == 1 & temp$Frame <= max.frame[1]) |
              (temp$ObjectID == 2 & temp$Frame <= max.frame[2]) |
              (temp$ObjectID == 3 & temp$Frame <= max.frame[3]) |
              (temp$ObjectID == 4 & temp$Frame <= max.frame[4]) |
              (temp$ObjectID == 5 & temp$Frame <= max.frame[5]),]

distance = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))

temp$Y = 1400 - temp$Y
temp$X = 1400 - temp$X

x = temp$Y
y = temp$X

temp$X = x
temp$Y = y

i=1
while(i<=length(unique(names(distance)))){
  j = 101
  while(j < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    distance[i] = distance[i] + sqrt((x2-x1)^2 + (y2-y1)^2)
    j=j+100
  }
  i=i+1
}



speed = distance/(max.frame/100)

WT10.dist = distance
WT10.speed = speed

#bgpic = readPNG("/Users/johncsantiago/Documents/GitHub/WhartonLab/Python/LarvalLocomotion/PreliminaryCode/trajectory_with_snapshots.png")

#temp$y = 720 - temp$y

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,1400), xlim = c(0,1400),
     xlab = "",
     ylab = "") #ylim = c(300,600), xlim = c(200,600))#

#rasterImage(bgpic, xleft = 0,
#            xright = 1080,
#            ybottom = 0,
#            ytop = 720)

lines(x = temp$X[temp$ObjectID ==1],
     y = temp$Y[temp$ObjectID ==1],
     lwd = 1,
     col = "darkorange")


lines(x = temp$X[temp$ObjectID ==2],
     y = temp$Y[temp$ObjectID ==2],
     lwd = 1,
     col = "firebrick")

lines(x = temp$X[temp$ObjectID ==3],
     y = temp$Y[temp$ObjectID ==3],
     lwd = 1,
     col = "royalblue")

lines(x = temp$X[temp$ObjectID ==4],
     y = temp$Y[temp$ObjectID ==4],
     lwd = 1,
     col = "darkgreen")

lines(x = temp$X[temp$ObjectID ==5],
     y = temp$Y[temp$ObjectID ==5],
     lwd = 1,
     col = "violetred")

legend(x = 1460,
       y = 1400,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4),
                  signif(speed[2],4),
                  signif(speed[3],4),
                  signif(speed[4],4),
                  signif(speed[5],4)), 
       fill = c("darkorange", "firebrick", "royalblue", 'darkgreen', 'violetred'),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")

```

```{r echo = F, fig.height=7, fig.width= 7}


frame.distance = data.frame(Rep = c(rep("1", ((floor(max.frame[1]/100)))),
                                 rep("2", ((floor(max.frame[2]/100)))),
                                 rep("3", ((floor(max.frame[3]/100)))),
                                 rep("4", ((floor(max.frame[4]/100)))),
                                 rep("5", ((floor(max.frame[5]/100))))),
                      frame = c(100*(1:floor(max.frame[1]/100)-1),
                                100*(1:floor(max.frame[2]/100)-1),
                                100*(1:floor(max.frame[3]/100)-1),
                                100*(1:floor(max.frame[4]/100)-1),
                                100*(1:floor(max.frame[5]/100)-1)),
                        distance = c(0))


i=1
while(i<=length(unique(names(distance)))){
  temp.distance = 0
  j = 200
  while(j-100 < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    temp.distance = temp.distance + sqrt((x2-x1)^2 + (y2-y1)^2)
    frame.distance[frame.distance$Rep == names(distance)[i] &
                     frame.distance$frame == j-100, "distance"]= temp.distance
    j=j+100
  }
  i=i+1
}

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,600), xlim = c(0,2700),
     xlab = "Frame",
     ylab = "Distance (px)")

lines(x = frame.distance$frame[frame.distance$Rep ==1],
     y = frame.distance$distance[frame.distance$Rep ==1],
     lwd = 1,
     col = "darkorange")


lines(x = frame.distance$frame[frame.distance$Rep ==2],
     y = frame.distance$distance[frame.distance$Rep ==2],
     lwd = 1,
     col = "firebrick")

lines(x = frame.distance$frame[frame.distance$Rep ==3],
     y = frame.distance$distance[frame.distance$Rep ==3],
     lwd = 1,
     col = "royalblue")

lines(x = frame.distance$frame[frame.distance$Rep ==4],
     y = frame.distance$distance[frame.distance$Rep ==4],
     lwd = 1,
     col = "darkgreen")

lines(x = frame.distance$frame[frame.distance$Rep ==5],
     y = frame.distance$distance[frame.distance$Rep ==5],
     lwd = 1,
     col = "violetred")

legend(x = 2800,
       y = 600,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4),
                  signif(speed[2],4),
                  signif(speed[3],4),
                  signif(speed[4],4),
                  signif(speed[5],4)), 
       fill = c("darkorange", "firebrick", "royalblue", 'darkgreen', 'violetred'),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")
       


```


```{r echo = F, fig.height=7, fig.width= 7}


temp = read.csv("/Users/johncsantiago/Documents/GitHub/Python/LarvalLocomotion/PreliminaryCode/20250710_G85R.csv")
title = "7/10 G85R male"

temp = temp[temp$ObjectID != 2, ]
temp = temp[temp$ObjectID != 5, ]
max.frame = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))
max.frame = c(max(temp$Frame[temp$ObjectID == 1]),
              max(temp$Frame[temp$ObjectID == 3]),
              max(temp$Frame[temp$ObjectID == 4]))


temp = temp[(temp$ObjectID == 1 & temp$Frame <= max.frame[1]) |
              (temp$ObjectID == 3 & temp$Frame <= max.frame[2]) |
              (temp$ObjectID == 4 & temp$Frame <= max.frame[3]),]

distance = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))

temp$Y = 1400 - temp$Y
temp$X = 1400 - temp$X

x = temp$Y
y = temp$X

temp$X = x
temp$Y = y

i=1
while(i<=length(unique(names(distance)))){
  j = 101
  while(j < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    distance[i] = distance[i] + sqrt((x2-x1)^2 + (y2-y1)^2)
    j=j+100
  }
  i=i+1
}



speed = distance/(max.frame/100)

G85R10.dist = distance
G85R10.speed = speed

#bgpic = readPNG("/Users/johncsantiago/Documents/GitHub/WhartonLab/Python/LarvalLocomotion/PreliminaryCode/trajectory_with_snapshots.png")

#temp$y = 720 - temp$y

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,1400), xlim = c(0,1400),
     xlab = "",
     ylab = "") #ylim = c(300,600), xlim = c(200,600))#

#rasterImage(bgpic, xleft = 0,
#            xright = 1080,
#            ybottom = 0,
#            ytop = 720)

lines(x = temp$X[temp$ObjectID ==1],
     y = temp$Y[temp$ObjectID ==1],
     lwd = 1,
     col = "darkorange")

lines(x = temp$X[temp$ObjectID ==3],
     y = temp$Y[temp$ObjectID ==3],
     lwd = 1,
     col = "royalblue")

lines(x = temp$X[temp$ObjectID ==4],
     y = temp$Y[temp$ObjectID ==4],
     lwd = 1,
     col = "darkgreen")

legend(x = 1460,
       y = 1400,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4),
                  signif(speed[2],4),
                  signif(speed[3],4)), 
       fill = c("darkorange", "royalblue", 'darkgreen'),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")

```

```{r echo = F, fig.height=7, fig.width= 7}


frame.distance = data.frame(Rep = c(rep("1", ((floor(max.frame[1]/100)))),
                                 rep("3", ((floor(max.frame[2]/100)))),
                                 rep("4", ((floor(max.frame[3]/100))))),
                      frame = c(100*(1:floor(max.frame[1]/100)-1),
                                100*(1:floor(max.frame[2]/100)-1),
                                100*(1:floor(max.frame[3]/100)-1)),
                        distance = c(0))


i=1
while(i<=length(unique(names(distance)))){
  temp.distance = 0
  j = 200
  while(j-100 < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    temp.distance = temp.distance + sqrt((x2-x1)^2 + (y2-y1)^2)
    frame.distance[frame.distance$Rep == names(distance)[i] &
                     frame.distance$frame == j-100, "distance"]= temp.distance
    j=j+100
  }
  i=i+1
}

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,600), xlim = c(0,2700),
     xlab = "Frame",
     ylab = "Distance (px)")

lines(x = frame.distance$frame[frame.distance$Rep ==1],
     y = frame.distance$distance[frame.distance$Rep ==1],
     lwd = 1,
     col = "darkorange")

lines(x = frame.distance$frame[frame.distance$Rep ==3],
     y = frame.distance$distance[frame.distance$Rep ==3],
     lwd = 1,
     col = "royalblue")

lines(x = frame.distance$frame[frame.distance$Rep ==4],
     y = frame.distance$distance[frame.distance$Rep ==4],
     lwd = 1,
     col = "darkgreen")

legend(x = 2800,
       y = 600,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4),
                  signif(speed[2],4),
                  signif(speed[3],4)), 
       fill = c("darkorange", "royalblue", 'darkgreen'),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")
       


```



```{r echo = F, fig.height=7, fig.width= 7}


temp = read.csv("/Users/johncsantiago/Documents/GitHub/Python/LarvalLocomotion/PreliminaryCode/20250710_ChATtrioWT.csv")
title = "7/10 WT-trio male"


max.frame = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))
max.frame = c(max(temp$Frame[temp$ObjectID == 1]),
              max(temp$Frame[temp$ObjectID == 2]),
              max(temp$Frame[temp$ObjectID == 3]),
              max(temp$Frame[temp$ObjectID == 4]),
              max(temp$Frame[temp$ObjectID == 5]))


temp = temp[(temp$ObjectID == 1 & temp$Frame <= max.frame[1]) |
              (temp$ObjectID == 2 & temp$Frame <= max.frame[2]) |
              (temp$ObjectID == 3 & temp$Frame <= max.frame[3]) |
              (temp$ObjectID == 4 & temp$Frame <= max.frame[4]) |
              (temp$ObjectID == 5 & temp$Frame <= max.frame[5]),]

distance = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))

temp$Y = 1400 - temp$Y
temp$X = 1400 - temp$X

x = temp$Y
y = temp$X

temp$X = x
temp$Y = y

i=1
while(i<=length(unique(names(distance)))){
  j = 101
  while(j < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    distance[i] = distance[i] + sqrt((x2-x1)^2 + (y2-y1)^2)
    j=j+100
  }
  i=i+1
}



speed = distance/(max.frame/100)

trioWT10.dist = distance
trioWT10.speed = speed

#bgpic = readPNG("/Users/johncsantiago/Documents/GitHub/WhartonLab/Python/LarvalLocomotion/PreliminaryCode/trajectory_with_snapshots.png")

#temp$y = 720 - temp$y

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,1400), xlim = c(0,1400),
     xlab = "",
     ylab = "") #ylim = c(300,600), xlim = c(200,600))#

#rasterImage(bgpic, xleft = 0,
#            xright = 1080,
#            ybottom = 0,
#            ytop = 720)

lines(x = temp$X[temp$ObjectID ==1],
     y = temp$Y[temp$ObjectID ==1],
     lwd = 1,
     col = "darkorange")


lines(x = temp$X[temp$ObjectID ==2],
     y = temp$Y[temp$ObjectID ==2],
     lwd = 1,
     col = "firebrick")

lines(x = temp$X[temp$ObjectID ==3],
     y = temp$Y[temp$ObjectID ==3],
     lwd = 1,
     col = "royalblue")

lines(x = temp$X[temp$ObjectID ==4],
     y = temp$Y[temp$ObjectID ==4],
     lwd = 1,
     col = "darkgreen")

lines(x = temp$X[temp$ObjectID ==5],
     y = temp$Y[temp$ObjectID ==5],
     lwd = 1,
     col = "violetred")

legend(x = 1460,
       y = 1400,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4),
                  signif(speed[2],4),
                  signif(speed[3],4),
                  signif(speed[4],4),
                  signif(speed[5],4)), 
       fill = c("darkorange", "firebrick", "royalblue", 'darkgreen', 'violetred'),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")

```

```{r echo = F, fig.height=7, fig.width= 7}


frame.distance = data.frame(Rep = c(rep("1", ((floor(max.frame[1]/100)))),
                                 rep("2", ((floor(max.frame[2]/100)))),
                                 rep("3", ((floor(max.frame[3]/100)))),
                                 rep("4", ((floor(max.frame[4]/100)))),
                                 rep("5", ((floor(max.frame[5]/100))))),
                      frame = c(100*(1:floor(max.frame[1]/100)-1),
                                100*(1:floor(max.frame[2]/100)-1),
                                100*(1:floor(max.frame[3]/100)-1),
                                100*(1:floor(max.frame[4]/100)-1),
                                100*(1:floor(max.frame[5]/100)-1)),
                        distance = c(0))


i=1
while(i<=length(unique(names(distance)))){
  temp.distance = 0
  j = 200
  while(j-100 < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    temp.distance = temp.distance + sqrt((x2-x1)^2 + (y2-y1)^2)
    frame.distance[frame.distance$Rep == names(distance)[i] &
                     frame.distance$frame == j-100, "distance"]= temp.distance
    j=j+100
  }
  i=i+1
}

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,600), xlim = c(0,2700),
     xlab = "Frame",
     ylab = "Distance (px)")

lines(x = frame.distance$frame[frame.distance$Rep ==1],
     y = frame.distance$distance[frame.distance$Rep ==1],
     lwd = 1,
     col = "darkorange")


lines(x = frame.distance$frame[frame.distance$Rep ==2],
     y = frame.distance$distance[frame.distance$Rep ==2],
     lwd = 1,
     col = "firebrick")

lines(x = frame.distance$frame[frame.distance$Rep ==3],
     y = frame.distance$distance[frame.distance$Rep ==3],
     lwd = 1,
     col = "royalblue")

lines(x = frame.distance$frame[frame.distance$Rep ==4],
     y = frame.distance$distance[frame.distance$Rep ==4],
     lwd = 1,
     col = "darkgreen")

lines(x = frame.distance$frame[frame.distance$Rep ==5],
     y = frame.distance$distance[frame.distance$Rep ==5],
     lwd = 1,
     col = "violetred")

legend(x = 2800,
       y = 600,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4),
                  signif(speed[2],4),
                  signif(speed[3],4),
                  signif(speed[4],4),
                  signif(speed[5],4)), 
       fill = c("darkorange", "firebrick", "royalblue", 'darkgreen', 'violetred'),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")
       


```


```{r echo = F, fig.height=7, fig.width= 7}


temp = read.csv("/Users/johncsantiago/Documents/GitHub/Python/LarvalLocomotion/PreliminaryCode/20250710_ChATtrioG85R.csv")
title = "7/10 G85R-trio male"


max.frame = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))
max.frame = c(max(temp$Frame[temp$ObjectID == 1]),
              max(temp$Frame[temp$ObjectID == 2]),
              2100,
              max(temp$Frame[temp$ObjectID == 4]),
              max(temp$Frame[temp$ObjectID == 5]))


temp = temp[(temp$ObjectID == 1 & temp$Frame <= max.frame[1]) |
              (temp$ObjectID == 2 & temp$Frame <= max.frame[2]) |
              (temp$ObjectID == 3 & temp$Frame <= max.frame[3]) |
              (temp$ObjectID == 4 & temp$Frame <= max.frame[4]) |
              (temp$ObjectID == 5 & temp$Frame <= max.frame[4]),]

distance = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))

temp$Y = 1400 - temp$Y
temp$X = 1400 - temp$X

x = temp$Y
y = temp$X

temp$X = x
temp$Y = y

i=1
while(i<=length(unique(names(distance)))){
  j = 101
  while(j < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    distance[i] = distance[i] + sqrt((x2-x1)^2 + (y2-y1)^2)
    j=j+100
  }
  i=i+1
}



speed = distance/(max.frame/100)

trioG85R10.dist = distance
trioG85R10.speed = speed

#bgpic = readPNG("/Users/johncsantiago/Documents/GitHub/WhartonLab/Python/LarvalLocomotion/PreliminaryCode/trajectory_with_snapshots.png")

#temp$y = 720 - temp$y

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,1400), xlim = c(0,1400),
     xlab = "",
     ylab = "") #ylim = c(300,600), xlim = c(200,600))#

#rasterImage(bgpic, xleft = 0,
#            xright = 1080,
#            ybottom = 0,
#            ytop = 720)

lines(x = temp$X[temp$ObjectID ==1],
     y = temp$Y[temp$ObjectID ==1],
     lwd = 1,
     col = "darkorange")


lines(x = temp$X[temp$ObjectID ==2],
     y = temp$Y[temp$ObjectID ==2],
     lwd = 1,
     col = "firebrick")


lines(x = temp$X[temp$ObjectID ==3],
     y = temp$Y[temp$ObjectID ==3],
     lwd = 1,
     col = "royalblue")

lines(x = temp$X[temp$ObjectID ==4],
     y = temp$Y[temp$ObjectID ==4],
     lwd = 1,
     col = "darkgreen")

lines(x = temp$X[temp$ObjectID ==5],
     y = temp$Y[temp$ObjectID ==5],
     lwd = 1,
     col = "violetred")

legend(x = 1460,
       y = 1400,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4),
                  signif(speed[2],4),
                  signif(speed[3],4),
                  signif(speed[4],4),
                  signif(speed[5],4)), 
       fill = c("darkorange", "firebrick", "royalblue", 'darkgreen', 'violetred'),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")

```

```{r echo = F, fig.height=7, fig.width= 7}


frame.distance = data.frame(Rep = c(rep("1", ((floor(max.frame[1]/100)))),
                                 rep("2", ((floor(max.frame[2]/100)))),
                                 rep("3", ((floor(max.frame[3]/100)))),
                                 rep("4", ((floor(max.frame[4]/100)))),
                                 rep("5", ((floor(max.frame[5]/100))))),
                      frame = c(100*(1:floor(max.frame[1]/100)-1),
                                100*(1:floor(max.frame[2]/100)-1),
                                100*(1:floor(max.frame[3]/100)-1),
                                100*(1:floor(max.frame[4]/100)-1),
                                100*(1:floor(max.frame[5]/100)-1)),
                        distance = c(0))


i=1
while(i<=length(unique(names(distance)))){
  temp.distance = 0
  j = 200
  while(j-100 < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    temp.distance = temp.distance + sqrt((x2-x1)^2 + (y2-y1)^2)
    frame.distance[frame.distance$Rep == names(distance)[i] &
                     frame.distance$frame == j-100, "distance"]= temp.distance
    j=j+100
  }
  i=i+1
}

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,600), xlim = c(0,2700),
     xlab = "Frame",
     ylab = "Distance (px)")

lines(x = frame.distance$frame[frame.distance$Rep ==1],
     y = frame.distance$distance[frame.distance$Rep ==1],
     lwd = 1,
     col = "darkorange")

lines(x = frame.distance$frame[frame.distance$Rep ==2],
     y = frame.distance$distance[frame.distance$Rep ==2],
     lwd = 1,
     col = "firebrick")

lines(x = frame.distance$frame[frame.distance$Rep ==3],
     y = frame.distance$distance[frame.distance$Rep ==3],
     lwd = 1,
     col = "royalblue")

lines(x = frame.distance$frame[frame.distance$Rep ==4],
     y = frame.distance$distance[frame.distance$Rep ==4],
     lwd = 1,
     col = "darkgreen")

lines(x = frame.distance$frame[frame.distance$Rep ==5],
     y = frame.distance$distance[frame.distance$Rep ==5],
     lwd = 1,
     col = "violetred")

legend(x = 2800,
       y = 600,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4),
                  signif(speed[2],4),
                  signif(speed[3],4),
                  signif(speed[4],4)), 
       fill = c("darkorange", "firebrick", "royalblue", 'darkgreen', 'violetred'),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")
       


```

```{r echo = F, fig.height=7, fig.width= 7}


temp = read.csv("/Users/johncsantiago/Documents/GitHub/Python/LarvalLocomotion/PreliminaryCode/20250712_WT.csv")
title = "7/12 WT male"


max.frame = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))
max.frame = c(max(temp$Frame[temp$ObjectID == 1]),
              max(temp$Frame[temp$ObjectID == 2]),
              max(temp$Frame[temp$ObjectID == 3]),
              max(temp$Frame[temp$ObjectID == 4]),
              max(temp$Frame[temp$ObjectID == 5]))


temp = temp[(temp$ObjectID == 1 & temp$Frame <= max.frame[1]) |
              (temp$ObjectID == 2 & temp$Frame <= max.frame[2]) |
              (temp$ObjectID == 3 & temp$Frame <= max.frame[3]) |
              (temp$ObjectID == 4 & temp$Frame <= max.frame[4]) |
              (temp$ObjectID == 5 & temp$Frame <= max.frame[5]),]

distance = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))

temp$Y = 1400 - temp$Y
temp$X = 1400 - temp$X

x = temp$Y
y = temp$X

temp$X = x
temp$Y = y

i=1
while(i<=length(unique(names(distance)))){
  j = 101
  while(j < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    distance[i] = distance[i] + sqrt((x2-x1)^2 + (y2-y1)^2)
    j=j+100
  }
  i=i+1
}



speed = distance/(max.frame/100)

WT12.dist = distance
WT12.speed = speed

#bgpic = readPNG("/Users/johncsantiago/Documents/GitHub/WhartonLab/Python/LarvalLocomotion/PreliminaryCode/trajectory_with_snapshots.png")

#temp$y = 720 - temp$y

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,1400), xlim = c(0,1400),
     xlab = "",
     ylab = "") #ylim = c(300,600), xlim = c(200,600))#

#rasterImage(bgpic, xleft = 0,
#            xright = 1080,
#            ybottom = 0,
#            ytop = 720)

lines(x = temp$X[temp$ObjectID ==1],
     y = temp$Y[temp$ObjectID ==1],
     lwd = 1,
     col = "darkorange")


lines(x = temp$X[temp$ObjectID ==2],
     y = temp$Y[temp$ObjectID ==2],
     lwd = 1,
     col = "firebrick")

lines(x = temp$X[temp$ObjectID ==3],
     y = temp$Y[temp$ObjectID ==3],
     lwd = 1,
     col = "royalblue")

lines(x = temp$X[temp$ObjectID ==4],
     y = temp$Y[temp$ObjectID ==4],
     lwd = 1,
     col = "darkgreen")

lines(x = temp$X[temp$ObjectID ==5],
     y = temp$Y[temp$ObjectID ==5],
     lwd = 1,
     col = "violetred")

legend(x = 1460,
       y = 1400,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4),
                  signif(speed[2],4),
                  signif(speed[3],4),
                  signif(speed[4],4),
                  signif(speed[5],4)), 
       fill = c("darkorange", "firebrick", "royalblue", 'darkgreen', 'violetred'),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")

```

```{r echo = F, fig.height=7, fig.width= 7}


frame.distance = data.frame(Rep = c(rep("1", ((floor(max.frame[1]/100)))),
                                 rep("2", ((floor(max.frame[2]/100)))),
                                 rep("3", ((floor(max.frame[3]/100)))),
                                 rep("4", ((floor(max.frame[4]/100)))),
                                 rep("5", ((floor(max.frame[5]/100))))),
                      frame = c(100*(1:floor(max.frame[1]/100)-1),
                                100*(1:floor(max.frame[2]/100)-1),
                                100*(1:floor(max.frame[3]/100)-1),
                                100*(1:floor(max.frame[4]/100)-1),
                                100*(1:floor(max.frame[5]/100)-1)),
                        distance = c(0))


i=1
while(i<=length(unique(names(distance)))){
  temp.distance = 0
  j = 200
  while(j-100 < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    temp.distance = temp.distance + sqrt((x2-x1)^2 + (y2-y1)^2)
    frame.distance[frame.distance$Rep == names(distance)[i] &
                     frame.distance$frame == j-100, "distance"]= temp.distance
    j=j+100
  }
  i=i+1
}

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,600), xlim = c(0,2700),
     xlab = "Frame",
     ylab = "Distance (px)")

lines(x = frame.distance$frame[frame.distance$Rep ==1],
     y = frame.distance$distance[frame.distance$Rep ==1],
     lwd = 1,
     col = "darkorange")


lines(x = frame.distance$frame[frame.distance$Rep ==2],
     y = frame.distance$distance[frame.distance$Rep ==2],
     lwd = 1,
     col = "firebrick")

lines(x = frame.distance$frame[frame.distance$Rep ==3],
     y = frame.distance$distance[frame.distance$Rep ==3],
     lwd = 1,
     col = "royalblue")

lines(x = frame.distance$frame[frame.distance$Rep ==4],
     y = frame.distance$distance[frame.distance$Rep ==4],
     lwd = 1,
     col = "darkgreen")

lines(x = frame.distance$frame[frame.distance$Rep ==5],
     y = frame.distance$distance[frame.distance$Rep ==5],
     lwd = 1,
     col = "violetred")

legend(x = 2800,
       y = 600,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4),
                  signif(speed[2],4),
                  signif(speed[3],4),
                  signif(speed[4],4),
                  signif(speed[5],4)), 
       fill = c("darkorange", "firebrick", "royalblue", 'darkgreen', 'violetred'),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")
       


```


```{r echo = F, fig.height=7, fig.width= 7}


temp = read.csv("/Users/johncsantiago/Documents/GitHub/Python/LarvalLocomotion/PreliminaryCode/20250712_G85R.csv")
title = "7/12 G85R male"

max.frame = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))
max.frame = c(1600,
              max(temp$Frame[temp$ObjectID == 2]),
              max(temp$Frame[temp$ObjectID == 3]),
              max(temp$Frame[temp$ObjectID == 4]),
              max(temp$Frame[temp$ObjectID == 5]))


temp = temp[(temp$ObjectID == 1 & temp$Frame <= max.frame[1]) |
              (temp$ObjectID == 2 & temp$Frame <= max.frame[2]) |
              (temp$ObjectID == 3 & temp$Frame <= max.frame[3]) |
              (temp$ObjectID == 4 & temp$Frame <= max.frame[4]) |
              (temp$ObjectID == 5 & temp$Frame <= max.frame[5]),]

distance = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))

temp$Y = 1400 - temp$Y
temp$X = 1400 - temp$X

x = temp$Y
y = temp$X

temp$X = x
temp$Y = y

i=1
while(i<=length(unique(names(distance)))){
  j = 101
  while(j < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    distance[i] = distance[i] + sqrt((x2-x1)^2 + (y2-y1)^2)
    j=j+100
  }
  i=i+1
}



speed = distance/(max.frame/100)

G85R12.dist = distance
G85R12.speed = speed

#bgpic = readPNG("/Users/johncsantiago/Documents/GitHub/WhartonLab/Python/LarvalLocomotion/PreliminaryCode/trajectory_with_snapshots.png")

#temp$y = 720 - temp$y

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,1400), xlim = c(0,1400),
     xlab = "",
     ylab = "") #ylim = c(300,600), xlim = c(200,600))#

#rasterImage(bgpic, xleft = 0,
#            xright = 1080,
#            ybottom = 0,
#            ytop = 720)

lines(x = temp$X[temp$ObjectID ==1],
     y = temp$Y[temp$ObjectID ==1],
     lwd = 1,
     col = "darkorange")


lines(x = temp$X[temp$ObjectID ==2],
     y = temp$Y[temp$ObjectID ==2],
     lwd = 1,
     col = "firebrick")

lines(x = temp$X[temp$ObjectID ==3],
     y = temp$Y[temp$ObjectID ==3],
     lwd = 1,
     col = "royalblue")

lines(x = temp$X[temp$ObjectID ==4],
     y = temp$Y[temp$ObjectID ==4],
     lwd = 1,
     col = "darkgreen")

lines(x = temp$X[temp$ObjectID ==5],
     y = temp$Y[temp$ObjectID ==5],
     lwd = 1,
     col = "violetred")

legend(x = 1460,
       y = 1400,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4),
                  signif(speed[2],4),
                  signif(speed[3],4),
                  signif(speed[4],4),
                  signif(speed[5],4)), 
       fill = c("darkorange", "firebrick", "royalblue", 'darkgreen', 'violetred'),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")

```

```{r echo = F, fig.height=7, fig.width= 7}


frame.distance = data.frame(Rep = c(rep("1", ((floor(max.frame[1]/100)))),
                                 rep("2", ((floor(max.frame[2]/100)))),
                                 rep("3", ((floor(max.frame[3]/100)))),
                                 rep("4", ((floor(max.frame[4]/100)))),
                                 rep("5", ((floor(max.frame[5]/100))))),
                      frame = c(100*(1:floor(max.frame[1]/100)-1),
                                100*(1:floor(max.frame[2]/100)-1),
                                100*(1:floor(max.frame[3]/100)-1),
                                100*(1:floor(max.frame[4]/100)-1),
                                100*(1:floor(max.frame[5]/100)-1)),
                        distance = c(0))


i=1
while(i<=length(unique(names(distance)))){
  temp.distance = 0
  j = 200
  while(j-100 < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    temp.distance = temp.distance + sqrt((x2-x1)^2 + (y2-y1)^2)
    frame.distance[frame.distance$Rep == names(distance)[i] &
                     frame.distance$frame == j-100, "distance"]= temp.distance
    j=j+100
  }
  i=i+1
}

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,600), xlim = c(0,2700),
     xlab = "Frame",
     ylab = "Distance (px)")

lines(x = frame.distance$frame[frame.distance$Rep ==1],
     y = frame.distance$distance[frame.distance$Rep ==1],
     lwd = 1,
     col = "darkorange")


lines(x = frame.distance$frame[frame.distance$Rep ==2],
     y = frame.distance$distance[frame.distance$Rep ==2],
     lwd = 1,
     col = "firebrick")

lines(x = frame.distance$frame[frame.distance$Rep ==3],
     y = frame.distance$distance[frame.distance$Rep ==3],
     lwd = 1,
     col = "royalblue")

lines(x = frame.distance$frame[frame.distance$Rep ==4],
     y = frame.distance$distance[frame.distance$Rep ==4],
     lwd = 1,
     col = "darkgreen")

lines(x = frame.distance$frame[frame.distance$Rep ==5],
     y = frame.distance$distance[frame.distance$Rep ==5],
     lwd = 1,
     col = "violetred")

legend(x = 2800,
       y = 600,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4),
                  signif(speed[2],4),
                  signif(speed[3],4),
                  signif(speed[4],4),
                  signif(speed[5],4)), 
       fill = c("darkorange", "firebrick", "royalblue", 'darkgreen', 'violetred'),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")
       


```

```{r echo = F, fig.height=7, fig.width= 7}


temp = read.csv("/Users/johncsantiago/Documents/GitHub/Python/LarvalLocomotion/PreliminaryCode/20250712_ChATtrioWT.csv")
title = "7/12 WT-trio male"


max.frame = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))
max.frame = c(max(temp$Frame[temp$ObjectID == 1]),
              max(temp$Frame[temp$ObjectID == 2]),
              max(temp$Frame[temp$ObjectID == 3]),
              max(temp$Frame[temp$ObjectID == 4]),
              max(temp$Frame[temp$ObjectID == 5]))


temp = temp[(temp$ObjectID == 1 & temp$Frame <= max.frame[1]) |
              (temp$ObjectID == 2 & temp$Frame <= max.frame[2]) |
              (temp$ObjectID == 3 & temp$Frame <= max.frame[3]) |
              (temp$ObjectID == 4 & temp$Frame <= max.frame[4]) |
              (temp$ObjectID == 5 & temp$Frame <= max.frame[5]),]

distance = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))

temp$Y = 1400 - temp$Y
temp$X = 1400 - temp$X

x = temp$Y
y = temp$X

temp$X = x
temp$Y = y

i=1
while(i<=length(unique(names(distance)))){
  j = 101
  while(j < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    distance[i] = distance[i] + sqrt((x2-x1)^2 + (y2-y1)^2)
    j=j+100
  }
  i=i+1
}



speed = distance/(max.frame/100)

trioWT12.dist = distance
trioWT12.speed = speed

#bgpic = readPNG("/Users/johncsantiago/Documents/GitHub/WhartonLab/Python/LarvalLocomotion/PreliminaryCode/trajectory_with_snapshots.png")

#temp$y = 720 - temp$y

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,1400), xlim = c(0,1400),
     xlab = "",
     ylab = "") #ylim = c(300,600), xlim = c(200,600))#

#rasterImage(bgpic, xleft = 0,
#            xright = 1080,
#            ybottom = 0,
#            ytop = 720)

lines(x = temp$X[temp$ObjectID ==1],
     y = temp$Y[temp$ObjectID ==1],
     lwd = 1,
     col = "darkorange")


lines(x = temp$X[temp$ObjectID ==2],
     y = temp$Y[temp$ObjectID ==2],
     lwd = 1,
     col = "firebrick")

lines(x = temp$X[temp$ObjectID ==3],
     y = temp$Y[temp$ObjectID ==3],
     lwd = 1,
     col = "royalblue")

lines(x = temp$X[temp$ObjectID ==4],
     y = temp$Y[temp$ObjectID ==4],
     lwd = 1,
     col = "darkgreen")

lines(x = temp$X[temp$ObjectID ==5],
     y = temp$Y[temp$ObjectID ==5],
     lwd = 1,
     col = "violetred")

legend(x = 1460,
       y = 1400,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4),
                  signif(speed[2],4),
                  signif(speed[3],4),
                  signif(speed[4],4),
                  signif(speed[5],4)), 
       fill = c("darkorange", "firebrick", "royalblue", 'darkgreen', 'violetred'),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")

```

```{r echo = F, fig.height=7, fig.width= 7}


frame.distance = data.frame(Rep = c(rep("1", ((floor(max.frame[1]/100)))),
                                 rep("2", ((floor(max.frame[2]/100)))),
                                 rep("3", ((floor(max.frame[3]/100)))),
                                 rep("4", ((floor(max.frame[4]/100)))),
                                 rep("5", ((floor(max.frame[5]/100))))),
                      frame = c(100*(1:floor(max.frame[1]/100)-1),
                                100*(1:floor(max.frame[2]/100)-1),
                                100*(1:floor(max.frame[3]/100)-1),
                                100*(1:floor(max.frame[4]/100)-1),
                                100*(1:floor(max.frame[5]/100)-1)),
                        distance = c(0))


i=1
while(i<=length(unique(names(distance)))){
  temp.distance = 0
  j = 200
  while(j-100 < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    temp.distance = temp.distance + sqrt((x2-x1)^2 + (y2-y1)^2)
    frame.distance[frame.distance$Rep == names(distance)[i] &
                     frame.distance$frame == j-100, "distance"]= temp.distance
    j=j+100
  }
  i=i+1
}

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,600), xlim = c(0,2700),
     xlab = "Frame",
     ylab = "Distance (px)")

lines(x = frame.distance$frame[frame.distance$Rep ==1],
     y = frame.distance$distance[frame.distance$Rep ==1],
     lwd = 1,
     col = "darkorange")


lines(x = frame.distance$frame[frame.distance$Rep ==2],
     y = frame.distance$distance[frame.distance$Rep ==2],
     lwd = 1,
     col = "firebrick")

lines(x = frame.distance$frame[frame.distance$Rep ==3],
     y = frame.distance$distance[frame.distance$Rep ==3],
     lwd = 1,
     col = "royalblue")

lines(x = frame.distance$frame[frame.distance$Rep ==4],
     y = frame.distance$distance[frame.distance$Rep ==4],
     lwd = 1,
     col = "darkgreen")

lines(x = frame.distance$frame[frame.distance$Rep ==5],
     y = frame.distance$distance[frame.distance$Rep ==5],
     lwd = 1,
     col = "violetred")

legend(x = 2800,
       y = 600,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4),
                  signif(speed[2],4),
                  signif(speed[3],4),
                  signif(speed[4],4),
                  signif(speed[5],4)), 
       fill = c("darkorange", "firebrick", "royalblue", 'darkgreen', 'violetred'),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")
       


```


```{r echo = F, fig.height=7, fig.width= 7}


temp = read.csv("/Users/johncsantiago/Documents/GitHub/Python/LarvalLocomotion/PreliminaryCode/20250712_ChATtrioG85R.csv")
title = "7/12 G85R-trio male"

temp = temp[temp$ObjectID != 2,]

max.frame = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))
max.frame = c(max(temp$Frame[temp$ObjectID == 1]),
              max(temp$Frame[temp$ObjectID == 3]),
              max(temp$Frame[temp$ObjectID == 4]),
              max(temp$Frame[temp$ObjectID == 5]))


temp = temp[(temp$ObjectID == 1 & temp$Frame <= max.frame[1]) |
              (temp$ObjectID == 3 & temp$Frame <= max.frame[2]) |
              (temp$ObjectID == 4 & temp$Frame <= max.frame[3]) |
              (temp$ObjectID == 5 & temp$Frame <= max.frame[4]),]

distance = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))

temp$Y = 1400 - temp$Y
temp$X = 1400 - temp$X

x = temp$Y
y = temp$X

temp$X = x
temp$Y = y

i=1
while(i<=length(unique(names(distance)))){
  j = 101
  while(j < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    distance[i] = distance[i] + sqrt((x2-x1)^2 + (y2-y1)^2)
    j=j+100
  }
  i=i+1
}



speed = distance/(max.frame/100)

trioG85R12.dist = distance
trioG85R12.speed = speed

#bgpic = readPNG("/Users/johncsantiago/Documents/GitHub/WhartonLab/Python/LarvalLocomotion/PreliminaryCode/trajectory_with_snapshots.png")

#temp$y = 720 - temp$y

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,1400), xlim = c(0,1400),
     xlab = "",
     ylab = "") #ylim = c(300,600), xlim = c(200,600))#

#rasterImage(bgpic, xleft = 0,
#            xright = 1080,
#            ybottom = 0,
#            ytop = 720)

lines(x = temp$X[temp$ObjectID ==1],
     y = temp$Y[temp$ObjectID ==1],
     lwd = 1,
     col = "darkorange")


lines(x = temp$X[temp$ObjectID ==3],
     y = temp$Y[temp$ObjectID ==3],
     lwd = 1,
     col = "royalblue")

lines(x = temp$X[temp$ObjectID ==4],
     y = temp$Y[temp$ObjectID ==4],
     lwd = 1,
     col = "darkgreen")

lines(x = temp$X[temp$ObjectID ==5],
     y = temp$Y[temp$ObjectID ==5],
     lwd = 1,
     col = "violetred")

legend(x = 1460,
       y = 1400,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4),
                  signif(speed[2],4),
                  signif(speed[3],4),
                  signif(speed[4],4),
                  signif(speed[5],4)), 
       fill = c("darkorange", "royalblue", 'darkgreen', 'violetred'),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")

```

```{r echo = F, fig.height=7, fig.width= 7}


frame.distance = data.frame(Rep = c(rep("1", ((floor(max.frame[1]/100)))),
                                 rep("3", ((floor(max.frame[2]/100)))),
                                 rep("4", ((floor(max.frame[3]/100)))),
                                 rep("5", ((floor(max.frame[4]/100))))),
                      frame = c(100*(1:floor(max.frame[1]/100)-1),
                                100*(1:floor(max.frame[2]/100)-1),
                                100*(1:floor(max.frame[3]/100)-1),
                                100*(1:floor(max.frame[4]/100)-1)),
                        distance = c(0))


i=1
while(i<=length(unique(names(distance)))){
  temp.distance = 0
  j = 200
  while(j-100 < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    temp.distance = temp.distance + sqrt((x2-x1)^2 + (y2-y1)^2)
    frame.distance[frame.distance$Rep == names(distance)[i] &
                     frame.distance$frame == j-100, "distance"]= temp.distance
    j=j+100
  }
  i=i+1
}

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,600), xlim = c(0,2700),
     xlab = "Frame",
     ylab = "Distance (px)")

lines(x = frame.distance$frame[frame.distance$Rep ==1],
     y = frame.distance$distance[frame.distance$Rep ==1],
     lwd = 1,
     col = "darkorange")

lines(x = frame.distance$frame[frame.distance$Rep ==3],
     y = frame.distance$distance[frame.distance$Rep ==3],
     lwd = 1,
     col = "royalblue")

lines(x = frame.distance$frame[frame.distance$Rep ==4],
     y = frame.distance$distance[frame.distance$Rep ==4],
     lwd = 1,
     col = "darkgreen")

lines(x = frame.distance$frame[frame.distance$Rep ==5],
     y = frame.distance$distance[frame.distance$Rep ==5],
     lwd = 1,
     col = "violetred")

legend(x = 2800,
       y = 600,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4),
                  signif(speed[2],4),
                  signif(speed[3],4),
                  signif(speed[4],4)), 
       fill = c("darkorange", "royalblue", 'darkgreen', 'violetred'),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")
       


```

```{r echo = F, fig.height=7, fig.width= 7}


temp = read.csv("/Users/johncsantiago/Documents/GitHub/Python/LarvalLocomotion/PreliminaryCode/20250706_WT.csv")
title = "7/6 WT male"

temp = temp[temp$ObjectID != 5, ]
max.frame = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))
max.frame = c(max(temp$Frame[temp$ObjectID == 1]),
              max(temp$Frame[temp$ObjectID == 2]),
              1000,
              max(temp$Frame[temp$ObjectID == 4]))


temp = temp[(temp$ObjectID == 1 & temp$Frame <= max.frame[1]) |
              (temp$ObjectID == 2 & temp$Frame <= max.frame[2]) |
              (temp$ObjectID == 3 & temp$Frame <= max.frame[3]) |
              (temp$ObjectID == 4 & temp$Frame <= max.frame[4]),]

distance = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))

temp$Y = 1400 - temp$Y
temp$X = 1400 - temp$X

x = temp$Y
y = temp$X

temp$X = x
temp$Y = y

i=1
while(i<=length(unique(names(distance)))){
  j = 101
  while(j < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    distance[i] = distance[i] + sqrt((x2-x1)^2 + (y2-y1)^2)
    j=j+100
  }
  i=i+1
}



speed = distance/(max.frame/100)

WT6.dist = distance
WT6.speed = speed

#bgpic = readPNG("/Users/johncsantiago/Documents/GitHub/WhartonLab/Python/LarvalLocomotion/PreliminaryCode/trajectory_with_snapshots.png")

#temp$y = 720 - temp$y

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,1400), xlim = c(0,1400),
     xlab = "",
     ylab = "") #ylim = c(300,600), xlim = c(200,600))#

#rasterImage(bgpic, xleft = 0,
#            xright = 1080,
#            ybottom = 0,
#            ytop = 720)

lines(x = temp$X[temp$ObjectID ==1],
     y = temp$Y[temp$ObjectID ==1],
     lwd = 1,
     col = "darkorange")


lines(x = temp$X[temp$ObjectID ==2],
     y = temp$Y[temp$ObjectID ==2],
     lwd = 1,
     col = "firebrick")

lines(x = temp$X[temp$ObjectID ==3],
     y = temp$Y[temp$ObjectID ==3],
     lwd = 1,
     col = "royalblue")

lines(x = temp$X[temp$ObjectID ==4],
     y = temp$Y[temp$ObjectID ==4],
     lwd = 1,
     col = "darkgreen")

legend(x = 1460,
       y = 1400,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4),
                  signif(speed[2],4),
                  signif(speed[3],4),
                  signif(speed[4],4)), 
       fill = c("darkorange", "firebrick", "royalblue", 'darkgreen'),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")

```

```{r echo = F, fig.height=7, fig.width= 7}


frame.distance = data.frame(Rep = c(rep("1", ((floor(max.frame[1]/100)))),
                                 rep("2", ((floor(max.frame[2]/100)))),
                                 rep("3", ((floor(max.frame[3]/100)))),
                                 rep("4", ((floor(max.frame[4]/100))))),
                      frame = c(100*(1:floor(max.frame[1]/100)-1),
                                100*(1:floor(max.frame[2]/100)-1),
                                100*(1:floor(max.frame[3]/100)-1),
                                100*(1:floor(max.frame[4]/100)-1)),
                        distance = c(0))


i=1
while(i<=length(unique(names(distance)))){
  temp.distance = 0
  j = 200
  while(j-100 < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    temp.distance = temp.distance + sqrt((x2-x1)^2 + (y2-y1)^2)
    frame.distance[frame.distance$Rep == names(distance)[i] &
                     frame.distance$frame == j-100, "distance"]= temp.distance
    j=j+100
  }
  i=i+1
}

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,600), xlim = c(0,2700),
     xlab = "Frame",
     ylab = "Distance (px)")

lines(x = frame.distance$frame[frame.distance$Rep ==1],
     y = frame.distance$distance[frame.distance$Rep ==1],
     lwd = 1,
     col = "darkorange")


lines(x = frame.distance$frame[frame.distance$Rep ==2],
     y = frame.distance$distance[frame.distance$Rep ==2],
     lwd = 1,
     col = "firebrick")

lines(x = frame.distance$frame[frame.distance$Rep ==3],
     y = frame.distance$distance[frame.distance$Rep ==3],
     lwd = 1,
     col = "royalblue")

lines(x = frame.distance$frame[frame.distance$Rep ==4],
     y = frame.distance$distance[frame.distance$Rep ==4],
     lwd = 1,
     col = "darkgreen")

legend(x = 2800,
       y = 600,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4),
                  signif(speed[2],4),
                  signif(speed[3],4),
                  signif(speed[4],4)), 
       fill = c("darkorange", "firebrick", "royalblue", 'darkgreen'),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")
       


```

```{r echo = F, fig.height=7, fig.width= 7}


temp = read.csv("/Users/johncsantiago/Documents/GitHub/Python/LarvalLocomotion/PreliminaryCode/20250706_ChATtrioWT.csv")
title = "7/6 WT-trio male"


max.frame = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))
max.frame = c(max(temp$Frame[temp$ObjectID == 1]),
              max(temp$Frame[temp$ObjectID == 2]),
              max(temp$Frame[temp$ObjectID == 3]),
              max(temp$Frame[temp$ObjectID == 4]),
              max(temp$Frame[temp$ObjectID == 5]))


temp = temp[(temp$ObjectID == 1 & temp$Frame <= max.frame[1]) |
              (temp$ObjectID == 2 & temp$Frame <= max.frame[2]) |
              (temp$ObjectID == 3 & temp$Frame <= max.frame[3]) |
              (temp$ObjectID == 4 & temp$Frame <= max.frame[4]) |
              (temp$ObjectID == 5 & temp$Frame <= max.frame[5]),]

distance = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))

temp$Y = 1400 - temp$Y
temp$X = 1400 - temp$X

x = temp$Y
y = temp$X

temp$X = x
temp$Y = y

i=1
while(i<=length(unique(names(distance)))){
  j = 101
  while(j < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    distance[i] = distance[i] + sqrt((x2-x1)^2 + (y2-y1)^2)
    j=j+100
  }
  i=i+1
}



speed = distance/(max.frame/100)

trioWT6.dist = distance
trioWT6.speed = speed

#bgpic = readPNG("/Users/johncsantiago/Documents/GitHub/WhartonLab/Python/LarvalLocomotion/PreliminaryCode/trajectory_with_snapshots.png")

#temp$y = 720 - temp$y

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,1400), xlim = c(0,1400),
     xlab = "",
     ylab = "") #ylim = c(300,600), xlim = c(200,600))#

#rasterImage(bgpic, xleft = 0,
#            xright = 1080,
#            ybottom = 0,
#            ytop = 720)

lines(x = temp$X[temp$ObjectID ==1],
     y = temp$Y[temp$ObjectID ==1],
     lwd = 1,
     col = "darkorange")


lines(x = temp$X[temp$ObjectID ==2],
     y = temp$Y[temp$ObjectID ==2],
     lwd = 1,
     col = "firebrick")

lines(x = temp$X[temp$ObjectID ==3],
     y = temp$Y[temp$ObjectID ==3],
     lwd = 1,
     col = "royalblue")

lines(x = temp$X[temp$ObjectID ==4],
     y = temp$Y[temp$ObjectID ==4],
     lwd = 1,
     col = "darkgreen")

lines(x = temp$X[temp$ObjectID ==5],
     y = temp$Y[temp$ObjectID ==5],
     lwd = 1,
     col = "violetred")

legend(x = 1460,
       y = 1400,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4),
                  signif(speed[2],4),
                  signif(speed[3],4),
                  signif(speed[4],4),
                  signif(speed[5],4)), 
       fill = c("darkorange", "firebrick", "royalblue", 'darkgreen', 'violetred'),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")

```

```{r echo = F, fig.height=7, fig.width= 7}


frame.distance = data.frame(Rep = c(rep("1", ((floor(max.frame[1]/100)))),
                                 rep("2", ((floor(max.frame[2]/100)))),
                                 rep("3", ((floor(max.frame[3]/100)))),
                                 rep("4", ((floor(max.frame[4]/100)))),
                                 rep("5", ((floor(max.frame[5]/100))))),
                      frame = c(100*(1:floor(max.frame[1]/100)-1),
                                100*(1:floor(max.frame[2]/100)-1),
                                100*(1:floor(max.frame[3]/100)-1),
                                100*(1:floor(max.frame[4]/100)-1),
                                100*(1:floor(max.frame[5]/100)-1)),
                        distance = c(0))


i=1
while(i<=length(unique(names(distance)))){
  temp.distance = 0
  j = 200
  while(j-100 < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    temp.distance = temp.distance + sqrt((x2-x1)^2 + (y2-y1)^2)
    frame.distance[frame.distance$Rep == names(distance)[i] &
                     frame.distance$frame == j-100, "distance"]= temp.distance
    j=j+100
  }
  i=i+1
}

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,600), xlim = c(0,2700),
     xlab = "Frame",
     ylab = "Distance (px)")

lines(x = frame.distance$frame[frame.distance$Rep ==1],
     y = frame.distance$distance[frame.distance$Rep ==1],
     lwd = 1,
     col = "darkorange")


lines(x = frame.distance$frame[frame.distance$Rep ==2],
     y = frame.distance$distance[frame.distance$Rep ==2],
     lwd = 1,
     col = "firebrick")

lines(x = frame.distance$frame[frame.distance$Rep ==3],
     y = frame.distance$distance[frame.distance$Rep ==3],
     lwd = 1,
     col = "royalblue")

lines(x = frame.distance$frame[frame.distance$Rep ==4],
     y = frame.distance$distance[frame.distance$Rep ==4],
     lwd = 1,
     col = "darkgreen")

lines(x = frame.distance$frame[frame.distance$Rep ==5],
     y = frame.distance$distance[frame.distance$Rep ==5],
     lwd = 1,
     col = "violetred")

legend(x = 2800,
       y = 600,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4),
                  signif(speed[2],4),
                  signif(speed[3],4),
                  signif(speed[4],4),
                  signif(speed[5],4)), 
       fill = c("darkorange", "firebrick", "royalblue", 'darkgreen', 'violetred'),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")
       


```


```{r echo = F, fig.height=7, fig.width= 7}


temp = read.csv("/Users/johncsantiago/Documents/GitHub/Python/LarvalLocomotion/PreliminaryCode/20250706_ChATtrioG85R.csv")
title = "7/06 G85R-trio male"

temp = temp[temp$ObjectID != 3, ]

max.frame = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))
max.frame = c(max(temp$Frame[temp$ObjectID == 1]),
              max(temp$Frame[temp$ObjectID == 2]),
              max(temp$Frame[temp$ObjectID == 4]))


temp = temp[(temp$ObjectID == 1 & temp$Frame <= max.frame[1]) |
              (temp$ObjectID == 2 & temp$Frame <= max.frame[2]) |
              (temp$ObjectID == 4 & temp$Frame <= max.frame[3]),]

distance = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))

temp$Y = 1400 - temp$Y
temp$X = 1400 - temp$X

x = temp$Y
y = temp$X

temp$X = x
temp$Y = y

i=1
while(i<=length(unique(names(distance)))){
  j = 101
  while(j < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    distance[i] = distance[i] + sqrt((x2-x1)^2 + (y2-y1)^2)
    j=j+100
  }
  i=i+1
}



speed = distance/(max.frame/100)

trioG85R6.dist = distance
trioG85R6.speed = speed

#bgpic = readPNG("/Users/johncsantiago/Documents/GitHub/WhartonLab/Python/LarvalLocomotion/PreliminaryCode/trajectory_with_snapshots.png")

#temp$y = 720 - temp$y

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,1400), xlim = c(0,1400),
     xlab = "",
     ylab = "") #ylim = c(300,600), xlim = c(200,600))#

#rasterImage(bgpic, xleft = 0,
#            xright = 1080,
#            ybottom = 0,
#            ytop = 720)

lines(x = temp$X[temp$ObjectID ==1],
     y = temp$Y[temp$ObjectID ==1],
     lwd = 1,
     col = "darkorange")


lines(x = temp$X[temp$ObjectID ==2],
     y = temp$Y[temp$ObjectID ==2],
     lwd = 1,
     col = "royalblue")

lines(x = temp$X[temp$ObjectID ==4],
     y = temp$Y[temp$ObjectID ==4],
     lwd = 1,
     col = "violetred")

legend(x = 1460,
       y = 1400,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4),
                  signif(speed[2],4),
                  signif(speed[3],4)), 
       fill = c("darkorange", "royalblue", 'violetred'),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")

```

```{r echo = F, fig.height=7, fig.width= 7}


frame.distance = data.frame(Rep = c(rep("1", ((floor(max.frame[1]/100)))),
                                 rep("2", ((floor(max.frame[2]/100)))),
                                 rep("4", ((floor(max.frame[3]/100))))),
                      frame = c(100*(1:floor(max.frame[1]/100)-1),
                                100*(1:floor(max.frame[2]/100)-1),
                                100*(1:floor(max.frame[3]/100)-1)),
                        distance = c(0))


i=1
while(i<=length(unique(names(distance)))){
  temp.distance = 0
  j = 200
  while(j-100 < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    temp.distance = temp.distance + sqrt((x2-x1)^2 + (y2-y1)^2)
    frame.distance[frame.distance$Rep == names(distance)[i] &
                     frame.distance$frame == j-100, "distance"]= temp.distance
    j=j+100
  }
  i=i+1
}

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,600), xlim = c(0,2700),
     xlab = "Frame",
     ylab = "Distance (px)")

lines(x = frame.distance$frame[frame.distance$Rep ==1],
     y = frame.distance$distance[frame.distance$Rep ==1],
     lwd = 1,
     col = "darkorange")

lines(x = frame.distance$frame[frame.distance$Rep ==2],
     y = frame.distance$distance[frame.distance$Rep ==2],
     lwd = 1,
     col = "royalblue")

lines(x = frame.distance$frame[frame.distance$Rep ==4],
     y = frame.distance$distance[frame.distance$Rep ==4],
     lwd = 1,
     col = "violetred")

legend(x = 2800,
       y = 600,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],4),
                  signif(speed[2],4),
                  signif(speed[3],4)), 
       fill = c("darkorange", "royalblue", 'violetred'),
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "px/100frames")
       


```



    
```{r echo = F}
  
all.larvae = data.frame(Genotype = character(),
                        Day = numeric(),
                        Speed = numeric(),
                        Distance = numeric())

WT = data.frame(Genotype = rep("WT", length(WT2.dist) + length(WT3.dist) + length(WT7.dist) + length(WT8.dist) + length(WT9.dist) + length(WT6.dist) + length(WT10.dist) + length(WT12.dist) + length(WT14.dist)),
                Day = c(rep(2, length(WT2.dist)), rep(3, length(WT3.dist)), rep(7, length(WT7.dist)), rep(8, length(WT8.dist)), rep(9, length(WT9.dist)), rep(6, length(WT6.dist)), rep(10, length(WT10.dist)), rep(12, length(WT12.dist)), rep(14, length(WT14.dist))),
                Speed = c(WT2.speed, WT3.speed, WT7.speed, WT8.speed, WT9.speed, WT6.speed, WT10.speed, WT12.speed, WT14.speed),
                Distance = c(WT2.dist, WT3.dist, WT7.dist, WT8.dist, WT9.dist, WT6.dist, WT10.dist, WT12.dist, WT14.dist))


GR = data.frame(Genotype = rep("G85R", length(G85R2.dist) + length(G85R3.dist) + length(G85R7.dist) + length(G85R8.dist) + length(G85R9.dist) + length(G85R10.dist) + length(G85R12.dist) + length(G85R14.dist)),
                Day = c(rep(2, length(G85R2.dist)), rep(3, length(G85R3.dist)), rep(7, length(G85R7.dist)), rep(8, length(G85R8.dist)), rep(9, length(G85R9.dist)), rep(10, length(G85R10.dist)), rep(12, length(G85R12.dist)), rep(14, length(G85R14.dist))),
                Speed = c(G85R2.speed, G85R3.speed, G85R7.speed, G85R8.speed, G85R9.speed, G85R10.speed, G85R12.speed, G85R14.speed),
                Distance = c(G85R2.dist, G85R3.dist, G85R7.dist, G85R8.dist, G85R9.dist, G85R10.dist, G85R12.dist, G85R14.dist))
 
trioWT = data.frame(Genotype = rep("trioWT", length(trioWT2.dist) + length(trioWT3.dist) + length(trioWT7.dist) + length(trioWT8.dist) + length(trioWT9.dist)+ length(trioWT6.dist) + length(trioWT10.dist) + length(trioWT12.dist) + length(trioWT14.dist)),
                Day = c(rep(2, length(trioWT2.dist)), rep(3, length(trioWT3.dist)), rep(7, length(trioWT7.dist)), rep(8, length(trioWT8.dist)), rep(9, length(trioWT9.dist)), rep(6, length(trioWT6.dist)), rep(10, length(trioWT10.dist)), rep(12, length(trioWT12.dist)), rep(14, length(trioWT14.dist))),
                Speed = c(trioWT2.speed, trioWT3.speed, trioWT7.speed, trioWT8.speed, trioWT9.speed, trioWT6.speed, trioWT10.speed, trioWT12.speed, trioWT14.speed),
                Distance = c(trioWT2.dist, trioWT3.dist, trioWT7.dist, trioWT8.dist, trioWT9.dist, trioWT6.dist, trioWT10.dist, trioWT12.dist, trioWT14.dist))

trioGR = data.frame(Genotype = rep("trioG85R", length(trioG85R2.dist) + length(trioG85R3.dist) + length(trioG85R7.dist) + length(trioG85R8.dist) + length(trioG85R9.dist)+ length(trioG85R6.dist) + length(trioG85R10.dist) + length(trioG85R12.dist) + length(trioG85R14.dist)),
                Day = c(rep(2, length(trioG85R2.dist)), rep(3, length(trioG85R3.dist)), rep(7, length(trioG85R7.dist)), rep(8, length(trioG85R8.dist)), rep(9, length(trioG85R9.dist)), rep(6, length(trioG85R6.dist)), rep(10, length(trioG85R10.dist)), rep(12, length(trioG85R12.dist)), rep(14, length(trioG85R14.dist))),
                Speed = c(trioG85R2.speed, trioG85R3.speed, trioG85R7.speed, trioG85R8.speed, trioG85R9.speed, trioG85R6.speed, trioG85R10.speed, trioG85R12.speed, trioG85R14.speed),
                Distance = c(trioG85R2.dist, trioG85R3.dist, trioG85R7.dist, trioG85R8.dist, trioG85R9.dist, trioG85R6.dist, trioG85R10.dist, trioG85R12.dist, trioG85R14.dist))
   
all.larvae = rbind(WT, rbind(GR, rbind(trioWT, trioGR)))

  
```
  

```{r echo = F}

std.colors = setNames(c('navy', "orange2", 
                        "darkgreen", "firebrick",
                        "turquoise3", "deeppink"),
                      c("WT(cr/LoxP)" , "G85R(cr/hr)",
                        "OK371-gbb; WT(cr/LoxP)", "OK371-gbb; G85R(cr/LoxP)",
                        "OK371-saxA; WT(cr/LoxP)", "OK371-saxA; G85R(cr/LoxP)"))


hex = function(color, alpha){
  rgb2hex = color
  i = 1
  while(i <= length(color)){
    rgbvals = col2rgb(color[i])
    rgb2hex[i] = rgb(rgbvals[1]/255, rgbvals[2]/255, rgbvals[3]/255, alpha)
    i = i+1
  }
  return(rgb2hex)
}

speed.means = data.frame(WT = mean(all.larvae$Speed[all.larvae$Genotype == "WT"]),
                         G85R = mean(all.larvae$Speed[all.larvae$Genotype == "G85R"]),
                         trioWT = mean(all.larvae$Speed[all.larvae$Genotype == "trioWT"]),
                         trioG85R = mean(all.larvae$Speed[all.larvae$Genotype == "trioG85R"]))


all.larvae$Genotype = factor(all.larvae$Genotype, levels = c("WT", "G85R", "trioWT", "trioG85R"))

par(mar=c(6.25, 4.1, 4.1, 5.6))

plot(x = c(.75,1.25),
     y = rep(speed.means[1], 2),
     type = 'l',
     lwd = 3,
     col = std.colors[1],
     ylim = c(0, max(speed.data$Speed)*1.1),
     xlim = c(.5, length(na.omit(speed.means))+.5),
     xaxt = "n",
     ylab="Larvae Speed (px/100 frames)",
     yaxt = "n",
     xlab = NA,
     frame = F,
     main = "Larval Locomotion")

lines(x = c(1.65,2.35),
     y = rep(speed.means[2], 2),
     type = 'l',
     lwd = 3,
     col = std.colors[2])

lines(x = c(2.65,3.35),
     y = rep(speed.means[3], 2),
     type = 'l',
     lwd = 3,
     col = std.colors[3])

lines(x = c(3.65,4.35),
     y = rep(speed.means[4], 2),
     type = 'l',
     lwd = 3,
     col = std.colors[4])



beeswarm(all.larvae$Speed~all.larvae$Genotype,
       pch = 21,
       method = "center",
       bg = hex(unique(std.colors[as.numeric(all.larvae$Genotype)]),.5),
       add = T)

axis(side = 1,
     at = c(1:4),
     labels = levels(all.larvae$Genotype),
     las = 1,
     lwd = 0,
     line = -.75)

lines(x = c(0.25, 4.5),
      y = c(0,0),
      lwd = 3,
      xpd = T)

  axis(side = 2,
       at = c(0,5,10,15,20,25,30),
       lwd = 2,
       line = 0,
       labels = F,
       xpd = T,
       las = 2)

  
  axis(side = 2,
       at = c(0,5,10,15,20,25,30),
       lwd = 3,
       line = 0,
       labels = T,
       xpd = T,
       las = 2)

```


```{r echo = F}

boxplot(all.larvae$Speed~all.larvae$Genotype,
        col = hex(unique(std.colors[as.numeric(all.larvae$Genotype)]),.5), xlab = "", ylab = "Larvae Speed (px/100 frames)")

```

```{r echo = F}


t.data = list("WT" = all.larvae$Speed[all.larvae$Genotype == "WT"],
              "G85R" = all.larvae$Speed[all.larvae$Genotype == "G85R"],
              "trioWT" = all.larvae$Speed[all.larvae$Genotype == "trioWT"],
              "trioG85R" = all.larvae$Speed[all.larvae$Genotype == "trioG85R"])

t.table = data.frame(Genotype1 = character(),
                     Genotype2 = character(),
                     pval = numeric())

i=1
while(i <= length(t.data)){
  j = i+1
  while(j <= length(t.data)){
    t.temp = data.frame(Genotype1 = names(t.data)[i],
                        Genotype2 = names(t.data)[j],
                        pval = t.test(x = t.data[[i]],
                                      y = t.data[[j]],
                                      paired = F)[[3]])
    t.table = rbind(t.table, t.temp)
      j = j+1
  }
  i = i+1
}


t.stripe = t.table$pval <= .05
knitr::kable(t.table,
             caption = 'All t-tests larval locomotion')  %>%
kable_styling() %>%
row_spec(c(1:nrow(t.table))[t.table$pval <= .05], bold = T, color = "black", background = "gold")

```