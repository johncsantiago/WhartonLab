---
title: "Jude activity assay"
author: "John Santiago"
date: "2025-08-15"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```



```{r echo = F, fig.height=7, fig.width= 7}
library(kableExtra)
library(beeswarm)


mm.per.pix = setNames(c(146/1030), 
                      c("A4VFG1D1"))

fps = 30

speed.conversion = mm.per.pix*fps

temp = read.csv("/Users/johncsantiago/Documents/GitHub/Python/LarvalLocomotion/PreliminaryCode/20250813_V1_mask_median_output_improved.csv")

colnames(temp)[2:4] = c("ObjectID", "X", "Y")

title = "A4VFG1 D1"


max.frame = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))

i=1
while(i<=length(max.frame)){
  max.frame[names(max.frame)[i]] = max(temp$Frame[temp$ObjectID == names(max.frame)[i]])
  i=i+1
}

i=1
while(i<=length(max.frame)){
  temp = temp[!(temp$ObjectID == names(max.frame)[i] & temp$Frame >= max.frame[names(max.frame)[i]]),]
  i = i+1
}


distance = setNames(rep(0, length(unique(temp$ObjectID))), unique(temp$ObjectID))

temp$Y = 1400 - temp$Y
temp$X = temp$X

x = temp$X
y = temp$Y

temp$X = x
temp$Y = y

i=1
while(i<=length(unique(names(distance)))){
  j = 101
  while(j < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    distance[i] = distance[i] + sqrt((x2-x1)^2 + (y2-y1)^2)
    j=j+100
  }
  i=i+1
}



speed = distance/max.frame

distance = distance*mm.per.pix["A4VFG1D1"]
speed = speed * speed.conversion["A4VFG1D1"]


A4VFG1D1.dist = distance
A4VFG1D1.speed = speed

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,1400), xlim = c(0,1400),
     xlab = "",
     ylab = "") #ylim = c(300,600), xlim = c(200,600))#

#rasterImage(bgpic, xleft = 0,
#            xright = 1080,
#            ybottom = 0,
#            ytop = 720)

sample.colors = c("darkorange", "firebrick", "royalblue", 'darkgreen', 'violetred')

i=1
while(i<= length(distance)){
  lines(x = temp$X[temp$ObjectID == names(max.frame)[i]],
     y = temp$Y[temp$ObjectID == names(max.frame)[i]],
     lwd = 1,
     col = sample.colors[i])
  i = i+1
}

legend.text = rep(0, length(distance))
i=1
while(i<= length(distance)){
  legend.text[i] = signif(speed[i],3)
  i = i+1
}

legend(x = 1460,
       y = 1400,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(legend.text), 
       fill = sample.colors[1:length(legend.text)],
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "mm/s")

```


```{r echo = F, fig.height=7, fig.width= 7}


samplenum = 1
if(samplenum <= length(distance)){
  
par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,1400), xlim = c(0,1400),
     xlab = "",
     ylab = "") #ylim = c(300,600), xlim = c(200,600))#

#rasterImage(bgpic, xleft = 0,
#            xright = 1080,
#            ybottom = 0,
#            ytop = 720)

if(samplenum == 1){
  lines(x = temp$X[temp$ObjectID ==1],
     y = temp$Y[temp$ObjectID ==1],
     lwd = 1,
     col = "darkorange")
}


if(samplenum == 2){
  lines(x = temp$X[temp$ObjectID ==2],
       y = temp$Y[temp$ObjectID ==2],
       lwd = 1,
       col = "firebrick")
}

if(samplenum == 3){
  lines(x = temp$X[temp$ObjectID ==3],
       y = temp$Y[temp$ObjectID ==3],
       lwd = 1,
       col = "royalblue")
}

if(samplenum == 4){
  lines(x = temp$X[temp$ObjectID ==4],
       y = temp$Y[temp$ObjectID ==4],
       lwd = 1,
       col = "darkgreen")
}

if(samplenum == 5){
  lines(x = temp$X[temp$ObjectID ==5],
       y = temp$Y[temp$ObjectID ==5],
       lwd = 1,
       col = "violetred")
}

legend(x = 1460,
       y = 1400,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],3),
                  signif(speed[2],3),
                  signif(speed[3],3),
                  signif(speed[4],3),
                  signif(speed[5],3))[samplenum], 
       fill = c("darkorange", "firebrick", "royalblue", 'darkgreen', 'violetred')[samplenum],
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "mm/s")
}

```


```{r echo = F, fig.height=7, fig.width= 7}


samplenum = 2
if(samplenum <= length(distance)){
  
par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,1400), xlim = c(0,1400),
     xlab = "",
     ylab = "") #ylim = c(300,600), xlim = c(200,600))#

#rasterImage(bgpic, xleft = 0,
#            xright = 1080,
#            ybottom = 0,
#            ytop = 720)

if(samplenum == 1){
  lines(x = temp$X[temp$ObjectID ==1],
     y = temp$Y[temp$ObjectID ==1],
     lwd = 1,
     col = "darkorange")
}


if(samplenum == 2){
  lines(x = temp$X[temp$ObjectID ==2],
       y = temp$Y[temp$ObjectID ==2],
       lwd = 1,
       col = "firebrick")
}

if(samplenum == 3){
  lines(x = temp$X[temp$ObjectID ==3],
       y = temp$Y[temp$ObjectID ==3],
       lwd = 1,
       col = "royalblue")
}

if(samplenum == 4){
  lines(x = temp$X[temp$ObjectID ==4],
       y = temp$Y[temp$ObjectID ==4],
       lwd = 1,
       col = "darkgreen")
}

if(samplenum == 5){
  lines(x = temp$X[temp$ObjectID ==5],
       y = temp$Y[temp$ObjectID ==5],
       lwd = 1,
       col = "violetred")
}

legend(x = 1460,
       y = 1400,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],3),
                  signif(speed[2],3),
                  signif(speed[3],3),
                  signif(speed[4],3),
                  signif(speed[5],3))[samplenum], 
       fill = c("darkorange", "firebrick", "royalblue", 'darkgreen', 'violetred')[samplenum],
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "mm/s")
}

```


```{r echo = F, fig.height=7, fig.width= 7}


samplenum = 3
if(samplenum <= length(distance)){
  
par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,1400), xlim = c(0,1400),
     xlab = "",
     ylab = "") #ylim = c(300,600), xlim = c(200,600))#

#rasterImage(bgpic, xleft = 0,
#            xright = 1080,
#            ybottom = 0,
#            ytop = 720)

if(samplenum == 1){
  lines(x = temp$X[temp$ObjectID ==1],
     y = temp$Y[temp$ObjectID ==1],
     lwd = 1,
     col = "darkorange")
}


if(samplenum == 2){
  lines(x = temp$X[temp$ObjectID ==2],
       y = temp$Y[temp$ObjectID ==2],
       lwd = 1,
       col = "firebrick")
}

if(samplenum == 3){
  lines(x = temp$X[temp$ObjectID ==3],
       y = temp$Y[temp$ObjectID ==3],
       lwd = 1,
       col = "royalblue")
}

if(samplenum == 4){
  lines(x = temp$X[temp$ObjectID ==4],
       y = temp$Y[temp$ObjectID ==4],
       lwd = 1,
       col = "darkgreen")
}

if(samplenum == 5){
  lines(x = temp$X[temp$ObjectID ==5],
       y = temp$Y[temp$ObjectID ==5],
       lwd = 1,
       col = "violetred")
}

legend(x = 1460,
       y = 1400,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],3),
                  signif(speed[2],3),
                  signif(speed[3],3),
                  signif(speed[4],3),
                  signif(speed[5],3))[samplenum], 
       fill = c("darkorange", "firebrick", "royalblue", 'darkgreen', 'violetred')[samplenum],
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "mm/s")
}

```


```{r echo = F, fig.height=7, fig.width= 7}


samplenum = 4
if(samplenum <= length(distance)){
  
par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,1400), xlim = c(0,1400),
     xlab = "",
     ylab = "") #ylim = c(300,600), xlim = c(200,600))#

#rasterImage(bgpic, xleft = 0,
#            xright = 1080,
#            ybottom = 0,
#            ytop = 720)

if(samplenum == 1){
  lines(x = temp$X[temp$ObjectID ==1],
     y = temp$Y[temp$ObjectID ==1],
     lwd = 1,
     col = "darkorange")
}


if(samplenum == 2){
  lines(x = temp$X[temp$ObjectID ==2],
       y = temp$Y[temp$ObjectID ==2],
       lwd = 1,
       col = "firebrick")
}

if(samplenum == 3){
  lines(x = temp$X[temp$ObjectID ==3],
       y = temp$Y[temp$ObjectID ==3],
       lwd = 1,
       col = "royalblue")
}

if(samplenum == 4){
  lines(x = temp$X[temp$ObjectID ==4],
       y = temp$Y[temp$ObjectID ==4],
       lwd = 1,
       col = "darkgreen")
}

if(samplenum == 5){
  lines(x = temp$X[temp$ObjectID ==5],
       y = temp$Y[temp$ObjectID ==5],
       lwd = 1,
       col = "violetred")
}

legend(x = 1460,
       y = 1400,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],3),
                  signif(speed[2],3),
                  signif(speed[3],3),
                  signif(speed[4],3),
                  signif(speed[5],3))[samplenum], 
       fill = c("darkorange", "firebrick", "royalblue", 'darkgreen', 'violetred')[samplenum],
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "mm/s")
}

```


```{r echo = F, fig.height=7, fig.width= 7}


samplenum = 5
if(samplenum <= length(distance)){
  
par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,1400), xlim = c(0,1400),
     xlab = "",
     ylab = "") #ylim = c(300,600), xlim = c(200,600))#

#rasterImage(bgpic, xleft = 0,
#            xright = 1080,
#            ybottom = 0,
#            ytop = 720)

if(samplenum == 1){
  lines(x = temp$X[temp$ObjectID ==1],
     y = temp$Y[temp$ObjectID ==1],
     lwd = 1,
     col = "darkorange")
}


if(samplenum == 2){
  lines(x = temp$X[temp$ObjectID ==2],
       y = temp$Y[temp$ObjectID ==2],
       lwd = 1,
       col = "firebrick")
}

if(samplenum == 3){
  lines(x = temp$X[temp$ObjectID ==3],
       y = temp$Y[temp$ObjectID ==3],
       lwd = 1,
       col = "royalblue")
}

if(samplenum == 4){
  lines(x = temp$X[temp$ObjectID ==4],
       y = temp$Y[temp$ObjectID ==4],
       lwd = 1,
       col = "darkgreen")
}

if(samplenum == 5){
  lines(x = temp$X[temp$ObjectID ==5],
       y = temp$Y[temp$ObjectID ==5],
       lwd = 1,
       col = "violetred")
}

legend(x = 1460,
       y = 1400,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(signif(speed[1],3),
                  signif(speed[2],3),
                  signif(speed[3],3),
                  signif(speed[4],3),
                  signif(speed[5],3))[samplenum], 
       fill = c("darkorange", "firebrick", "royalblue", 'darkgreen', 'violetred')[samplenum],
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "mm/s")
}

```


```{r echo = F, fig.height=7, fig.width= 7}


frame.distance = data.frame(Rep = character(),
                            frame = numeric(),
                            distance = numeric())

i = 1
while(i <= length(distance)){
  temp.frame.distance = data.frame(Rep = c(rep(names(max.frame[i]), ((floor(max.frame[i]/100))))),
                                   frame = c(100*(1:floor(max.frame[i]/100)-1)),
                                   distance = 0)
  
  frame.distance = rbind(frame.distance, temp.frame.distance)
  i = i+1
}



i=1
while(i<=length(unique(names(distance)))){
  temp.distance = 0
  j = 200
  while(j-100 < max.frame[i]){
    x1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "X"]
    x2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "X"]
    y1 = temp[temp$Frame == j-100 & temp$ObjectID == names(distance)[i], "Y"]
    y2 = temp[temp$Frame == j & temp$ObjectID == names(distance)[i], "Y"]
    temp.distance = temp.distance + sqrt((x2-x1)^2 + (y2-y1)^2)
    frame.distance[frame.distance$Rep == names(distance)[i] &
                     frame.distance$frame == j-100, "distance"]= temp.distance
    j=j+100
  }
  i=i+1
}

frame.distance$distance = frame.distance$distance*mm.per.pix["A4VFG1D1"]

par(mar = c(5.35,5.35,5.35,5.35))

plot(NA, 
     type ="n",
     main = title,
     ylim = c(0,3500), xlim = c(0,9800),
     xlab = "Frame",
     ylab = "Distance (mm)")

i=1
while(i<=length(unique(names(distance)))){
  lines(x = frame.distance$frame[frame.distance$Rep ==names(max.frame[i])],
     y = frame.distance$distance[frame.distance$Rep ==names(max.frame[i])],
     lwd = 1,
     col = sample.colors[i])
  i = i+1
}

       
legend.text = rep(0, length(distance))
i=1
while(i<= length(distance)){
  legend.text[i] = signif(speed[i],3)
  i = i+1
}

legend(x = 10000,
       y = 3500,
       #legend = c(paste0('1: ', floor(distance[1]), "px"),
       #          paste0('2: ', floor(distance[2]), "px"),
       #           paste0('3: ', floor(distance[3]), "px"),
       #            paste0('4: ', floor(distance[4]), "px"),
       #            paste0('5: ', floor(distance[5]), "px")),
       legend = c(legend.text), 
       fill = sample.colors[1:length(legend.text)],
       cex = 1,
       bty = 'n',
       pt.cex = .5,
       xpd = T,
       title = "mm/s")


```


```{r echo = F, fig.width= 10, fig.height= 7}

all.data = data.frame(Genotype = c(rep("A4VF D1", length(A4VFG1D1.dist))),
                      Speed = c(A4VFG1D1.speed),
                      Distance = c(A4VFG1D1.dist))

all.data$Genotype = factor(all.data$Genotype, levels = c("A4VF D1"))

hex = function(color, alpha){
  rgb2hex = color
  i = 1
  while(i <= length(color)){
    rgbvals = col2rgb(color[i])
    rgb2hex[i] = rgb(rgbvals[1]/255, rgbvals[2]/255, rgbvals[3]/255, alpha)
    i = i+1
  }
  return(rgb2hex)
}


boxplot(all.data$Speed~all.data$Genotype,
        col = hex(c("navy","firebrick","darkgreen")[unique(as.numeric(all.data$Genotype))],.5), 
        xlab = "", ylab = "Speed (mm/s)",
        ylim = c(0, 10))

beeswarm(all.data$Speed~all.data$Genotype,
       pch = c(21),
       cex = 2,
       method = "center",
       bg = hex(c("dodgerblue","brown","green")[unique(as.numeric(all.data$Genotype))],1),
       add = T)
```


```{r echo = F}


t.data = list("TauWTD1" = TauWTD1.speed,
              "TauWTD14" = c(TauWTD14.speed,NA),
              "TauR406WD1" = TauR406WD1.speed,
              "TauR406WD14" = TauR406WD14.speed,
              "LacZD1" = LacZD1.speed,
              "LacZD14" = LacZD14.speed)

t.table = data.frame(Genotype1 = character(),
                     Genotype2 = character(),
                     pval = numeric())

i=1
while(i <= length(t.data)){
  j = i+1
  while(j <= length(t.data)){
    t.temp = data.frame(Genotype1 = names(t.data)[i],
                        Genotype2 = names(t.data)[j],
                        pval = t.test(x = t.data[[i]],
                                      y = t.data[[j]],
                                      paired = F)[[3]])
    t.table = rbind(t.table, t.temp)
      j = j+1
  }
  i = i+1
}


t.stripe = t.table$pval <= .05
knitr::kable(t.table,
             caption = 'All t-tests Tau Activity')  %>%
kable_styling() %>%
row_spec(c(1:nrow(t.table))[t.table$pval <= .05], bold = T, color = "black", background = "gold")

```